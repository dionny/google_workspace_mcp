{"id":"google_workspace_mcp-01f5","content_hash":"4bb364fb0447bb7bdce71017b5d844d1a7d2cdbbaa9471d22038ce723cd54c7e","title":"get_doc_operation_history always returns empty - undo tracking not working","description":"## Summary\nThe get_doc_operation_history tool always returns an empty operations array, even after performing many document modifications. This suggests operation history tracking is not working.\n\n## Steps to Reproduce\n1. Perform multiple document modifications (insert text, format text, etc.)\n2. Call get_doc_operation_history\n\n## Expected Behavior\nShould return a list of recent operations that can be used for undo functionality.\n\n## Actual Behavior\nReturns:\n{\n  \"document_id\": \"...\",\n  \"operations\": [],\n  \"total_operations\": 0,\n  \"undoable_count\": 0\n}\n\n## Impact\n- Cannot implement undo functionality\n- Cannot track what changes were made\n\n## Notes\nThere are related tools like record_doc_operation and clear_doc_history, suggesting this is intended functionality but not working.\n\n## Files Likely Affected\n- gdocs/managers/history_manager.py\n- gdocs/docs_tools.py","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:38:05.669611-06:00","updated_at":"2025-12-06T17:07:42.605114-06:00","closed_at":"2025-12-06T17:07:42.605114-06:00"}
{"id":"google_workspace_mcp-028d","content_hash":"9dd0dcc0f9b774f62e2941b75fdb018bde063f54bf4d16adebe5b6828dd16575","title":"Undo history is not persisted - undo operations are unusable in practice","description":"## Bug Description\n\nThe undo functionality in the GDocs tools stores operation history in-memory only. This means:\n\n1. History is lost when the server restarts\n2. History is lost between separate CLI invocations (each test harness invocation starts fresh)\n3. In practice, the undo functionality is unusable outside of a long-running MCP server session\n\n## Current Behavior\n- `get_doc_operation_history` returns empty results even after performing operations\n- `undo_doc_operation` cannot undo operations from previous invocations\n- The history manager in `gdocs/managers/history_manager.py` stores state in a Python dict that is not persisted\n\n## Expected Behavior\nUsers should be able to undo recent operations even across server restarts, or at minimum, the documentation should clearly state this limitation.\n\n## Suggested Solutions\n1. **Documentation fix**: Clearly document that undo only works within a single MCP session\n2. **Persistence fix**: Store operation history in a file or use Google Docs revision history\n3. **Alternative**: Leverage Google Docs native revision history instead of maintaining our own\n\n## Impact\nMedium - This may confuse users who expect undo to work like traditional undo functionality.\n\n## Note\nThe implementation seems intentionally in-memory for performance, so this may be a design decision. Consider adding clear documentation about this limitation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:24:57.221004-06:00","updated_at":"2025-12-06T17:42:49.699315-06:00","closed_at":"2025-12-06T17:42:49.699315-06:00","labels":["documentation","gdocs"],"comments":[{"id":5,"issue_id":"google_workspace_mcp-028d","author":"mbradshaw","text":"Merged google_workspace_mcp-01f5 into this issue. Both issues describe the same root cause: operation history is stored in-memory and is lost between separate CLI/process invocations.\n\nRoot cause analysis:\n1. HistoryManager uses a global singleton pattern (via get_history_manager())\n2. Operations ARE correctly recorded after successful document modifications\n3. Each CLI invocation creates a new Python process, resetting the singleton\n4. When get_doc_operation_history is called in a new process, it gets a fresh empty HistoryManager\n\nThis is a design limitation, not a bug. The in-memory approach was intentional for simplicity and performance.","created_at":"2025-12-06T23:07:57Z"}]}
{"id":"google_workspace_mcp-03aa","content_hash":"d5c206a3bd0a9d9996513c1b7faf0ebb0a8df85676d1e5bf2212683ea614a7e3","title":"GDocs: Inconsistent parameter naming across tools","description":"Several GDocs tools have inconsistent or confusing parameter naming that makes them harder to use:\n\n## Examples Found:\n\n1. **`update_doc_headers_footers`**: Uses `section_type` and `content` parameters, but intuitively users might expect `header_text`/`footer_text` parameters. The current API requires two separate calls to set both header AND footer.\n\n2. **`navigate_heading_siblings`**: Uses `heading` parameter, but a more descriptive name like `current_heading` would clarify that this is the heading to find siblings FOR (not the sibling to return).\n\n3. **`insert_doc_image`**: Uses `image_source` which is fine, but users might intuitively try `image_url` first.\n\n## Recommendation:\n- Add parameter aliases for common variations\n- Or update documentation with clearer examples\n- Consider providing convenience wrappers for common use cases (like setting both header and footer in one call)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:09:28.627346-06:00","updated_at":"2025-12-06T17:47:23.323414-06:00","closed_at":"2025-12-06T17:47:23.323414-06:00"}
{"id":"google_workspace_mcp-08bf","content_hash":"ec5bce24cce2a503b0a366827a32dc37c55a795310c5ff88cb8179b5dcd1dc9b","title":"Deleting list item text leaves orphaned bullet/number marker","description":"## Summary\nWhen using modify_doc_text to delete list item content (by replacing with empty string), the bullet or number marker is left behind, creating an empty list item.\n\n## Steps to Reproduce\n1. Create a list with items\n2. Use modify_doc_text to replace an item's text with empty string:\n   modify_doc_text(search='Item text', position='replace', text='')\n3. Observe the result\n\n## Expected Behavior\nEither:\n1. Deleting list item text should also remove the list item marker, OR\n2. There should be a dedicated tool for removing list items completely\n\n## Actual Behavior\nThe list item content is deleted but the bullet/number marker remains, creating empty list items. Example visible in search results:\ncontext_after: \"\\n\\nParent item 3\\n\\n\"\n                    ^^-- empty line where 'Parent item 2' was\n\n## Impact\n- Documents have orphaned bullet points\n- Users cannot cleanly remove list items\n- Must manually clean up after deletions\n\n## Files Likely Affected\n- gdocs/docs_tools.py (modify_doc_text or new delete_list_item function)\n- May need a dedicated tool for list item manipulation","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:38:19.291791-06:00","updated_at":"2025-12-06T16:57:14.454596-06:00","closed_at":"2025-12-06T16:57:14.454596-06:00"}
{"id":"google_workspace_mcp-09c9","content_hash":"08f2317303e062856807e543df3edcd6c849bc106345061c5e0127ff7a38b72b","title":"Add copy/duplicate section functionality","description":"There's currently no easy way to copy or duplicate a section of a document. Users might want to:\n- Duplicate a heading and its content to create similar sections\n- Copy a table from one location to another\n- Duplicate a range of paragraphs\n\n**Use case examples:**\n1. Template-based document editing: Copy a template section and modify it\n2. Moving content around: Copy content then delete original (effectively a move)\n3. Creating similar repeated sections\n\n**Proposed solution:**\nAdd a new tool `copy_doc_section` or add a `copy` operation to batch_edit_doc that:\n1. Takes a source range (via search, indices, or section heading)\n2. Takes a destination (location='end', after heading, etc.)\n3. Copies the content (including formatting) to the destination\n\n**Example usage:**\n```python\n# Copy a section to the end\ncopy_doc_section(\n    document_id='...',\n    source={'section': 'Template Section', 'include_heading': True},\n    destination={'location': 'end'}\n)\n\n# Copy text range using search\ncopy_doc_section(\n    document_id='...',\n    source={'search': 'start marker', 'end_search': 'end marker'},\n    destination={'after_heading': 'New Section'}\n)\n```\n\n**Alternative:** Could also use clipboard-style operations:\n```python\n# Cut/copy/paste style\nbatch_edit_doc(operations=[\n    {'type': 'copy', 'search': 'template', 'extend': 'section', 'buffer': 'temp'},\n    {'type': 'paste', 'location': 'end', 'buffer': 'temp'}\n])\n```\n\n**Files to modify:**\n- gdocs/docs_tools.py","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:17:14.885439-06:00","updated_at":"2025-12-06T20:52:00.469916-06:00","closed_at":"2025-12-06T20:52:00.469916-06:00"}
{"id":"google_workspace_mcp-0aac","content_hash":"bcb9736c486e1b4d97984965a6699f3d9bd0a981b820e37eaffbb52d7044b9e6","title":"GDocs: batch_edit_doc format operation formatted wrong location","description":"When using `batch_edit_doc` with a format operation that searches for text, the format is applied to an earlier occurrence of the text in the document rather than the text that was just inserted.\n\n## Reproduction:\n\n```python\noperations=[\n    {'type': 'insert', 'location': 'end', 'text': '\\n\\n=== BATCH EDIT TEST ===\\n'},\n    {'type': 'insert', 'location': 'end', 'text': 'This is line 1 of batch edit.\\n'},\n    {'type': 'insert', 'location': 'end', 'text': 'This is line 2 of batch edit.\\n'},\n    {'type': 'format', 'search': 'BATCH EDIT TEST', 'bold': True, 'foreground_color': 'blue'},\n]\n```\n\n## Result:\n- The insert operations went to the end of document at index ~36753\n- But the format operation found and formatted index 25508-25523 (an earlier occurrence of 'BATCH EDIT TEST' in the doc)\n\n## Expected:\nWhen inserting text and formatting in the same batch, the format should apply to the NEWLY inserted text, not an earlier occurrence. \n\n## Potential Solutions:\n1. Add an `occurrence=-1` option to target the last/most recent occurrence\n2. Track the inserted text ranges and allow referencing them in subsequent operations\n3. Document this limitation clearly","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:09:40.38989-06:00","updated_at":"2025-12-06T16:15:41.033103-06:00","closed_at":"2025-12-06T16:15:41.033103-06:00"}
{"id":"google_workspace_mcp-0b22","content_hash":"cc9487608106ef952a9e59539d9e059912106c15724822321f133e72ccb4dcca","title":"batch_edit_doc insert operations ignore formatting parameters","description":"When using batch_edit_doc with insert operations that include formatting parameters like 'bold', 'italic', etc., the formatting is ignored. The text is inserted correctly but the formatting is not applied.\n\n## Steps to Reproduce\n1. Call batch_edit_doc with operations like:\n   `[{\"type\": \"insert\", \"location\": \"end\", \"text\": \"BOLD TEXT\", \"bold\": true}]`\n2. Use get_text_formatting to verify the formatting\n\n## Expected Behavior\nThe inserted text should have the formatting applied (bold=true in this case)\n\n## Actual Behavior\nThe text is inserted but formatting is ignored. The text shows bold: false when checked with get_text_formatting.\n\n## Workaround\nUsers must use two operations: first insert the text, then use a format operation to apply formatting.\n\n## Evidence from Testing\n- Inserted with bold: true, checked formatting: bold was false\n- Same for italic: true, italic was false  \n- When using separate format operation after insert, formatting works correctly","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T18:56:30.155738-06:00","updated_at":"2025-12-06T19:05:13.979882-06:00","closed_at":"2025-12-06T19:05:13.979882-06:00","labels":["batch_edit_doc","formatting","gdocs"]}
{"id":"google_workspace_mcp-0d0a","content_hash":"9ef62c7c4bc1c83c9c0eafeec03384e61d1ef200fe20281ee17fa082f37d9d4d","title":"delete_doc_section only deletes heading, not section content","description":"## Summary\nWhen using delete_doc_section to delete a section by heading, only the heading text is deleted, not the content underneath it. This leaves orphaned content in the document.\n\n## Steps to Reproduce\n1. Create a section with a heading (e.g., using modify_doc_text with heading_style='HEADING_2')\n2. Add content under that heading\n3. Call delete_doc_section with the heading text\n4. Observe that only the heading is deleted, content remains\n\n## Expected Behavior\ndelete_doc_section should delete the entire section including:\n- The heading itself\n- All content under that heading until the next same-level or higher-level heading\n\n## Actual Behavior\nOnly the heading text is deleted (20 characters in test case). The section content (64 characters in test case) remains orphaned in the document.\n\n## Evidence\n- get_doc_section shows empty content for the section even when content exists\n- After delete, the content 'This is content in the DELETE TEST SECTION' remains in document\n- delete operation reported 'characters_deleted': 20 but should have been ~84\n\n## Files Likely Affected\n- gdocs/docs_tools.py (delete_doc_section function)\n- Possibly gdocs/docs_structure.py (section boundary detection)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T16:37:16.69114-06:00","updated_at":"2025-12-06T16:46:49.65663-06:00","closed_at":"2025-12-06T16:46:49.65663-06:00"}
{"id":"google_workspace_mcp-0d25","content_hash":"4b17b4df2326b6fa5387218acd0d1184f6b5f4d7523e9ccae98ff7358c69308b","title":"Add delete_table tool to remove entire tables from documents","description":"Currently there is no way to delete an entire table from a Google Doc. The modify_table tool can delete rows and columns but not the whole table. This is a common operation users need. Implementation should use the Google Docs API's deleteContentRange request targeting the table's start and end indices.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:33:43.612561-06:00","updated_at":"2025-12-06T16:18:46.00158-06:00","closed_at":"2025-12-06T16:18:46.00158-06:00","labels":["feature-request","gdocs","table"]}
{"id":"google_workspace_mcp-11e2","content_hash":"04c9b63536a322d2a1009eb7841b0f5fc09fde358a9911373fee41932c9db553","title":"Add delete_table operation to modify_table tool","description":"Currently, the modify_table tool supports operations like insert_row, delete_row, insert_column, delete_column, and update_cell. However, there's no way to delete an entire table from the document.\n\n**Use case:**\nA user may want to remove a table entirely from a document, rather than manually deleting all rows or using index-based deletion which requires knowing exact indices.\n\n**Proposed solution:**\nAdd a new delete_table operation or create a new tool `delete_table` that allows deleting a table by:\n- table_index (0-based index of which table to delete)\n- search (find table near this text)\n- after_heading (find table under this heading)\n\n**Example usage:**\n```python\n# Delete the 3rd table in the document\nmodify_table(document_id='...', table_index=2, operations=[{'action': 'delete_table'}])\n\n# Or as a separate tool\ndelete_table(document_id='...', table_index=2)\n```\n\n**Files to modify:**\n- gdocs/docs_tools.py\n- gdocs/managers/table_operation_manager.py (if table operations are there)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T15:17:02.707975-06:00","updated_at":"2025-12-06T16:18:51.289675-06:00","closed_at":"2025-12-06T16:18:51.289675-06:00"}
{"id":"google_workspace_mcp-15cd","content_hash":"9e43983ef5250f05e02ecb6bc6f31147befa861cba7badf856ec50d79c013adb","title":"Table merge_cells operation does not visually merge cells","description":"When using modify_table with merge_cells action, the operation reports success and concatenates text content, but the cells may not be properly visually merged in the document.\n\n## Steps to Reproduce\n1. Create a table using create_table_with_data with 3 columns\n2. Call modify_table with:\n   `[{\"action\": \"merge_cells\", \"row\": 0, \"column\": 0, \"row_span\": 1, \"column_span\": 3}]`\n3. Use debug_table_structure to check the result\n\n## Expected Behavior\nCells (0,0), (0,1), and (0,2) should be merged into a single cell spanning 3 columns.\n\n## Actual Behavior\n- debug_table_structure shows cell (0,0) contains concatenated text from all merged cells\n- Cells (0,1) and (0,2) still exist as separate cells with just newlines\n- The table structure shows all 3 cells still present\n\n## Debug Output\nCell (0,0) content after merge: 'Test Header 1\\nTest Header 2\\nTest Header 3\\n'\nCell (0,1) content: '\\n'  \nCell (0,2) content: '\\n'\n\nThis suggests the merge_cells operation is concatenating content but the visual merge may not be happening properly, or debug_table_structure is not correctly reflecting merged cell state.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T18:56:40.619565-06:00","updated_at":"2025-12-06T19:12:32.142942-06:00","closed_at":"2025-12-06T19:12:32.142942-06:00","labels":["gdocs","merge_cells","modify_table"]}
{"id":"google_workspace_mcp-1699","content_hash":"55896e9b396cdad2f5aaf7d73e40b6f6d42508865d6c618c422798ae0f5709ba","title":"Add formatting options to find_and_replace_doc","description":"Currently find_and_replace only replaces text. Common need: replace AND format.\n\nExample use cases:\n- Replace \"TODO\" with \"DONE\" and make it green\n- Replace \"@mention\" with styled version\n- Replace code snippets with monospace formatting\n\nProposed enhancement:\nfind_and_replace_doc(\n    find_text=\"TODO\",\n    replace_text=\"DONE\",\n    # NEW: Apply formatting to replacement\n    bold=True,\n    foreground_color=\"green\",\n    font_family=\"monospace\"\n)\n\nThis is a simpler alternative to format_all_occurrences when replacement is also needed.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-05T06:48:47.882462-08:00","updated_at":"2025-12-05T07:59:33.679936-08:00","closed_at":"2025-12-05T07:59:33.679936-08:00","labels":["enhancement","gdocs","quick-win"]}
{"id":"google_workspace_mcp-1b3b","content_hash":"197d0d48424411a85efe960b0a6f4adf8c01f6902368dc072bdbda3a6ee2fe80","title":"Add apply_named_style tool for heading styles","description":"While modify_doc_text can apply heading styles via heading_level parameter, there's no dedicated tool for applying document-wide named styles like Title, Subtitle, Normal Text, etc. A dedicated tool would make it clearer how to format documents professionally.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T14:34:17.365162-06:00","updated_at":"2025-12-06T20:12:03.123258-06:00","closed_at":"2025-12-06T20:12:03.123258-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-2011","content_hash":"6b7cb064eaccfad965283d6e0772a86e7662f691f543b2e0833b00cb45c5ce3b","title":"Missing tool to read/get header and footer content","description":"## Summary\nThere is update_doc_headers_footers to set header/footer content, but no corresponding tool to READ the current header/footer content.\n\n## Current State\n- Can UPDATE headers and footers with update_doc_headers_footers\n- Cannot READ what the current header/footer contains\n- get_doc_info and get_doc_content do not appear to return header/footer content\n\n## Expected Behavior\nShould have a way to retrieve the current text content of:\n- Default header\n- Default footer  \n- First page header (if different)\n- First page footer (if different)\n- Even page header (if different)\n- Even page footer (if different)\n\n## Use Cases\n- Checking if document already has header/footer before adding\n- Conditionally updating based on current content\n- Extracting document metadata from headers/footers\n\n## Implementation Notes\nGoogle Docs API provides header and footer content in the document structure.\n\n## Files Likely Affected\n- gdocs/docs_tools.py (new function or enhancement to get_doc_info)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:38:29.219415-06:00","updated_at":"2025-12-06T18:46:45.429977-06:00","closed_at":"2025-12-06T18:46:45.429977-06:00"}
{"id":"google_workspace_mcp-209d","content_hash":"c5f66275608a56fef7c84c9a5aa131ee8ca7ea5acde89aa390f95fa588994843","title":"preview_search_results tool was removed from docs_tools.py","description":"## Issue\n\nThe `preview_search_results` tool appears to have been removed from the codebase. This tool was added in commit `6aeed59 feat: add preview_search_results debug tool for Google Docs` but is no longer present in the current working copy of `gdocs/docs_tools.py`.\n\n## Evidence\n\n```bash\n# Tool was available before:\npython test_harness.py --tool preview_search_results --document_id \"\u003cid\u003e\" --search_text \"test\"\n# Worked correctly\n\n# Now shows:\n‚ùå Tool 'preview_search_results' not found. Use --list to see available tools.\n\n# Grep shows nothing:\ngrep -n \"def preview_search_results\" /Users/mbradshaw/projects/google_workspace_mcp/gdocs/docs_tools.py\n# No output\n\n# Git shows uncommitted changes:\ngit status gdocs/docs_tools.py\n# modified: gdocs/docs_tools.py (changes not staged)\n```\n\n## Impact\n\nThis breaks the ability to preview search results before modifying documents. Users now must use `find_and_replace_doc` with `preview=true` as a workaround, but this isn't as direct.\n\n## Expected Behavior\n\nThe `preview_search_results` tool should be present and functional.\n\n## Workaround\n\nUse `find_and_replace_doc` with `preview=true` and the same text for find and replace:\n```bash\npython test_harness.py --tool find_and_replace_doc --document_id \"\u003cid\u003e\" --find_text \"test\" --replace_text \"test\" --preview true\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T21:52:08.616193-06:00","updated_at":"2025-12-06T22:04:16.996352-06:00","closed_at":"2025-12-06T22:04:16.996352-06:00","labels":["gdocs","regression","tools"]}
{"id":"google_workspace_mcp-21fa","content_hash":"2db43638901cb66decac16dc768becfedfd979cdd79c6d8aab9aea44774c441e","title":"GDocs: navigate_heading_siblings parameter named 'heading' instead of 'current_heading'","description":"The `navigate_heading_siblings` function uses the parameter name `heading` but this is confusing because:\n\n1. The function finds siblings OF a heading, so `current_heading` would be clearer\n2. When passing `current_heading` (a more intuitive name), the call fails with 'missing a required argument: heading'\n\n## Reproduction:\n```python\n# This fails with: missing a required argument: 'heading'\nnavigate_heading_siblings(doc_id, current_heading='The Problem', direction='next')\n\n# This works\nnavigate_heading_siblings(doc_id, heading='The Problem', direction='next')\n```\n\n## Recommendation:\nAdd `current_heading` as an alias for `heading` parameter, or document the parameter name more clearly in the tool description.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T16:11:06.918161-06:00","updated_at":"2025-12-06T17:23:13.259239-06:00","closed_at":"2025-12-06T17:23:13.259239-06:00"}
{"id":"google_workspace_mcp-23b4","content_hash":"0ff7659fde8f9a33c4e3718120e35037f800a5c2491ea6ae1f732dd9a8df06c9","title":"modify_doc_text location=end uses wrong tab's document length when tab_id is specified","description":"When using modify_doc_text with location=\"end\" and a specific tab_id, the tool incorrectly calculates the end position using the default tab's document length instead of the specified tab's length.\n\n## Reproduction steps:\n1. Get a document with multiple tabs (e.g., tab t.0 with ~25000 chars, tab t.omnr5imd2xtk with ~7000 chars)\n2. Call modify_doc_text with:\n   - location: \"end\"\n   - tab_id: \"t.omnr5imd2xtk\" (the second tab)\n   - text: \"test\"\n\n## Expected behavior:\nThe text should be inserted at the end of the second tab (around index 7767)\n\n## Actual behavior:\nError: Index 25765 exceeds document length (7768)\n\nThe tool is using the first tab's end index (25765) when it should use the second tab's end index (~7767).\n\n## Root cause:\nThe location=\"end\" calculation appears to happen before/without considering the tab_id parameter, so it uses the default tab's document length.\n\n## Workaround:\nUse explicit start_index parameter instead of location=\"end\"","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T22:20:54.630955-06:00","updated_at":"2025-12-06T22:28:51.595346-06:00","closed_at":"2025-12-06T22:28:51.595346-06:00","labels":["gdocs","multi-tab"]}
{"id":"google_workspace_mcp-26b8","content_hash":"34dfe8d89d0fbd76a13268a9238431cbfbab9c90947ef45c2eb69b47c1046145","title":"Add tab targeting support for multi-tab Google Docs","description":"## Summary\nGoogle Docs now supports multiple tabs within a single document. The current gdocs tools only operate on the first/default tab with no way to target specific tabs for editing operations.\n\n## Current Behavior\n- `get_doc_content` correctly extracts content from ALL tabs (including nested tabs)\n- All editing tools (modify_doc_text, batch_edit_doc, etc.) only operate on the first tab\n- There's no parameter to specify which tab to edit\n\n## Proposed Enhancement\nAdd optional `tab_id` or `tab_name` parameter to editing tools:\n\n```python\n# Edit specific tab by ID\nmodify_doc_text(document_id=\"...\", tab_id=\"t.0\", location=\"end\", text=\"...\")\n\n# Or by tab name (position)\nmodify_doc_text(document_id=\"...\", tab_name=\"Tab 1\", location=\"end\", text=\"...\")\n```\n\n## Additional Tools Needed\n- `list_doc_tabs` - List all tabs in a document with their IDs and names\n- Tab parameter for: modify_doc_text, batch_edit_doc, create_table_with_data, insert_doc_elements, etc.\n\n## Use Cases\n1. Documents organized by topic into separate tabs\n2. Multi-language documents with translations in different tabs\n3. Documents with appendices in separate tabs\n\n## Impact\nMedium - Most users probably use single-tab documents, but multi-tab support is important for complex documents.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T17:38:05.594967-06:00","updated_at":"2025-12-06T20:30:13.274268-06:00","closed_at":"2025-12-06T20:30:13.274268-06:00","labels":["feature-request","google-docs","tabs"]}
{"id":"google_workspace_mcp-271d","content_hash":"75e900267c60889e58a34f76573c3aaf3cfa2d7203bf34b5037159f515879653","title":"Fix location=end off-by-one error in modify_doc_text","description":"The location=\"end\" convenience parameter in modify_doc_text has an off-by-one error.\n\n## Current Behavior\n```\nmodify_doc_text(document_id=\"...\", location=\"end\", text=\" [END]\")\n```\nReturns:\n```json\n{\n  \"error\": true,\n  \"code\": \"INDEX_OUT_OF_BOUNDS\",\n  \"message\": \"Index 118 exceeds document length (118)\"\n}\n```\n\n## Expected Behavior\nShould insert at the last valid index (117 in this case, which is document_length - 1).\n\n## Note\nlocation=\"start\" works correctly. Only location=\"end\" is affected.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-04T16:23:54.113411-08:00","updated_at":"2025-12-04T16:25:37.951803-08:00","closed_at":"2025-12-04T16:25:37.951803-08:00","labels":["dx","google-docs"]}
{"id":"google_workspace_mcp-2a31","content_hash":"25a98c7a46568c40b27df4e0c5d493a95de1d26c724331961046af8cd9bd1f78","title":"horizontal_rule insertion fails - insertHorizontalRule is not a valid Google Docs API request","description":"The insert_doc_elements tool with element_type='horizontal_rule' fails with a 400 API error because it uses 'insertHorizontalRule' which is not a valid Google Docs API request type.\n\n## Error Message\nInvalid JSON payload received. Unknown name \"insertHorizontalRule\" at 'requests[0]': Cannot find field.\n\n## Reproduction Steps\n1. Call insert_doc_elements with element_type='horizontal_rule' and location='end'\n2. The API returns a 400 error\n\n## Root Cause\nThe code in gdocs/docs_helpers.py:993 creates a request with 'insertHorizontalRule' key but this is not a valid Google Docs API batchUpdate request type.\n\n## Expected Behavior\nHorizontal rules should be insertable. Google Docs supports horizontal rules visually but inserting them via API may require a different approach (possibly inserting paragraph border styling or similar workaround).\n\n## Affected Files\n- gdocs/docs_helpers.py (create_insert_horizontal_rule_request function)\n- gdocs/docs_tools.py (insert_doc_elements function)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T17:50:50.415608-06:00","updated_at":"2025-12-06T17:55:24.355293-06:00","closed_at":"2025-12-06T17:55:24.355293-06:00"}
{"id":"google_workspace_mcp-2d49","content_hash":"f50705eaee30102401245bc3c593c5337527d06f2fc9b10a6abf60e45641dc0f","title":"batch_edit_doc: insert with explicit index fails but insert_text with same index works","description":"When using batch_edit_doc with type='insert' and an explicit index parameter, the operation fails with 'Must specify at least one request'. However, using type='insert_text' with the same index works fine.\n\nThe documentation states 'Accepts BOTH naming conventions (e.g., insert or insert_text)' but they behave differently.\n\nSteps to reproduce:\n1. Call batch_edit_doc with:\n   - operations: [{'type': 'insert', 'index': 50, 'text': '[TEST]'}]\n   - Result: FAILS with 'Must specify at least one request'\n\n2. Call batch_edit_doc with:\n   - operations: [{'type': 'insert_text', 'index': 50, 'text': '[TEST]'}]\n   - Result: SUCCESS\n\nExpected: Both should work identically.\nActual: 'insert' fails when using explicit index parameter.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T17:05:23.197124-06:00","updated_at":"2025-12-06T17:10:55.86894-06:00","closed_at":"2025-12-06T17:10:55.86894-06:00"}
{"id":"google_workspace_mcp-2e1e","content_hash":"c00124d8b1a4a2a8d50f5f57947630e4bb6d3eb16a916c28db82a678c035870c","title":"Add preview mode to batch_edit_doc tool","description":"The batch_edit_doc tool does not support a preview mode like modify_doc_text and find_and_replace_doc do. For batch operations that modify multiple parts of a document, users should be able to preview what changes will be made before committing them. This would help prevent accidental modifications and give confidence about the operation's effects.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:35:30.335294-06:00","updated_at":"2025-12-06T14:47:41.465966-06:00","closed_at":"2025-12-06T14:47:41.465966-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-2e6a","content_hash":"f839aa908da54ef316eb4ac55b0f10dc78c96704780aa93ca6a1a4fad89aa61a","title":"Add insert_bookmark and navigate_bookmark tools","description":"No way to insert named bookmarks in Google Docs that can be referenced by internal links. Bookmarks are essential for creating navigable documents and generating table of contents. Implementation would use Google Docs API's createNamedRange request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:34:05.967245-06:00","updated_at":"2025-12-06T18:20:25.473054-06:00","closed_at":"2025-12-06T18:20:25.473054-06:00","labels":["feature-request","gdocs"],"comments":[{"id":10,"issue_id":"google_workspace_mcp-2e6a","author":"mbradshaw","text":"## API Investigation Results\n\nAfter researching the Google Docs API, I found that **bookmark creation is NOT supported by the API**:\n\n### Key Findings:\n1. **No CreateBookmarkRequest exists** - The Google Docs API batchUpdate does not include any bookmark creation request type\n2. **Bookmarks cannot be fully retrieved** - Per [Stack Overflow](https://stackoverflow.com/questions/58944178/google-docs-api-document-where-are-the-comments-and-bookmarks), bookmarks cannot be retrieved by the Docs API\n3. **Feature request exists** - [Google Issue Tracker #135711136](https://issuetracker.google.com/issues/135711136) tracks this feature request\n4. **Only Apps Script has bookmark access** - Google Apps Script's Document service can create and retrieve bookmarks, but the REST API cannot\n\n### Alternative: Named Ranges\nThe API DOES support **Named Ranges** which provide similar functionality:\n- `CreateNamedRangeRequest` - Create a named range marking a text span\n- `DeleteNamedRangeRequest` - Delete a named range\n- Named ranges can be listed from document structure\n\nHowever, named ranges are different from bookmarks:\n- Named ranges mark a **range of text** (start to end index)\n- Bookmarks mark a **single position** in the document\n- Named ranges cannot be linked to with the `#` syntax the way bookmarks can\n\n### Recommendation:\nClose this issue as **cannot implement** due to Google Docs API limitations. If bookmark-like functionality is needed, a separate issue could be created for Named Range support instead.\n\n### Sources:\n- [Google Docs API Request Types](https://developers.google.com/workspace/docs/api/concepts/request-response)\n- [Stack Overflow - Bookmarks in Docs API](https://stackoverflow.com/questions/67045649/is-it-possible-to-create-a-bookmark-on-the-google-docs-api)","created_at":"2025-12-07T00:20:21Z"}]}
{"id":"google_workspace_mcp-308c","content_hash":"259b38a99648db78e7b1739c4fa60a0b002d12d13636d38a189d2a67a3ab7736","title":"Inconsistent parameter naming for search functionality","description":"**Problem**: Different tools use different parameter names for the same concept:\n\n- `find_and_replace_doc`: uses `find_text` and `replace_text`  \n- `format_all_occurrences`: uses `search`\n- `modify_doc_text`: uses `search`\n- `batch_edit_doc` operations: uses `search` but find_replace uses `find_text`\n\n**Impact**: Users who learn one tool's API have to re-learn parameter names for similar functionality in other tools. This leads to confusion and errors like passing `search_text` to `format_all_occurrences` when it expects `search`.\n\n**Recommendation**: Standardize on either `search` or `find_text` across all tools. Prefer `search` as it's shorter and used more frequently.\n\n**Files involved**: gdocs/docs_tools.py - multiple functions","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:59:52.007343-06:00","updated_at":"2025-12-06T17:22:46.022741-06:00","closed_at":"2025-12-06T17:22:46.022741-06:00"}
{"id":"google_workspace_mcp-32f7","content_hash":"9a50cd55e3bc0b4bd81514e4feea7ae27acbd10cb01e580591642c0761717ab0","title":"find_and_replace_doc returns inconsistent occurrence count vs affected_ranges","description":"When running find_and_replace_doc, the 'occurrences_replaced' count in the response doesn't match the number of entries in 'affected_ranges'.\n\n**Steps to Reproduce:**\n1. Preview a find/replace - shows 5 occurrences\n2. Execute the find/replace - says 'Replaced 10 occurrence(s)' \n3. But affected_ranges only contains 5 entries\n\n**Expected Behavior:**\noccurrences_replaced should equal the length of affected_ranges\n\n**Actual Behavior:**\noccurrences_replaced = 10 but len(affected_ranges) = 5\n\n**Evidence:**\nPreview: 'occurrences_found': 5\nExecute: 'occurrences_replaced': 10 with only 5 affected_ranges\n\nThis inconsistency makes it difficult to trust the operation results.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T19:53:37.983227-06:00","updated_at":"2025-12-06T20:00:08.439377-06:00","closed_at":"2025-12-06T20:00:08.439377-06:00"}
{"id":"google_workspace_mcp-332b","content_hash":"16123bb4b2b1cc664ed7fc16307a5cca6d215554e95713a65c30a1b4da81ed9b","title":"batch_edit_doc insert operation inherits surrounding formatting instead of applying only specified formatting","description":"When using batch_edit_doc with an insert operation and formatting parameters (e.g., bold: true), the inserted text inherits all formatting from surrounding text instead of applying only the specified formatting.\n\n**Steps to reproduce:**\n1. Insert text with batch_edit_doc using: {\"type\": \"insert\", \"search\": \"some text\", \"position\": \"after\", \"text\": \"test\", \"bold\": true}\n2. Check formatting of inserted text with get_text_formatting\n\n**Expected behavior:**\n- Inserted text should only have bold=true\n- Other formatting attributes should be reset to defaults\n\n**Actual behavior:**\n- Inserted text inherits all formatting from surrounding text (italic, subscript, red color, yellow background)\n- The bold=true parameter seems to be applied on top of inherited formatting\n\n**Test document:** https://docs.google.com/document/d/1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc/edit\n**Affected text:** 'Test 2: This should be ONLY bold - nothing else' at index 202573\n\n**Root cause hypothesis:**\nThe insert operation likely applies formatting as an update to existing style rather than setting a clean style. The Google Docs API may require explicit clearing of formatting or use of UpdateTextStyleRequest with proper field masks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T19:28:55.758582-06:00","updated_at":"2025-12-06T19:43:34.188669-06:00","closed_at":"2025-12-06T19:43:34.188669-06:00"}
{"id":"google_workspace_mcp-3556","content_hash":"3f732b467268481138f560438d344e414cf0b465c3119c60d71c0eb87b21e2ca","title":"Add table row/column modification tools","description":"Currently can only create tables, not modify existing ones. Add tools for:\n\n1. delete_table_row(document_id, table_index, row_index)\n2. delete_table_column(document_id, table_index, column_index)  \n3. insert_table_row(document_id, table_index, row_index, data)\n4. insert_table_column(document_id, table_index, column_index, data)\n5. update_table_cell(document_id, table_index, row, col, text)\n\nOr a single modify_table tool with operations array:\nmodify_table(\n    table_index=0,\n    operations=[\n        {\"action\": \"delete_row\", \"row\": 2},\n        {\"action\": \"add_row\", \"data\": [\"A\", \"B\"]},\n        {\"action\": \"update_cell\", \"row\": 1, \"col\": 0, \"text\": \"New\"}\n    ]\n)\n\nGoogle Docs API supports: DeleteTableRowRequest, DeleteTableColumnRequest, InsertTableRowRequest, InsertTableColumnRequest","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T06:47:36.725968-08:00","updated_at":"2025-12-06T14:25:14.97605-06:00","closed_at":"2025-12-06T14:25:14.97605-06:00","labels":["enhancement","gdocs","tables"]}
{"id":"google_workspace_mcp-3665","content_hash":"d931a686d97f495c3dbd4d88929845ccbf8a146a26bcfe4e945e09dc143aa674","title":"Parameter naming inconsistency across gdocs tools","description":"Different gdocs tools use inconsistent parameter names for similar concepts, which can be confusing for users:\n\n1. **find_and_replace_doc** uses `find_text` and `replace_text`\n2. **format_all_occurrences** uses `search` \n3. **modify_doc_text** uses `search` and `text`\n\nFor search operations, some tools use `search`, others use `find_text`, and others use `search_text`.\n\n**Recommendation:** Standardize parameter naming across all tools to use consistent names:\n- Use `search` consistently for the text to find\n- Use `text` or `replace_with` consistently for replacement text\n\n**Impact:** Users may get confused and use wrong parameter names, leading to errors like 'missing a required argument'.\n\n**Files affected:**\n- gdocs/docs_tools.py - find_and_replace_doc, format_all_occurrences, modify_doc_text\n\n**Reproduction:**\nCalling find_and_replace_doc with `search_text` parameter instead of `find_text` fails with missing argument error.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T15:16:52.887546-06:00","updated_at":"2025-12-06T15:23:14.640315-06:00","closed_at":"2025-12-06T15:23:14.640315-06:00"}
{"id":"google_workspace_mcp-3b57","content_hash":"38c0e8f38e478bb5e18ed07890d944311b45d8daf38f7725f0e42825b720ed8e","title":"Add section-aware append/prepend operations","description":"Currently adding content to a section requires:\n1. get_doc_section(heading=\"Intro\") to find bounds\n2. modify_doc_text(index=section_end, text=\"...\")\n\nAdd semantic section operations:\n\nappend_to_section(\n    heading=\"Introduction\",\n    text=\"New paragraph here\",\n    as_list_item=False  # optional: add as bullet point\n)\n\nprepend_to_section(\n    heading=\"Notes\",\n    text=\"Top of section\"\n)\n\nCould also extend modify_doc_text with section_position parameter:\nmodify_doc_text(\n    heading=\"Intro\",\n    section_position=\"end\",  # or \"start\"\n    text=\"Appended text\"\n)\n\nBenefits:\n- Single call instead of 2\n- No index calculation needed\n- More intuitive for document editing","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-05T06:47:44.811739-08:00","updated_at":"2025-12-05T06:48:17.171629-08:00","closed_at":"2025-12-05T06:48:17.17163-08:00","labels":["dx","enhancement","gdocs"]}
{"id":"google_workspace_mcp-3fda","content_hash":"331a2078a44ecd0e77f49e24b218751280046297954f29ee37e584b1a333e5ed","title":"update_doc_headers_footers fails when header/footer doesn't exist despite create_if_missing=True","description":"## Bug Description\n\nThe `update_doc_headers_footers` tool advertises that it will create headers/footers if they don't exist (`create_if_missing=True` parameter), but it fails with an error when the header or footer doesn't already exist in the document.\n\n## Error Message\n```\nAPI error during update_header_footer: Could not find content structure in header to update\n```\n\n## Steps to Reproduce\n1. Open a Google Doc that doesn't have a header\n2. Try to add a header using update_doc_headers_footers with section_type='header' and any content\n\n## Expected Behavior\nThe tool should create the header/footer first, then insert the content.\n\n## Actual Behavior\nThe tool returns an error saying it cannot find the content structure.\n\n## Root Cause\nThe underlying implementation in `gdocs/managers/header_footer_manager.py` fails when trying to replace section content because the header doesn't have an existing paragraph structure to insert into.\n\n## Suggested Fix\nThe tool needs to properly create the header/footer structure with an initial paragraph before attempting to insert text.\n\n## Test Document\nhttps://docs.google.com/document/d/1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc/edit","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T16:24:35.1188-06:00","updated_at":"2025-12-06T16:30:58.495223-06:00","closed_at":"2025-12-06T16:30:58.495223-06:00","labels":["gdocs"]}
{"id":"google_workspace_mcp-4269","content_hash":"5dc5e377e30c1081e672618586a09cfefda57f0c5aff3999722e39f58316477c","title":"Invalid color format throws raw exception instead of structured error","description":"When an invalid color format is passed to modify_doc_text, it throws a raw ValueError exception instead of returning a structured error response.\n\nRepro:\nmodify_doc_text(search=\"text\", position=\"replace\", foreground_color=\"not_a_color\")\n\nExpected: Structured error with code like INVALID_COLOR_FORMAT\nActual: ValueError: Unknown color format: not_a_color. Use hex (#FF0000) or named colors.\n\nThe error message is good, but it should be returned as a structured error, not thrown as an exception.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-05T05:07:35.50549-08:00","updated_at":"2025-12-05T06:58:12.517925-08:00","closed_at":"2025-12-05T06:58:12.517925-08:00","labels":["bug","dx","gdocs"]}
{"id":"google_workspace_mcp-426a","content_hash":"700e3adca5db2547afdccb05b2ca4843c9d85a170ffd7e3586403ce8ff0c3ac0","title":"create_table_with_data fails to populate cells when using after_heading parameter","description":"When using create_table_with_data with the after_heading parameter, the table is created with the correct dimensions but cells fail to be populated with the provided data.\n\n## Reproduction steps:\n1. Call create_table_with_data with:\n   - table_data: [[\"Col A\", \"Col B\"], [\"Data 1\", \"Data 2\"]]\n   - after_heading: \"The Problem\"\n\n2. Observe the result shows errors:\n   - Cell (0,1) out of bounds\n   - Cell (1,0) out of bounds\n   - Cell (1,1) out of bounds\n\n3. Result message says 'populated 1 cells' instead of 4 cells\n\n4. debug_table_structure shows all cells contain only newlines, not the expected data\n\n## Expected behavior:\nAll 4 cells should be populated with the provided data (Col A, Col B, Data 1, Data 2)\n\n## Actual behavior:\nOnly the first cell (0,0) is potentially attempted, and even it ends up empty. The errors indicate an index calculation issue when determining cell positions after table insertion.\n\n## Root cause hypothesis:\nThe table is inserted at a position after the heading, but the cell population logic may be using stale/incorrect indices that don't account for the table's actual position in the document, leading to 'out of bounds' errors.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T22:19:55.455877-06:00","updated_at":"2025-12-06T22:23:27.197347-06:00","closed_at":"2025-12-06T22:23:27.197347-06:00","labels":["gdocs","tables"]}
{"id":"google_workspace_mcp-446c","content_hash":"e1c02629259816b38b6e5e216aef54ad85b0c4b3735c243af24d710c5fe92e7d","title":"find_and_replace_doc formatting inherits surrounding text styles instead of applying only specified styles","description":"When using find_and_replace_doc with formatting parameters (e.g., bold=True, foreground_color='green'), the replaced text inherits all formatting from surrounding text instead of applying only the specified formatting.\n\n**Steps to reproduce:**\n1. Use find_and_replace_doc with: find_text='text', replace_text='newtext', bold=True, foreground_color='green'\n2. Check formatting of replaced text with get_text_formatting\n\n**Expected behavior:**\n- Replaced text should only have bold=true and foreground_color=#00FF00\n- Other formatting attributes should be reset to defaults (italic=false, baseline_offset=NONE, etc.)\n\n**Actual behavior:**\n- Replaced text inherits all formatting from surrounding text (italic=true, baseline_offset=SUBSCRIPT, background_color=#FFFF00)\n- The specified parameters are applied ON TOP of inherited formatting\n\n**Test document:** https://docs.google.com/document/d/1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc/edit\n**Affected text:** 'BUG-001-REPLACED' at index 202681\n\n**Related bug:** This is the same root cause as google_workspace_mcp-332b for batch_edit_doc\n\n**Root cause hypothesis:**\nThe formatting is being applied as an update/delta rather than as absolute values. The Google Docs API likely needs explicit field masks to clear unwanted formatting or use DeleteTextStyle before applying new formatting.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T19:32:46.395785-06:00","updated_at":"2025-12-06T19:36:17.224746-06:00","closed_at":"2025-12-06T19:36:17.224746-06:00"}
{"id":"google_workspace_mcp-4795","content_hash":"d1c5db0cd59af43040551800bd3128d599f27d4b82686e2a81c37905d2143bc4","title":"update_doc_headers_footers fails on empty header/footer with confusing error","description":"When updating headers/footers in a document that either has empty or no headers/footers, the tool fails with a confusing error message.\n\n## Steps to Reproduce:\n1. Have a document without headers/footers (or with empty ones)\n2. Call update_doc_headers_footers with section_type='header', content='Test Header'\n3. Observe error\n\n## Error Message:\n```json\n{\n  \"error\": true,\n  \"code\": \"API_ERROR\",\n  \"message\": \"API error during update_header_footer: Could not find content structure in header to update\",\n  ...\n}\n```\n\n## Root Cause:\nThe underlying API call fails with: \"Invalid requests[0].deleteContentRange: The range should not be empty.\"\n\nThis suggests the code is trying to delete existing content before inserting new content, but when the header is empty, there's nothing to delete.\n\n## Expected Behavior:\nThe tool should handle empty headers/footers gracefully and simply insert the new content.\n\n## Actual Behavior:\nThe operation fails with a confusing error about 'content structure'.\n\n## Impact:\nUsers cannot add headers/footers to documents that don't already have them (or have empty ones).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:31:15.538415-06:00","updated_at":"2025-12-06T17:31:22.911509-06:00","closed_at":"2025-12-06T17:31:22.911509-06:00","labels":["bug","gdocs","header-footer"]}
{"id":"google_workspace_mcp-481d","content_hash":"1d1a4ab0fa7e3a87575cda2743c46ea94d61eecca4f897be9746b13690708b23","title":"Add small caps text formatting to modify_doc_text","description":"Add small_caps parameter (bool) to modify_doc_text using smallCaps: true in updateTextStyle API request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:41:26.057321-08:00","updated_at":"2025-12-05T04:47:57.121536-08:00","closed_at":"2025-12-05T04:47:57.121536-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-4c71","content_hash":"a4d47d2484a0c0c8c693a71056bc9aef1de4d10da8b09c8f637fffc35308467a","title":"update_doc_headers_footers fails when header/footer is empty","description":"When trying to update a header or footer using update_doc_headers_footers, the operation fails with error 'Could not find content structure in header to update'.\n\n## Steps to reproduce:\n1. Call update_doc_headers_footers on a document with no existing header content\n2. Provide section_type='header', content='Test Header', create_if_missing=True\n\n## Expected behavior:\nThe header should be created with the specified content\n\n## Actual behavior:\nError: 'API error during update_header_footer: Could not find content structure in header to update'\n\nThe underlying error is: 'Invalid requests[0].deleteContentRange: The range should not be empty.'\n\n## Root cause suspicion:\nThe code tries to delete existing content before inserting new content, but when the header is empty there's nothing to delete. The logic needs to handle the case where the header exists but has no content.\n\n## File: gdocs/managers/header_footer_manager.py","status":"closed","priority":2,"issue_type":"task","assignee":"mbradshaw","created_at":"2025-12-06T15:43:22.130699-06:00","updated_at":"2025-12-06T15:47:03.289259-06:00","closed_at":"2025-12-06T15:47:03.289259-06:00"}
{"id":"google_workspace_mcp-4d9d","content_hash":"ad51270d456a578838d98075f338457c89179181dd878dd74e43152933f53c22","title":"Add clear_formatting tool to remove all text formatting","description":"No way to clear/remove all formatting from text, returning it to default style. This is a common operation when copying text from other sources. Should use Google Docs API to reset text style properties to defaults.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:34:22.167095-06:00","updated_at":"2025-12-06T15:20:24.415699-06:00","closed_at":"2025-12-06T15:20:24.415699-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-4e06","content_hash":"53eec182069799cfc9b7a2dad03882e41bdbb2d48ad9fcd74652cffa6322ef73","title":"Test harness auto-converts numeric strings to integers causing crashes","description":"When passing pure numeric strings like '2' to the test harness (e.g., --text \"2\"), the argument parsing logic in test_harness.py line 277-278 auto-converts them to integers. This causes crashes when the gdocs tools try to process these as strings.\n\n## How to reproduce:\n```bash\npython test_harness.py --tool modify_doc_text --document_id \"...\" --text \"2\" --location \"end\"\n```\n\n## Expected behavior:\nThe text parameter should remain a string \"2\" and be inserted into the document.\n\n## Actual behavior:\nThe harness converts \"2\" to integer 2, and then the code crashes with:\n```\nTypeError: argument of type 'int' is not iterable\n```\nat gdocs/docs_helpers.py line 82 in interpret_escape_sequences().\n\n## Root cause:\ntest_harness.py lines 277-278 checks if a value is purely numeric and converts it:\n```python\nelif value.isdigit() or (value.startswith('-') and value[1:].isdigit()):\n    tool_kwargs[param_name] = int(value)\n```\n\n## Suggested fix:\nEither:\n1. Add logic to skip auto-conversion for known string parameters (text, search, etc.)\n2. Use type annotations from the tool's signature to guide conversion\n3. Add quotes-stripping for string parameters to preserve the string type","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T18:38:12.136751-06:00","updated_at":"2025-12-06T18:43:52.57879-06:00","closed_at":"2025-12-06T18:43:52.57879-06:00"}
{"id":"google_workspace_mcp-4f90","content_hash":"6ef83a3d2c0bac3fc4f89c4d9860da196b9159894b031e56ecece61aa46aa6ab","title":"insert_doc_elements missing nested list support","description":"## Summary\nThe insert_doc_elements tool can insert lists with multiple items, but there's no way to create nested/indented list items. Users often need hierarchical lists.\n\n## Current Limitation\nThe 'items' parameter is a flat list of strings. There's no way to specify nesting level or parent-child relationships between list items.\n\n## Expected Behavior\nShould be able to create nested lists like:\n- Item 1\n  - Subitem 1.1\n  - Subitem 1.2\n- Item 2\n\n## Potential Solutions\n1. Add 'nesting_level' or 'indent' property to items\n2. Accept nested list structure: [['Item 1', ['Subitem 1.1', 'Subitem 1.2']], 'Item 2']\n3. Add separate tool for indenting/outdenting list items\n\n## Use Cases\n- Creating outlines\n- Hierarchical documentation\n- Nested bullet points for detailed information\n\n## Files Likely Affected\n- gdocs/docs_tools.py (insert_doc_elements function)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:37:45.210842-06:00","updated_at":"2025-12-06T17:22:45.178454-06:00","closed_at":"2025-12-06T17:22:45.178454-06:00"}
{"id":"google_workspace_mcp-4fcb","content_hash":"38e7d1639cde14857f01fa6df74fbb60c14f1430826a4ef1ff6d23e4e3553dda","title":"get_doc_section includes content from next heading as subsection when next heading is same level","description":"When inserting text at the end of a section using section_position='end', and the insertion is followed by another heading at the same level, get_doc_section returns content from both sections.\n\n**Steps to Reproduce:**\n1. Use modify_doc_text with heading='The New Identity' and section_position='end' to insert text\n2. Call get_doc_section for 'The New Identity'\n\n**Expected:**\nThe section content should end at the boundary before the next same-level heading.\n\n**Actual:**\nThe section content includes text from the following 'The Multi-Agent Architecture' heading and its subsections, incorrectly treating them as part of 'The New Identity' section.\n\n**Evidence:**\nWhen calling get_doc_section for 'The New Identity', the content field includes text like 'The Multi-Agent Architecture' and 'The Agent Ensemble' which are separate sections.\n\nThe subsections array shows empty headings and misidentified subsections:\n- Empty heading at level 2\n- 'The Agent Ensemble' at level 3\n- 'The Information Flow (The Firewall)' at level 3\n\nThese should not be considered subsections of 'The New Identity' since 'The Multi-Agent Architecture' is a level 2 heading that should terminate 'The New Identity' section.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T18:17:21.110188-06:00","updated_at":"2025-12-06T18:25:02.456331-06:00","closed_at":"2025-12-06T18:25:02.456331-06:00","labels":["gdocs","section-handling"]}
{"id":"google_workspace_mcp-50ed","content_hash":"7d8f25fb32a237aa75b4876df2fa9f52e17934edf5b6c03b8668e7cc61539085","title":"Response message shows 'Applied formatting (bold)' even when removing bold","description":"**Problem**: When using `bold=False` to remove bold formatting, the response message says 'Applied formatting (bold)' which is confusing because it suggests bold was applied, not removed.\n\n**Reproduction**:\n```python\n# Remove bold from text\nawait call('modify_doc_text',\n           search='BOLD_TEXT',\n           position='replace',\n           text='NOT_BOLD',\n           bold=False)\n```\n\n**Result**: Response includes:\n```\n'legacy_message': 'Replaced text from index X to Y; Applied formatting (bold) to range...'\n```\n\n**Expected**: When bold=False, the message should say something like:\n- 'Removed bold formatting from range...'\n- 'Applied formatting (bold=False) to range...'\n- 'Cleared bold formatting in range...'\n\n**Impact**: Users may think their bold removal didn't work because the message says 'Applied formatting (bold)'.\n\n**Files involved**: gdocs/docs_tools.py - the response message generation in modify_doc_text","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T15:00:54.978011-06:00","updated_at":"2025-12-06T15:11:46.202537-06:00","closed_at":"2025-12-06T15:11:46.202537-06:00"}
{"id":"google_workspace_mcp-5211","content_hash":"5a48373a8cd02b3595ea3e6c2a18e74594773014a2588a2b75ae96b1259c3c60","title":"Test harness: negative integers not parsed correctly from CLI arguments","description":"## Bug Description\n\nWhen using the test harness from the command line, negative integers (like `--occurrence -1`) are passed as strings instead of integers because the `.isdigit()` check doesn't handle negative numbers.\n\n## Location\n`test_harness.py` around line 276\n\n## Original Code\n```python\nelif value.isdigit():\n    tool_kwargs[param_name] = int(value)\n```\n\n## Fix Applied\nChanged to:\n```python\nelif value.isdigit() or (value.startswith('-') and value[1:].isdigit()):\n    tool_kwargs[param_name] = int(value)\n```\n\n## Impact\nWithout this fix, any tool that uses negative integer parameters (like `occurrence=-1` for 'last occurrence') will fail with a type error.\n\n## Status\nFix has been applied locally. Should be committed.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:26:58.173713-06:00","updated_at":"2025-12-06T16:32:54.588663-06:00","closed_at":"2025-12-06T16:32:54.588663-06:00","labels":["test-harness"]}
{"id":"google_workspace_mcp-5341","content_hash":"a77bac6542eb87638c9b4ad4ab8523e939cb680c4008155129cb97b326f1f7e5","title":"No way to create nested/hierarchical lists (sub-items)","description":"The insert_doc_elements tool with element_type='list' only supports creating flat lists. There is no way to create nested/hierarchical list items (indented sub-items).\n\n## Steps to Reproduce:\n1. Insert a list item: insert_doc_elements(element_type='list', list_type='UNORDERED', text='Parent item')\n2. Try to add a nested child item - there is no 'level' or 'nesting_level' parameter\n\n## Current Behavior:\nEach call to insert_doc_elements creates a new list item at the root level. The tool has no parameters for:\n- nesting_level\n- indent_level\n- parent_item\n- continue_list\n\n## Expected Behavior:\nShould support creating nested lists like:\n- Parent item\n  - Child item 1\n  - Child item 2\n    - Grandchild item\n\n## Workaround Attempted:\nTried adding space prefix to text but this just creates text with spaces, not an indented list item.\n\n## API Reference:\nThe Google Docs API supports list nesting through bullet presets and indentation. This capability should be exposed.\n\n## Impact:\nUsers cannot create properly structured hierarchical lists, which are common in documentation, outlines, and structured content.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:35:49.062055-06:00","updated_at":"2025-12-06T18:00:52.913382-06:00","closed_at":"2025-12-06T18:00:52.913382-06:00","labels":["feature-request","gdocs","insert_doc_elements","lists"]}
{"id":"google_workspace_mcp-5b1c","content_hash":"b0cfe0d844208b51ec3832dbc8471af7a68a72caccc807366bd5fd1c24472159","title":"No tool to get text formatting/style information at a specific location","description":"There is no way to read the formatting/style attributes of text at a specific location in the document. This prevents implementing 'copy formatting' or 'match formatting' workflows.\n\n## Use Case:\nUser wants to:\n1. Find text that is formatted a certain way\n2. Apply the same formatting to other text (copy format / format painter)\n\n## Current Situation:\n- get_element_context() returns section/heading information but NOT text formatting\n- There is no tool like 'get_text_formatting(index)' or 'get_text_style(start, end)'\n\n## Expected Behavior:\nShould be able to get:\n- Bold, italic, underline, strikethrough status\n- Font family and size\n- Text color (foreground/background)\n- Link URL if present\n- Subscript/superscript status\n\n## Example Desired API:\n```python\nresult = get_text_formatting(document_id='...', start_index=100, end_index=110)\n# Returns:\n{\n  \"bold\": true,\n  \"italic\": false,\n  \"font_size\": 12,\n  \"font_family\": \"Arial\",\n  \"foreground_color\": \"#FF0000\",\n  ...\n}\n```\n\n## Impact:\nCannot implement format copying or format matching workflows. Cannot programmatically analyze document formatting patterns.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:35:59.443537-06:00","updated_at":"2025-12-06T17:37:03.40766-06:00","closed_at":"2025-12-06T17:37:03.40766-06:00","labels":["feature-request","gdocs","text-formatting"]}
{"id":"google_workspace_mcp-5cc1","content_hash":"5a3e735fc3edb6060a5866f1d27283064777a7011d26a8e9744ab2fc024b5bce","title":"batch_edit_doc does not support location parameter","description":"**Problem**: `batch_edit_doc` does not support `location='end'` for insert operations, even though the `modify_doc_text` tool supports this convenient parameter.\n\n**Reproduction**:\n```python\nawait call('batch_edit_doc', operations=[\n    {'type': 'insert', 'location': 'end', 'text': '[TEST]'}\n])\n```\n\n**Result**: Returns error 'Must specify at least one request.' because the location parameter is silently ignored and no valid request is generated.\n\n**Expected**: Either:\n1. Support `location='end'` and `location='start'` in batch operations (preferred for API consistency)\n2. Or return a clear validation error like 'location parameter not supported, use index or search instead'\n\n**Impact**: Users who learn the `location` parameter from `modify_doc_text` will be confused when it silently fails in `batch_edit_doc`. This is a significant usability issue.\n\n**Related**: This is part of the broader API inconsistency issue where different tools use different parameters for the same concept (location vs omitting index vs after_heading).\n\n**Files involved**: gdocs/docs_tools.py - batch_edit_doc function around line 2952, and potentially gdocs/managers/batch_operation_manager.py","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T14:58:32.971478-06:00","updated_at":"2025-12-06T15:09:24.115297-06:00","closed_at":"2025-12-06T15:09:24.115297-06:00"}
{"id":"google_workspace_mcp-5d9c","content_hash":"b2ac99f0cd4fb9e738b2e3d9d97968ddc6949078f445f8755d7d1b3988aa8869","title":"Heading style inheritance bleeds into subsequent paragraphs after insert","description":"When inserting text immediately after a heading, subsequent paragraphs incorrectly inherit the heading style, even when auto_normal_text_applied tries to prevent this.\n\n**Steps to Reproduce:**\n1. Insert a heading using modify_doc_text with heading_style='HEADING_2'\n2. Immediately insert text after it with location='end'\n3. Check the doc structure\n\n**Expected:**\nThe text after the heading should be normal paragraph text, not a heading.\n\n**Actual:**\nThe text after the heading is shown as HEADING_2 style in get_doc_structure output. Looking at the doc structure, 'More content that should go away.' appears as a level 2 heading when it should be normal paragraph text.\n\n**Evidence from get_doc_structure:**\n```json\n{\n  \"level\": 2,\n  \"text\": \"More content that should go away.\",\n  \"start_index\": 182470,\n  \"end_index\": 182504\n}\n```\n\nThe system did attempt to prevent this (auto_normal_text_applied: true), but the fix doesn't appear to be working completely - subsequent lines after the first still inherit the heading style.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T18:17:30.050291-06:00","updated_at":"2025-12-06T18:29:15.261238-06:00","closed_at":"2025-12-06T18:29:15.261238-06:00","labels":["formatting","gdocs","heading-style"]}
{"id":"google_workspace_mcp-5e76","content_hash":"eb1bf616a24d6a35d9075f7a1acaf50b98b153b01bddfebe8cb761fbc41c2891","title":"batch_edit_doc: insert 'after' a search term appends to the same line instead of inserting on a new line","description":"When using batch_edit_doc with position='after' and a search term, the text is appended to the same line/paragraph as the search term, rather than being inserted on a new line after it.\n\nSteps to reproduce:\n1. Have a document with a heading 'The Bandwidth Gap'\n2. Call batch_edit_doc with:\n   - operations: [{'type': 'insert', 'search': 'The Bandwidth Gap', 'position': 'after', 'text': ' [INSERTED AFTER BANDWIDTH GAP]'}]\n3. Result: The heading becomes 'The Bandwidth Gap [INSERTED AFTER BANDWIDTH GAP]'\n\nExpected behavior: The text should be inserted after the heading paragraph, not concatenated to it. This changes the heading text itself, making it harder to find the section later.\n\nIf the user wants to append to the same line, they should use position='replace' with the full text. position='after' implies inserting after the element, not within it.\n\nNote: This may be by design, but it's counterintuitive for users who want to insert content 'after' a section heading.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T17:16:51.490715-06:00","updated_at":"2025-12-06T17:22:17.102032-06:00","closed_at":"2025-12-06T17:22:17.102032-06:00","comments":[{"id":6,"issue_id":"google_workspace_mcp-5e76","author":"mbradshaw","text":"## Analysis\n\nAfter investigating the code and tests, this behavior is **by design**, not a bug.\n\n### Current Behavior\n\nThe `position='after'` option is designed to insert text at the **character position immediately after the found text**. This is consistent with how search-based positioning works:\n\n- `before`: Insert at the character position just before the found text\n- `after`: Insert at the character position just after the found text  \n- `replace`: Replace the found text with new text\n\nSee gdocs/docs_helpers.py:590-592 and tests in gdocs/test_batch_modify.py:1529-1540.\n\n### Why This Design?\n\nThis character-level positioning is useful for:\n1. Adding suffixes to words (e.g., 'TODO' ‚Üí 'TODO (completed)')\n2. Inserting text immediately after a marker\n3. Appending to specific text without knowing the paragraph structure\n\n### Workaround\n\nIf you want to insert content **after a heading/paragraph** (on a new line):\n\n1. Include a newline prefix in your text: text='\\n\\nNew content here'\n2. Or use range_spec with extend='paragraph' to target the full paragraph\n\n### Recommendation\n\nClosing as **by design**. Created separate P3 feature request google_workspace_mcp-XXXX for a new option like extend='paragraph' for search-based positioning.","created_at":"2025-12-06T23:22:11Z"},{"id":7,"issue_id":"google_workspace_mcp-5e76","author":"mbradshaw","text":"Created follow-up feature request: google_workspace_mcp-69fd (Add paragraph-level search positioning)","created_at":"2025-12-06T23:22:38Z"}]}
{"id":"google_workspace_mcp-5f7b","content_hash":"c0692f763e283a862af0fafae6723c4810569b664ed83deacbb463ed2a038fa6","title":"insert_doc_elements missing section_break, column_break, and horizontal_rule element types","description":"The insert_doc_elements tool is missing several important element types that the Google Docs API supports.\n\n## Missing Element Types:\n1. **section_break** - Insert section breaks (next page, continuous, etc.)\n2. **column_break** - Insert column breaks\n3. **horizontal_rule** - Insert horizontal divider lines\n\n## Current Supported Types:\n- table\n- list\n- page_break\n\n## Steps to Reproduce:\n```python\n# All of these return error: 'Use one of: table, list, page_break'\ninsert_doc_elements(element_type='section_break', location='end')\ninsert_doc_elements(element_type='column_break', location='end')\ninsert_doc_elements(element_type='horizontal_rule', location='end')\n```\n\n## Expected Behavior:\nThese element types should be supported as they are common document elements.\n\n## Use Cases:\n- Section breaks: Multi-section documents with different headers/footers\n- Column breaks: Multi-column layouts\n- Horizontal rules: Visual separation between sections\n\n## API Reference:\nGoogle Docs API supports InsertSectionBreak, InsertColumnBreak, and InsertHorizontalRule requests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:34:11.48638-06:00","updated_at":"2025-12-06T17:51:42.976079-06:00","closed_at":"2025-12-06T17:51:42.976079-06:00","labels":["feature-request","gdocs","insert_doc_elements"],"comments":[{"id":8,"issue_id":"google_workspace_mcp-5f7b","author":"mbradshaw","text":"## Resolution\n\n### Implemented:\n1. **section_break** - Added support for section breaks with `section_type` parameter (NEXT_PAGE or CONTINUOUS)\n2. **horizontal_rule** - Was already implemented before this issue was created\n\n### Not Implemented (API Limitation):\n3. **column_break** - The Google Docs API does not support InsertColumnBreak. Column breaks can only be created manually through the Google Docs UI. The API can read existing column breaks but cannot create new ones. (Source: https://stackoverflow.com/questions/65858691/google-docs-api-insert-column-break)\n\n### Changes Made:\n- Added `create_insert_section_break_request()` helper function in docs_helpers.py\n- Added `section_break` element type support in `insert_doc_elements()`\n- Added `section_type` parameter to specify NEXT_PAGE (default) or CONTINUOUS section breaks\n- Added unit tests in test_section_break.py\n\n### Usage Example:\n```python\n# Insert a section break that starts on the next page\ninsert_doc_elements(element_type='section_break', location='end', section_type='NEXT_PAGE')\n\n# Insert a continuous section break (starts immediately)\ninsert_doc_elements(element_type='section_break', location='end', section_type='CONTINUOUS')\n```","created_at":"2025-12-06T23:51:38Z"}]}
{"id":"google_workspace_mcp-605f","content_hash":"d35667a609a70a3b5c57618c3f88b08826b6e301673d81bd52b3dbb08fbf019a","title":"batch_modify_doc requires 'type' field but users expect simpler API","description":"The batch_modify_doc function requires a 'type' field in each operation dictionary, but users coming from modify_doc_text expect they can just pass the same parameters without specifying 'type'.\n\n**Steps to Reproduce:**\n1. Call batch_modify_doc with operations like:\n   `[{'search': 'foo', 'position': 'after', 'text': 'bar'}]`\n2. Observe error: Missing 'type' field in operation\n\n**Expected Behavior:**\nThe function should either:\n1. Infer the operation type from the parameters provided (if 'text' present and no existing range = insert)\n2. OR default to 'insert' when 'type' is not specified\n3. OR provide clearer documentation with examples in the error message\n\n**Actual Behavior:**\nReturns generic error 'Missing type field in operation' without showing what types are available or examples.\n\n**Current required format:**\n`[{'type': 'insert', 'search': 'foo', 'position': 'after', 'text': 'bar'}]`\n\n**Suggested Fix:**\nEither infer type automatically or improve error message:\n```json\n{\n  \"error\": true,\n  \"code\": \"MISSING_OPERATION_TYPE\",\n  \"message\": \"Missing 'type' field in operation at index 0\",\n  \"suggestion\": \"Add type field. Valid types: insert, delete, replace, format, find_replace, insert_table\",\n  \"example\": {\"type\": \"insert\", \"search\": \"foo\", \"position\": \"after\", \"text\": \"bar\"}\n}\n```\n\n**Location:** gdocs/docs_tools.py, batch_modify_doc function\n\n**Impact:** Users have to read documentation to figure out required format.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:47:00.489897-06:00","updated_at":"2025-12-06T18:52:17.226051-06:00","closed_at":"2025-12-06T18:52:17.226051-06:00"}
{"id":"google_workspace_mcp-63f7","content_hash":"66c0324b64e353a007248461f9543bb9ef4b4a38e0961932e9c0ccf4b062df40","title":"update_doc_headers_footers cannot create new headers/footers","description":"The update_doc_headers_footers function only updates existing headers/footers but cannot create them if they don't exist in the document.\n\n**Steps to Reproduce:**\n1. Open a document without headers/footers\n2. Call update_doc_headers_footers(section_type='header', content='Test Header')\n3. Observe error: 'No header found in document. Please create a header first in Google Docs.'\n\n**Expected Behavior:**\nThe function should either:\n1. Create the header/footer if it doesn't exist (preferred - more intuitive for users)\n2. OR clearly document this limitation and provide a separate create_header/create_footer function\n\n**Actual Behavior:**\nReturns error asking user to manually create header in Google Docs first, which defeats the purpose of automation.\n\n**Suggested Fix:**\nRename to 'set_doc_headers_footers' and implement creation logic using Google Docs API's createHeader/createFooter operations when the header/footer doesn't exist.\n\n**Location:** gdocs/docs_tools.py, update_doc_headers_footers function\n\n**Impact:** Users cannot fully automate document creation with headers/footers.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T14:46:04.152412-06:00","updated_at":"2025-12-06T15:15:01.935267-06:00","closed_at":"2025-12-06T15:15:01.935267-06:00"}
{"id":"google_workspace_mcp-66a1","content_hash":"6f28e5483c2e6348fd4b7e43d6a7b3af66f61d82e34ff715b7104a18a348e292","title":"Google Docs MCP API Improvements","description":"Epic for improving the Google Docs MCP tools to be more usable for AI agents. The current API requires manual character position calculation which is error-prone and unintuitive. This epic covers improvements including search-based positioning, combined operations, structural navigation, better error handling, and more.\n\n## Goals\n- Make the API more intuitive for AI agents and humans\n- Reduce errors from position miscalculation\n- Enable semantic document editing (by heading, section, search term)\n- Improve performance with batch operations\n- Provide better feedback and error recovery\n\n## Priority Breakdown\n- P0: Search-based positioning, Combined insert+format\n- P1: Structural navigation, Return updated positions, Better errors\n- P2: Batch operations, Range-based selection\n- P3: Preview mode, Undo/history, Smart extraction\n\n## Success Criteria\n- AI agents can edit documents without calculating character positions\n- Single operations replace multi-step workflows\n- Error messages guide users to correct solutions\n- Document structure is navigable programmatically","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-04T13:20:50.518179-08:00","updated_at":"2025-12-04T15:51:29.49938-08:00","closed_at":"2025-12-04T15:51:29.49938-08:00","labels":["enhancement","google-docs","mcp"]}
{"id":"google_workspace_mcp-66a1.1","content_hash":"f352f8eb02a7e9716e38836588266156697bfdac3ae259549af6d2ddca817af2","title":"Add search-based text positioning to modify_doc_text","description":"## Problem\nCurrently, `modify_doc_text` requires exact character positions (`start_index`, `end_index`), which is error-prone and requires reading the entire document to calculate positions.\n\n## Solution\nAdd a `search` parameter that finds text positions automatically, with a `position` parameter to specify where relative to the found text.\n\n## Proposed API Changes\n\n### New Parameters for `modify_doc_text`:\n- `search` (string, optional): Text to search for in the document\n- `position` (enum, optional): Where to insert relative to search result\n  - `before`: Insert before the found text\n  - `after`: Insert after the found text  \n  - `replace`: Replace the found text entirely\n- `occurrence` (int, optional, default=1): Which occurrence to target (1=first, 2=second, -1=last)\n\n### Example Usage:\n```python\n# Instead of calculating positions:\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"The Velocity Trap\",\n    position=\"after\",\n    text=\"[Editor's Note: Updated Dec 2024]\"\n)\n\n# Replace specific text:\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"old heading text\",\n    position=\"replace\",\n    text=\"new heading text\"\n)\n\n# Target specific occurrence:\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"TODO\",\n    occurrence=2,  # Second occurrence\n    position=\"replace\",\n    text=\"DONE\"\n)\n```\n\n## Implementation Steps\n\n1. **Add new parameters to tool schema** in the MCP tool definition\n2. **Implement search logic**:\n   - Use Google Docs API to get document content\n   - Find all occurrences of search text\n   - Calculate start/end indices based on `position` parameter\n3. **Handle edge cases**:\n   - Search text not found ‚Üí return clear error with suggestions\n   - Multiple occurrences ‚Üí use `occurrence` param or error if ambiguous\n   - Empty search string ‚Üí validation error\n4. **Update response** to include:\n   - `found_at_index`: Where the search text was found\n   - `inserted_at_index`: Where new text was inserted\n5. **Add tests** for:\n   - Basic search and insert before/after/replace\n   - Multiple occurrences handling\n   - Not found error cases\n   - Special characters in search text\n\n## Files to Modify\n- Look for the `modify_doc_text` tool definition (likely in `src/` or tool handlers)\n- Update schema with new parameters\n- Implement search logic before calling Google Docs API\n\n## Acceptance Criteria\n- [ ] `search` parameter finds text and calculates position automatically\n- [ ] `position` parameter supports before/after/replace\n- [ ] `occurrence` parameter allows targeting specific matches\n- [ ] Clear error when search text not found\n- [ ] Response includes actual positions used\n- [ ] Existing `start_index`/`end_index` API still works (backward compatible)\n- [ ] Unit tests cover happy path and edge cases","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-04T13:21:19.776619-08:00","updated_at":"2025-12-04T13:48:01.788369-08:00","closed_at":"2025-12-04T13:48:01.788369-08:00","labels":["enhancement","google-docs","p0"]}
{"id":"google_workspace_mcp-66a1.10","content_hash":"38f6ce8ba3c557696471e307c8760d913ad4659ba0cda8b40da13b76838f1931","title":"Add preview_search_results debug tool","description":"## Problem\nUsers have no way to preview what text will be matched by a search operation before executing it. This leads to unexpected modifications when there are multiple occurrences or when search text spans fragmented text runs.\n\n## Goal\nCreate a debug tool that shows what a search will match before any modification is applied.\n\n## Proposed Tool\n```python\n@server.tool()\nasync def preview_search_results(\n    service, document_id, search_text, match_case=True\n) -\u003e str:\n    doc = await get_doc(document_id)\n    all_matches = find_all_occurrences_in_document(doc, search_text, match_case)\n    # Return each match with surrounding context\n    # Shows: match 1 at 100-110, match 2 at 250-260, etc.\n```\n\n## Acceptance Criteria\n- Tool shows all occurrences of search text in document\n- Each match shows surrounding context (e.g., 50 chars before/after)\n- Returns expected character ranges for each match\n- Handles case sensitivity option\n- Useful error message if no matches found\n\n## Files to Modify\n- gdocs/docs_tools.py - add new tool\n- Uses existing find_all_occurrences_in_document from docs_helpers.py\n\n## Estimated Effort\n4-6 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T14:33:00.170029-08:00","updated_at":"2025-12-04T14:46:13.923581-08:00","closed_at":"2025-12-04T14:46:13.923581-08:00","labels":["enhancement","google-docs","search"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.10","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.091198-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.11","content_hash":"a87c72000aec4e900378afeb27d59907bfc162e9ac7683c816a54c4f646b88e5","title":"Complete batch operation auto-adjustment implementation","description":"## Problem\nThe batch_modify_doc has an auto_adjust_positions flag but the implementation is incomplete. The execute_batch_with_search() method stub needs completion.\n\n## Goal\nFinish the auto-adjustment feature so batch operations automatically track position shifts and adjust subsequent operations.\n\n## Technical Details\n- BatchOperationManager has position tracking infrastructure\n- Need to create helper _adjust_operation_positions() that applies cumulative shifts\n- Process operations sequentially to track position drift\n- Tests in test_batch_modify.py show work-in-progress\n\n## Acceptance Criteria\n- auto_adjust_positions=true works correctly\n- Operations processed in order with cumulative shift tracking\n- Each operation receives adjusted positions based on prior operations\n- Clear error messages if adjustment fails\n- Tests pass in test_batch_modify.py\n\n## Files to Modify\n- gdocs/managers/batch_operation_manager.py\n- gdocs/test_batch_modify.py\n\n## Estimated Effort\n6-8 hours","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T14:33:10.444144-08:00","updated_at":"2025-12-04T14:49:15.127658-08:00","closed_at":"2025-12-04T14:49:15.127658-08:00","labels":["batch","enhancement","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.11","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.105364-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.12","content_hash":"113f84ff0fd1a7e80d913044bee6c0587870eb861ea223f074e6597fb5a7c715","title":"Improve range resolution reliability","description":"## Problem\nRange resolution has several edge cases that need improvement:\n- Boundary detection for sentences uses simple regex ([.!?]) which is too basic\n- Section hierarchy awareness for nested sections is weak\n- No validation that extended ranges don't go backward\n- Character offset overflow protection exists but could be improved\n\n## Goal\nMake range-based selection more reliable and predictable.\n\n## Technical Details\nCurrent range formats supported:\n- Search bounds: {start: {search: \"text\"}, end: {search: \"text\"}}\n- Boundary extension: {search: \"text\", extend: \"paragraph\"}\n- Character offsets: {search: \"text\", before_chars: 50, after_chars: 100}\n- Section reference: {section: \"Heading Name\"}\n\n## Acceptance Criteria\n- Improve sentence boundary detection (handle abbreviations, etc.)\n- Add section hierarchy awareness for nested sections\n- Validate extended ranges don't go backward (start \u003e end)\n- Better overflow protection for character offsets\n- Clear error messages explaining what went wrong\n\n## Files to Modify\n- gdocs/docs_helpers.py (resolve_range_* functions)\n\n## Estimated Effort\n5-7 hours","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T14:33:21.50995-08:00","updated_at":"2025-12-04T14:53:29.079497-08:00","closed_at":"2025-12-04T14:53:29.079497-08:00","labels":["enhancement","google-docs","range"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.12","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.119287-08:00","created_by":"mbradshaw"}],"comments":[{"id":2,"issue_id":"google_workspace_mcp-66a1.12","author":"mbradshaw","text":"Implemented all improvements:\n\n1. **Improved sentence boundary detection**: Added handling for common abbreviations (Mr., Mrs., Dr., etc.) to avoid false sentence breaks. The new implementation properly recognizes abbreviations and doesn't treat them as sentence ends.\n\n2. **Section hierarchy awareness**: Fixed section extension to properly handle nested sections. A parent section (H1) now includes all subsections (H2, H3, etc.) and only ends at the next sibling or higher-level heading.\n\n3. **Range validation**: Added validation to ensure extended ranges don't go backward (start \u003e end) and that the extended range still contains the original search result. Clear error messages are provided when validation fails.\n\n4. **Character offset protection**: Added validation for negative offset values and improved overflow protection. Informative messages are now provided when clamping occurs due to document bounds.\n\n5. **Clear error messages**: All error messages now include actionable guidance explaining what went wrong and how to fix it.\n\nTests: All 161 gdocs tests pass, including 9 new tests specifically for the improvements.","created_at":"2025-12-04T22:53:46Z"}]}
{"id":"google_workspace_mcp-66a1.13","content_hash":"9db556afdc9944178054f0008e7e357026459fcf5c4685e6c850148476d4b9a9","title":"Add structural navigation helper tools","description":"## Problem\nUsers need better ways to navigate document structure programmatically beyond current heading-based navigation.\n\n## Goal\nAdd helper functions and tools for structural navigation.\n\n## Proposed Functions\n- find_elements_by_type() - find all tables, lists, headings in document\n- get_element_ancestors() - find parent section of any element\n- get_siblings() - find next/previous heading at same level\n\n## Acceptance Criteria\n- Can query document for all elements of a specific type\n- Can determine what section/heading any element belongs to\n- Can navigate between sibling headings at same level\n- Tools exposed via MCP for AI agent use\n\n## Files to Modify\n- gdocs/docs_structure.py - new functions\n- gdocs/docs_tools.py - new tools\n\n## Estimated Effort\n8-10 hours","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T14:33:29.809356-08:00","updated_at":"2025-12-04T14:59:03.679983-08:00","closed_at":"2025-12-04T14:59:03.679983-08:00","labels":["enhancement","google-docs","navigation"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.13","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.133063-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.14","content_hash":"04c76fa796ba56f7618e6c35066cd8fe15c1d97b1f1ca503feb8acb80d34e92f","title":"Extend batch operations with range-based positioning","description":"## Problem\nbatch_modify_doc supports search-based positioning but doesn't fully support range specs in each operation.\n\n## Goal\nAllow batch operations to use the full range specification system.\n\n## Technical Details\n- Extend batch_modify_doc to support range specs in each operation\n- Resolve ranges before executing batch\n- Track position shifts through range calculations\n- Critical: Ranges must resolve BEFORE adjusting, then positions shift\n\n## Acceptance Criteria\n- Batch operations can use range specs (search bounds, boundary extension, etc.)\n- Ranges resolve correctly before batch execution\n- Position shifts track through range calculations\n- Clear errors if range resolution fails\n\n## Files to Modify\n- gdocs/managers/batch_operation_manager.py\n- New test file for batch range operations\n\n## Dependencies\n- Depends on: Complete batch operation auto-adjustment implementation\n\n## Estimated Effort\n10-12 hours","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T14:33:39.922365-08:00","updated_at":"2025-12-04T15:03:53.809218-08:00","closed_at":"2025-12-04T15:03:53.809218-08:00","labels":["batch","enhancement","google-docs","range"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.14","depends_on_id":"google_workspace_mcp-66a1.11","type":"blocks","created_at":"2025-12-04T14:33:50.297656-08:00","created_by":"mbradshaw"},{"issue_id":"google_workspace_mcp-66a1.14","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.147023-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.15","content_hash":"0af16ad48753b00fe6bbf35f10a1a8c6ec67b07f546de4312f8d8fe669600e0b","title":"Add document modification preview mode","description":"## Problem\nUsers have no way to preview the effect of a modification before it's applied. This is risky for complex operations.\n\n## Goal\nAdd a preview/dry-run mode that shows what would change without actually applying it.\n\n## Acceptance Criteria\n- Add preview=true parameter to modify operations\n- Returns what would change (before/after text, positions affected)\n- Does not modify the document\n- Works with all positioning modes (index, search, heading, range)\n\n## Estimated Effort\n8-12 hours","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-04T14:33:58.586108-08:00","updated_at":"2025-12-04T15:42:25.683487-08:00","closed_at":"2025-12-04T15:42:25.683487-08:00","labels":["enhancement","google-docs","preview"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.15","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.161348-08:00","created_by":"mbradshaw"}],"comments":[{"id":3,"issue_id":"google_workspace_mcp-66a1.15","author":"mbradshaw","text":"Implemented preview mode for modify_doc_text:\n\n## Changes Made:\n1. Added extract_text_at_range() helper function to docs_helpers.py\n2. Added preview=False parameter to modify_doc_text()\n3. When preview=True, returns preview info without modifying\n4. Works with all positioning modes (index, location, search, heading, range)\n5. Added unit tests in gdocs/test_preview_mode.py\n\nAll 232 tests pass.","created_at":"2025-12-04T23:42:44Z"}]}
{"id":"google_workspace_mcp-66a1.16","content_hash":"2ea14cfa696ef1cfbc75df55bbf664b67bd7b9706d65c4d247c5a83790a33534","title":"Add undo/operation history tracking","description":"## Problem\nUsers can't undo operations made through the MCP. Google Docs has native undo, but MCP operations don't integrate with it in a trackable way.\n\n## Goal\nAdd operation history tracking and undo capability.\n\n## Acceptance Criteria\n- Track operations performed through MCP per document\n- Provide way to undo recent operations\n- Consider integration with Google Docs revision history\n\n## Estimated Effort\n12-20 hours (complex due to Google Docs API limitations)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-04T14:34:06.613338-08:00","updated_at":"2025-12-04T15:51:05.20051-08:00","closed_at":"2025-12-04T15:51:05.20051-08:00","labels":["enhancement","google-docs","history"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.16","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.175441-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.17","content_hash":"dd859b2e711c43aae625190485af2f190ee0c6c0886683134acc321573b24f04","title":"Add smart content extraction tools","description":"## Problem\nUsers need better ways to extract specific content types from documents (e.g., all links, all images, all code blocks, etc.)\n\n## Goal\nAdd smart extraction tools that can pull specific content types.\n\n## Proposed Tools\n- extract_links() - get all hyperlinks with their text and URLs\n- extract_images() - get all images with their positions\n- extract_code_blocks() - identify and extract code-formatted text\n- extract_summary() - generate document outline/summary\n\n## Acceptance Criteria\n- Can extract each content type reliably\n- Returns structured data (not raw text)\n- Handles various formatting styles\n\n## Estimated Effort\n10-15 hours","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-04T14:34:14.579375-08:00","updated_at":"2025-12-04T15:10:51.49328-08:00","closed_at":"2025-12-04T15:10:51.49328-08:00","labels":["enhancement","extraction","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.17","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.189927-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.18","content_hash":"e155d99da3d11d4fea5a8372b7c21ff4f548fafc61a033b110c712ab8a71bd02","title":"Add location convenience parameter to modify_doc_text","description":"## Problem\nThe most common editing operation - 'add text to the end of document' - requires two API calls:\n1. Call `inspect_doc_structure` to get `total_length`\n2. Call `modify_doc_text` with that index\n\nThis adds latency and complexity for the simplest operation.\n\n## Solution\nAdd a `location` parameter to `modify_doc_text` that accepts semantic location shortcuts:\n\n```python\n# Current (2 calls):\nstructure = inspect_doc_structure(doc_id)\nmodify_doc_text(doc_id, start_index=structure['total_length'], text='New content')\n\n# Proposed (1 call):\nmodify_doc_text(doc_id, location='end', text='New content')\nmodify_doc_text(doc_id, location='start', text='Prepend this')\n```\n\n## Supported Values\n- `end` - append to document end (most common)\n- `start` - insert at beginning (after first section break at index 1)\n\n## Implementation\n- Get document internally to calculate total_length\n- Map location to appropriate start_index\n- Maintain backward compatibility with explicit start_index\n\n## Acceptance Criteria\n- [ ] `location='end'` works without specifying start_index\n- [ ] `location='start'` inserts at beginning\n- [ ] Explicit start_index still works (backward compatible)\n- [ ] Clear error if both location and start_index provided\n\n## Files to Modify\n- gdocs/docs_tools.py - modify_doc_text function\n\n## Estimated Effort\n4-6 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T23:08:50.026892Z","updated_at":"2025-12-04T15:19:10.76357-08:00","closed_at":"2025-12-04T15:19:10.76357-08:00","labels":["dx","enhancement","google-docs","quick-win"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.18","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.026892Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.19","content_hash":"14ea8aad1c88d6a5833e40e5ff693f21422e32e8d0a20ac9a7e098ebc54fe4b3","title":"Auto-index for table creation (make index optional)","description":"## Problem\nCreating a table requires calling `inspect_doc_structure` first to get a safe index. The tool documentation even says \"YOU MUST CALL inspect_doc_structure FIRST\" in caps. This is 3+ round trips minimum for a simple table.\n\n## Solution\nMake `index` parameter optional with smart defaults:\n\n```python\n# Current (requires pre-flight):\nstructure = inspect_doc_structure(doc_id)\ncreate_table_with_data(doc_id, data, index=structure['total_length'])\n\n# Proposed (auto-detect):\ncreate_table_with_data(doc_id, data)  # Appends to end by default\ncreate_table_with_data(doc_id, data, after_heading=\"Data Section\")  # Or specify location\n```\n\n## Implementation\n- If index not provided, fetch document and calculate safe insertion point\n- Support `after_heading` parameter for heading-based positioning\n- Maintain backward compatibility when index is explicitly provided\n\n## Acceptance Criteria\n- [ ] `create_table_with_data` works without `index` parameter\n- [ ] Default behavior appends table to document end\n- [ ] `after_heading` parameter positions table after specified heading\n- [ ] Explicit `index` parameter still works (backward compatible)\n\n## Files to Modify\n- gdocs/docs_tools.py - create_table_with_data function\n- gdocs/managers/table_operation_manager.py\n\n## Estimated Effort\n4-6 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T23:08:50.027114Z","updated_at":"2025-12-04T15:23:45.090364-08:00","closed_at":"2025-12-04T15:23:45.090364-08:00","labels":["enhancement","google-docs","quick-win","tables"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.19","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.027114Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.2","content_hash":"e38f458943304009876b2d8454947a00e42002dd0627e96bdc526cbb530d20e8","title":"Support combined insert and format operations","description":"## Problem\nCurrently, you cannot apply formatting while inserting new text. You must make two separate API calls:\n1. Insert the text\n2. Format the inserted text (requires knowing the new end_index)\n\nThis is slow, error-prone (positions shift after insert), and unintuitive.\n\n## Current Behavior (Broken)\n```python\n# This fails because end_index is required for formatting:\nmodify_doc_text(\n    start_index=100,\n    text=\"IMPORTANT:\",\n    bold=True  # ERROR: end_index required\n)\n```\n\n## Proposed Solution\nWhen inserting text (`text` parameter provided), allow formatting parameters without requiring `end_index`. The formatting should automatically apply to the inserted text.\n\n### Option A: Implicit end_index calculation\n```python\nmodify_doc_text(\n    start_index=100,\n    text=\"IMPORTANT:\",\n    bold=True,\n    italic=True\n)\n# Internally calculates: end_index = start_index + len(text) = 110\n# Inserts text, then applies formatting to range [100, 110]\n```\n\n### Option B: Explicit format object (more flexible)\n```python\nmodify_doc_text(\n    start_index=100,\n    text=\"IMPORTANT:\",\n    format={\n        \"bold\": True,\n        \"italic\": True,\n        \"font_size\": 14,\n        \"foreground_color\": \"#FF0000\"\n    }\n)\n```\n\n## Implementation Steps\n\n1. **Modify parameter validation**:\n   - When `text` is provided AND formatting params are set, don't require `end_index`\n   - Calculate implicit end_index as `start_index + len(text)`\n\n2. **Update the request builder**:\n   - Build a batch request with two operations:\n     1. InsertText at start_index\n     2. UpdateTextStyle for range [start_index, start_index + len(text)]\n   - Execute as single batch to Google Docs API\n\n3. **Handle position shifts correctly**:\n   - After inserting text, the formatting range must account for the insertion\n   - Google Docs API handles this in batch requests, but verify behavior\n\n4. **Support all existing formatting options**:\n   - bold, italic, underline\n   - font_size, font_family\n   - foreground_color, background_color\n   - link (URL)\n\n5. **Update response** to confirm:\n   - Text inserted at position X\n   - Formatting applied to range [X, Y]\n\n## Files to Modify\n- Tool definition/schema for `modify_doc_text`\n- Request builder logic\n- Parameter validation\n\n## Acceptance Criteria\n- [ ] Can insert text with formatting in single call\n- [ ] Works with all formatting options (bold, italic, font_size, colors, etc.)\n- [ ] No `end_index` required when `text` is provided\n- [ ] Response confirms both insertion and formatting\n- [ ] Existing behavior unchanged when `text` not provided (still requires end_index for format-only)\n- [ ] Unit tests for combined insert+format operations\n\n## Dependencies\n- None (can be implemented independently)\n\n## Notes\n- This should use Google Docs batchUpdate to send both operations atomically\n- Consider whether to support `format` object vs individual params (or both)","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-04T13:21:57.692752-08:00","updated_at":"2025-12-04T13:53:18.846396-08:00","closed_at":"2025-12-04T13:53:18.846396-08:00","labels":["enhancement","google-docs","p0"]}
{"id":"google_workspace_mcp-66a1.20","content_hash":"0279f086a7b383f55b304e9824910f533c3e8fd09617e06f87c87cc3d0ffce34","title":"Consolidate batch_update_doc and batch_modify_doc into single tool","description":"## Problem\nThere are two nearly-identical batch editing tools with confusing differences:\n- `batch_update_doc` - uses operation types like `insert_text`, `delete_text`, `format_text`\n- `batch_modify_doc` - uses types like `insert`, `delete`, `format` plus search support\n\nUsers don't know which to use, and the operation type names are inconsistent.\n\n## Solution\nMerge into a single `batch_edit_doc` tool that:\n1. Supports BOTH operation type naming conventions (accept aliases)\n2. Combines all features from both tools\n3. Deprecates the old tools (keep as aliases initially)\n\n```python\n# Single unified tool:\nbatch_edit_doc(doc_id, operations=[\n    {\"type\": \"insert\", \"location\": \"end\", \"text\": \"...\"},  # New style\n    {\"type\": \"insert_text\", \"index\": 100, \"text\": \"...\"},  # Legacy style still works\n    {\"type\": \"replace\", \"search\": \"old\", \"text\": \"new\"},   # Search-based\n])\n```\n\n## Operation Type Mapping\n| Legacy (batch_update_doc) | Modern (batch_modify_doc) | Unified |\n|---------------------------|--------------------------|---------|\n| insert_text | insert | insert (preferred) |\n| delete_text | delete | delete (preferred) |\n| replace_text | replace | replace (preferred) |\n| format_text | format | format (preferred) |\n\n## Acceptance Criteria\n- [ ] Single `batch_edit_doc` tool accepts both naming conventions\n- [ ] Search-based positioning works (from batch_modify_doc)\n- [ ] Auto position adjustment works (from batch_modify_doc)\n- [ ] Legacy tools remain as aliases with deprecation warning\n- [ ] Documentation updated to recommend `batch_edit_doc`\n\n## Files to Modify\n- gdocs/docs_tools.py - merge tools, add unified tool\n- gdocs/managers/batch_operation_manager.py\n\n## Estimated Effort\n6-8 hours","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T23:08:50.027121Z","updated_at":"2025-12-04T15:27:29.946342-08:00","closed_at":"2025-12-04T15:27:29.946343-08:00","labels":["consolidation","enhancement","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.20","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.027121Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.21","content_hash":"f07c5b7c4b3ac712cf31bded237e3e91e18809f11a497c6098dc94c1d9a94f97","title":"Merge inspect_doc_structure and get_doc_structure into single tool","description":"## Problem\nTwo tools provide overlapping document structure information:\n- `inspect_doc_structure` - focused on safe insertion points, table info\n- `get_doc_structure` - focused on hierarchical element view, headings\n\nUsers often need both types of info and must call two separate tools.\n\n## Solution\nMerge into a single `get_doc_info` tool with a detail level parameter:\n\n```python\n# Quick stats and safe indices (for table creation):\nget_doc_info(doc_id, detail=\"summary\")\n\n# Full element hierarchy (for navigation):\nget_doc_info(doc_id, detail=\"structure\")\n\n# Table-focused view:\nget_doc_info(doc_id, detail=\"tables\")\n\n# Everything (current default):\nget_doc_info(doc_id)  # Returns all info\n```\n\n## Detail Level Options\n- `summary` - total_length, element counts, safe insertion indices (fast)\n- `structure` - full hierarchical element view with positions\n- `tables` - table-focused: dimensions, positions, cell data\n- `headings` - just headings outline for navigation\n- `all` (default) - everything combined\n\n## Acceptance Criteria\n- [ ] Single `get_doc_info` tool with `detail` parameter\n- [ ] `detail='summary'` returns quick stats for table creation\n- [ ] `detail='structure'` returns full element hierarchy\n- [ ] Legacy tools remain as aliases\n- [ ] Response format consistent across detail levels\n\n## Files to Modify\n- gdocs/docs_tools.py - merge tools\n- gdocs/docs_structure.py - may need refactoring\n\n## Estimated Effort\n4-6 hours","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T23:08:50.027126Z","updated_at":"2025-12-04T15:31:10.572806-08:00","closed_at":"2025-12-04T15:31:10.572806-08:00","labels":["consolidation","enhancement","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.21","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.027126Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.22","content_hash":"8df4ee5ec553f6715cd07b2b25618de03eccb03c9562bad135954b0c16c5584d","title":"Clarify distinction between find_and_replace_doc and modify_doc_text replace","description":"## Problem\nTwo ways to replace text with overlapping functionality:\n- `find_and_replace_doc` - replaces ALL occurrences globally\n- `modify_doc_text` with `search` + `position='replace'` - replaces ONE occurrence\n\nUsers pick the wrong tool, leading to unexpected results (replacing all when they wanted one, or vice versa).\n\n## Solution\nMake the distinction clearer through:\n\n1. **Better naming** (consider renaming):\n   - `find_and_replace_doc` ‚Üí `replace_all_in_doc` (clearer it's global)\n   - Or keep but add prominent documentation\n\n2. **Clearer documentation** with comparison table:\n   | Use Case | Tool |\n   |----------|------|\n   | Replace ALL occurrences | `find_and_replace_doc` |\n   | Replace SPECIFIC occurrence | `modify_doc_text` with search+position |\n   | Replace by index range | `modify_doc_text` with start/end_index |\n\n3. **Warning in responses** when similar tool might be better:\n   - If `find_and_replace_doc` replaces only 1 occurrence, suggest `modify_doc_text` for single replacements\n   - If `modify_doc_text` replace is called multiple times for same text, suggest `find_and_replace_doc`\n\n## Acceptance Criteria\n- [ ] Tool documentation clearly explains when to use each\n- [ ] Consider renaming `find_and_replace_doc` to `replace_all_in_doc`\n- [ ] Response includes count of replacements made\n- [ ] Add hint in response when other tool might be more appropriate\n\n## Files to Modify\n- gdocs/docs_tools.py - update docstrings, consider rename\n- README or documentation\n\n## Estimated Effort\n2-4 hours","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-04T23:08:50.02713Z","updated_at":"2025-12-04T15:35:41.029806-08:00","closed_at":"2025-12-04T15:35:41.029806-08:00","labels":["documentation","dx","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.22","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.02713Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.23","content_hash":"c2def97c8d3c732736ceca31a09356736467481a431b7ffcdfc6c8537df3ab91","title":"Add operation aliases to normalize batch operation types","description":"## Problem\nbatch_update_doc and batch_modify_doc use different operation type names:\n- `insert_text` vs `insert`\n- `delete_text` vs `delete`  \n- `format_text` vs `format`\n- `replace_text` vs `replace`\n\nThis is confusing and error-prone.\n\n## Quick Fix (Before Full Consolidation)\nAdd alias mapping so BOTH naming conventions work in BOTH tools:\n\n```python\nOPERATION_ALIASES = {\n    'insert_text': 'insert',\n    'delete_text': 'delete',\n    'format_text': 'format',\n    'replace_text': 'replace',\n    # Reverse aliases\n    'insert': 'insert',\n    'delete': 'delete',\n    'format': 'format',\n    'replace': 'replace',\n}\n\ndef normalize_operation_type(op_type):\n    return OPERATION_ALIASES.get(op_type, op_type)\n```\n\n## Acceptance Criteria\n- [ ] Both tools accept both naming conventions\n- [ ] `insert_text` and `insert` are equivalent\n- [ ] Documentation updated to show preferred (shorter) names\n- [ ] No breaking changes to existing integrations\n\n## Files to Modify\n- gdocs/managers/batch_operation_manager.py\n\n## Estimated Effort\n1-2 hours (quick fix)\n\n## Related\nThis is a quick win toward the larger consolidation effort (issue .20)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-04T23:08:50.027136Z","updated_at":"2025-12-04T15:14:12.345384-08:00","closed_at":"2025-12-04T15:14:12.345384-08:00","labels":["enhancement","google-docs","quick-win"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.23","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T23:08:50.027136Z","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.3","content_hash":"e59c0845fffe390bc47ae659c25191ab2ddf5ba98a51479be2acd1135990ffeb","title":"Add structural navigation functions for document elements","description":"## Problem\nThere's no way to navigate or understand document structure (headings, paragraphs, tables, lists). Users must read the entire document and manually parse it to find structural elements.\n\n## Solution\nAdd new MCP tools for document structure navigation:\n\n### 1. `get_doc_structure` - New Tool\nReturns a hierarchical view of the document's structural elements.\n\n```python\nget_doc_structure(document_id=\"...\")\n\n# Returns:\n{\n    \"elements\": [\n        {\n            \"type\": \"heading1\",\n            \"text\": \"The Symbiotic Engineer\",\n            \"start_index\": 0,\n            \"end_index\": 24,\n            \"level\": 1\n        },\n        {\n            \"type\": \"paragraph\",\n            \"text\": \"Introduction paragraph...\",\n            \"start_index\": 25,\n            \"end_index\": 150\n        },\n        {\n            \"type\": \"heading2\",\n            \"text\": \"The Problem\",\n            \"start_index\": 151,\n            \"end_index\": 162,\n            \"level\": 2,\n            \"parent_heading\": \"The Symbiotic Engineer\"\n        },\n        {\n            \"type\": \"list\",\n            \"list_type\": \"bullet\",\n            \"start_index\": 163,\n            \"end_index\": 300,\n            \"items\": [\n                {\"text\": \"First item\", \"start_index\": 163, \"end_index\": 173},\n                {\"text\": \"Second item\", \"start_index\": 174, \"end_index\": 185}\n            ]\n        },\n        {\n            \"type\": \"table\",\n            \"start_index\": 301,\n            \"end_index\": 500,\n            \"rows\": 3,\n            \"columns\": 4\n        }\n    ],\n    \"headings_outline\": [\n        {\"level\": 1, \"text\": \"The Symbiotic Engineer\", \"children\": [\n            {\"level\": 2, \"text\": \"The Problem\"},\n            {\"level\": 2, \"text\": \"The Solution\"}\n        ]}\n    ]\n}\n```\n\n### 2. `get_doc_section` - New Tool\nGet content of a specific section by heading.\n\n```python\nget_doc_section(\n    document_id=\"...\",\n    heading=\"The Problem\",  # Section heading\n    include_subsections=True  # Include nested headings\n)\n\n# Returns:\n{\n    \"heading\": \"The Problem\",\n    \"start_index\": 151,\n    \"end_index\": 450,\n    \"content\": \"Full text of the section...\",\n    \"subsections\": [\n        {\"heading\": \"Sub-problem 1\", \"start_index\": 200, \"end_index\": 300}\n    ]\n}\n```\n\n### 3. Update `modify_doc_text` with structural targeting\nAllow targeting by heading/section in modify operations.\n\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    heading=\"The Problem\",  # Target this section\n    section_position=\"end\",  # end, start, replace\n    text=\"\\n[New content at end of section]\"\n)\n```\n\n## Implementation Steps\n\n1. **Parse Google Docs document structure**:\n   - Use Google Docs API to get document content with structure\n   - Parse the response for structural elements (Paragraph, Heading, List, Table)\n   - Build hierarchical representation\n\n2. **Implement `get_doc_structure` tool**:\n   - Define tool schema with parameters: `document_id`, `element_types` (filter)\n   - Parse and return structured element list\n   - Include heading outline/hierarchy\n\n3. **Implement `get_doc_section` tool**:\n   - Define tool schema\n   - Find heading by text match\n   - Calculate section boundaries (until next same-or-higher-level heading)\n   - Return section content and metadata\n\n4. **Extend `modify_doc_text`**:\n   - Add `heading` and `section_position` parameters\n   - Use get_doc_structure internally to find positions\n   - Support targeting specific sections\n\n## Element Types to Support\n- `heading1` through `heading6`\n- `paragraph`\n- `bullet_list`, `numbered_list`\n- `table`\n- `image`\n- `horizontal_rule`\n- `page_break`\n\n## Files to Create/Modify\n- New tool definitions for `get_doc_structure` and `get_doc_section`\n- Helper functions for parsing Google Docs structure\n- Update `modify_doc_text` schema and implementation\n\n## Acceptance Criteria\n- [ ] `get_doc_structure` returns all structural elements with positions\n- [ ] `get_doc_structure` includes heading hierarchy/outline\n- [ ] `get_doc_section` retrieves content by heading name\n- [ ] Section boundaries correctly calculated (ends at next same-level heading)\n- [ ] `modify_doc_text` supports `heading` parameter for targeting\n- [ ] Handles documents with no headings gracefully\n- [ ] Unit tests for structure parsing\n- [ ] Integration tests with real documents\n\n## Dependencies\n- Should be implemented after or alongside search-based positioning (google_workspace_mcp-66a1.1)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T13:30:50.660175-08:00","updated_at":"2025-12-04T13:59:34.89502-08:00","closed_at":"2025-12-04T13:59:34.89502-08:00","labels":["enhancement","google-docs","p1"]}
{"id":"google_workspace_mcp-66a1.4","content_hash":"5955e1fc2d690a5cb1b126a1b1ece7e9623c08983f5e316ab989e76dbe2372b3","title":"Return updated positions after edit operations","description":"## Problem\nAfter inserting or deleting text, all subsequent character positions in the document shift. Currently, the API doesn't return this information, forcing users to re-read the entire document to calculate new positions for follow-up edits.\n\n## Current Behavior\n```python\nresult = modify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    text=\"INSERTED TEXT\"  # 13 characters\n)\n# Returns: {\"success\": true}\n# But now all positions after 100 are shifted by +13!\n# User must re-read document to find next edit position\n```\n\n## Proposed Solution\nReturn detailed position information after each edit operation.\n\n### Enhanced Response Format\n```python\nresult = modify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    text=\"INSERTED TEXT\"\n)\n\n# Returns:\n{\n    \"success\": true,\n    \"operation\": \"insert\",\n    \"inserted_at\": 100,\n    \"inserted_length\": 13,\n    \"position_shift\": 13,  # All positions \u003e= 100 shifted by this amount\n    \"new_document_length\": 5013,\n    \"affected_range\": {\n        \"start\": 100,\n        \"end\": 113\n    }\n}\n```\n\n### For Replacement Operations\n```python\nresult = modify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    end_index=150,  # Replacing 50 chars\n    text=\"NEW TEXT\"  # With 8 chars\n)\n\n# Returns:\n{\n    \"success\": true,\n    \"operation\": \"replace\",\n    \"replaced_range\": {\"start\": 100, \"end\": 150},\n    \"original_length\": 50,\n    \"new_length\": 8,\n    \"position_shift\": -42,  # Positions after 150 shifted by -42\n    \"new_document_length\": 4958,\n    \"affected_range\": {\n        \"start\": 100,\n        \"end\": 108\n    }\n}\n```\n\n### For Delete Operations\n```python\nresult = modify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    end_index=150,\n    text=\"\"  # Empty = delete\n)\n\n# Returns:\n{\n    \"success\": true,\n    \"operation\": \"delete\",\n    \"deleted_range\": {\"start\": 100, \"end\": 150},\n    \"deleted_length\": 50,\n    \"position_shift\": -50,\n    \"new_document_length\": 4950\n}\n```\n\n### For Format-Only Operations\n```python\nresult = modify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    end_index=150,\n    bold=True\n)\n\n# Returns:\n{\n    \"success\": true,\n    \"operation\": \"format\",\n    \"formatted_range\": {\"start\": 100, \"end\": 150},\n    \"position_shift\": 0,  # No shift for formatting\n    \"styles_applied\": [\"bold\"]\n}\n```\n\n## Implementation Steps\n\n1. **Track operation type**:\n   - Determine if operation is insert, replace, delete, or format\n   - Calculate lengths and shifts accordingly\n\n2. **Get document length**:\n   - Before operation: store original length\n   - After operation: get new length from API response or re-query\n\n3. **Calculate position shift**:\n   - Insert: shift = len(inserted_text)\n   - Delete: shift = -(end_index - start_index)\n   - Replace: shift = len(new_text) - (end_index - start_index)\n   - Format: shift = 0\n\n4. **Update response schema**:\n   - Add new fields to response object\n   - Ensure backward compatibility (don't break existing integrations)\n\n5. **Document the response fields**:\n   - Update tool documentation/schema\n   - Add examples\n\n## Files to Modify\n- `modify_doc_text` implementation\n- Response building logic\n- Tool schema/documentation\n\n## Acceptance Criteria\n- [ ] Response includes `operation` type (insert/replace/delete/format)\n- [ ] Response includes `position_shift` value\n- [ ] Response includes `new_document_length`\n- [ ] Response includes `affected_range` or equivalent\n- [ ] Shift calculation is accurate for all operation types\n- [ ] Existing response fields preserved (backward compatible)\n- [ ] Unit tests verify correct shift calculations\n\n## Use Case Example\n```python\n# Make multiple edits efficiently without re-reading\ndoc_length = 5000\nedit_position = 100\n\n# First edit\nresult1 = modify_doc_text(doc_id, start_index=edit_position, text=\"AAA\")\n# result1.position_shift = 3\n\n# Second edit (adjust position)\nnext_position = 200 + result1[\"position_shift\"]  # 203\nresult2 = modify_doc_text(doc_id, start_index=next_position, text=\"BBB\")\n# No need to re-read document!\n```\n\n## Dependencies\n- None (can be implemented independently)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T13:31:16.184306-08:00","updated_at":"2025-12-04T14:04:26.466331-08:00","closed_at":"2025-12-04T14:04:26.466331-08:00","labels":["enhancement","google-docs","p1"]}
{"id":"google_workspace_mcp-66a1.5","content_hash":"513771eac129df248f2fca8c57128031ed21e3b4d8809e479574e833d59942ad","title":"Improve error messages with actionable guidance","description":"## Problem\nCurrent error messages are generic and don't explain what went wrong or how to fix it. This makes debugging difficult for both humans and AI agents.\n\n### Current Error Example\n```\nError: 'end_index' is required when applying formatting.\n```\n\nThis doesn't tell the user:\n- Why end_index is required\n- How to fix the issue\n- What the correct approach is\n\n## Proposed Solution\nImplement structured, actionable error messages that guide users to the correct solution.\n\n### Enhanced Error Format\n```json\n{\n    \"error\": true,\n    \"code\": \"FORMATTING_REQUIRES_RANGE\",\n    \"message\": \"'end_index' is required when applying formatting (bold, italic, etc.)\",\n    \"reason\": \"Formatting operations modify existing text and need to know which characters to format.\",\n    \"suggestion\": \"To format new text: 1) Insert text first, 2) Format it in a second call with the correct range.\",\n    \"example\": {\n        \"step1\": {\n            \"description\": \"Insert the text\",\n            \"call\": \"modify_doc_text(document_id='...', start_index=100, text='new text')\"\n        },\n        \"step2\": {\n            \"description\": \"Format the inserted text\",\n            \"call\": \"modify_doc_text(document_id='...', start_index=100, end_index=108, bold=True)\"\n        }\n    },\n    \"docs_url\": \"https://github.com/user/google_workspace_mcp#formatting\"\n}\n```\n\n## Error Scenarios to Improve\n\n### 1. Missing end_index for formatting\n```json\n{\n    \"code\": \"FORMATTING_REQUIRES_RANGE\",\n    \"message\": \"'end_index' is required when applying formatting\",\n    \"suggestion\": \"Provide both start_index and end_index to define the text range to format\",\n    \"received\": {\"start_index\": 100, \"bold\": true},\n    \"expected\": {\"start_index\": 100, \"end_index\": 150, \"bold\": true}\n}\n```\n\n### 2. Invalid index (out of bounds)\n```json\n{\n    \"code\": \"INDEX_OUT_OF_BOUNDS\",\n    \"message\": \"start_index 5000 is beyond document length 3500\",\n    \"suggestion\": \"Use get_doc_content to check document length before editing\",\n    \"document_length\": 3500,\n    \"requested_index\": 5000\n}\n```\n\n### 3. Invalid index range (start \u003e end)\n```json\n{\n    \"code\": \"INVALID_INDEX_RANGE\",\n    \"message\": \"start_index (200) must be less than end_index (100)\",\n    \"suggestion\": \"Swap start_index and end_index values\",\n    \"received\": {\"start_index\": 200, \"end_index\": 100}\n}\n```\n\n### 4. Document not found\n```json\n{\n    \"code\": \"DOCUMENT_NOT_FOUND\",\n    \"message\": \"Document with ID 'abc123' not found or not accessible\",\n    \"suggestion\": \"Verify the document ID and ensure you have access permissions\",\n    \"possible_causes\": [\n        \"Document ID is incorrect\",\n        \"Document was deleted\",\n        \"You don't have permission to access this document\"\n    ]\n}\n```\n\n### 5. Search text not found (for search-based positioning)\n```json\n{\n    \"code\": \"SEARCH_TEXT_NOT_FOUND\",\n    \"message\": \"Could not find 'The Velocity Trap' in the document\",\n    \"suggestion\": \"Check spelling and try a shorter, unique phrase\",\n    \"searched_for\": \"The Velocity Trap\",\n    \"similar_found\": [\"The Velocity Track\", \"Velocity Traps\"]\n}\n```\n\n### 6. Ambiguous search (multiple matches)\n```json\n{\n    \"code\": \"AMBIGUOUS_SEARCH\",\n    \"message\": \"Found 5 occurrences of 'TODO' - specify which one\",\n    \"suggestion\": \"Use 'occurrence' parameter (1=first, 2=second, -1=last) or use more specific search text\",\n    \"occurrences\": [\n        {\"index\": 1, \"position\": 150, \"context\": \"...text before TODO text after...\"},\n        {\"index\": 2, \"position\": 450, \"context\": \"...other TODO here...\"}\n    ]\n}\n```\n\n### 7. Permission denied\n```json\n{\n    \"code\": \"PERMISSION_DENIED\",\n    \"message\": \"You have view-only access to this document\",\n    \"suggestion\": \"Request edit access from the document owner\",\n    \"current_permission\": \"viewer\",\n    \"required_permission\": \"editor\"\n}\n```\n\n## Implementation Steps\n\n1. **Define error code enum/constants**:\n   - Create standardized error codes\n   - Document each error code\n\n2. **Create error response builder**:\n   - Helper function to build structured errors\n   - Include context-specific information\n\n3. **Update all error paths**:\n   - Replace generic error strings with structured errors\n   - Include relevant context in each error\n\n4. **Add validation layer**:\n   - Validate parameters before API calls\n   - Return helpful errors for invalid input\n\n5. **Include contextual information**:\n   - Document length when relevant\n   - Similar matches when search fails\n   - Current values vs expected values\n\n## Files to Modify\n- Error handling utilities (create if needed)\n- All tool implementations that return errors\n- Validation logic\n\n## Acceptance Criteria\n- [ ] All errors return structured JSON with code, message, suggestion\n- [ ] Error codes are documented\n- [ ] Index out of bounds shows document length\n- [ ] Search failures show similar matches when possible\n- [ ] Permission errors explain what's needed\n- [ ] Examples provided for common errors\n- [ ] Unit tests for error formatting\n\n## Benefits\n- Self-documenting API\n- AI agents can learn from errors and retry correctly\n- Faster debugging for developers\n- Better user experience","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-04T13:36:22.290041-08:00","updated_at":"2025-12-04T14:11:12.389586-08:00","closed_at":"2025-12-04T14:11:12.389586-08:00","labels":["dx","enhancement","google-docs","p1"]}
{"id":"google_workspace_mcp-66a1.6","content_hash":"ef3e085402955666e91407d8dbaa01070334fe65e5ebdd5650662bccecc282c7","title":"Add batch operations support for multiple edits","description":"## Problem\nCurrently, each edit requires a separate API call. For multiple changes, this is:\n- Slow (network round-trip per edit)\n- Error-prone (positions shift between calls)\n- Not atomic (partial failures leave document in inconsistent state)\n\n## Solution\nAdd a `batch_modify_doc` tool that accepts multiple operations and executes them atomically.\n\n## Proposed API\n\n### New Tool: `batch_modify_doc`\n```python\nbatch_modify_doc(\n    document_id=\"...\",\n    operations=[\n        {\n            \"type\": \"insert\",\n            \"start_index\": 100,\n            \"text\": \"New heading\\n\"\n        },\n        {\n            \"type\": \"format\",\n            \"start_index\": 100,\n            \"end_index\": 111,\n            \"bold\": True,\n            \"font_size\": 18\n        },\n        {\n            \"type\": \"insert\",\n            \"search\": \"Conclusion\",\n            \"position\": \"before\",\n            \"text\": \"\\n\\nNew section content here.\\n\"\n        },\n        {\n            \"type\": \"delete\",\n            \"start_index\": 500,\n            \"end_index\": 550\n        },\n        {\n            \"type\": \"replace\",\n            \"search\": \"old text\",\n            \"text\": \"new text\"\n        }\n    ]\n)\n```\n\n### Response Format\n```json\n{\n    \"success\": true,\n    \"operations_completed\": 5,\n    \"results\": [\n        {\n            \"index\": 0,\n            \"type\": \"insert\",\n            \"success\": true,\n            \"inserted_at\": 100,\n            \"position_shift\": 12\n        },\n        {\n            \"index\": 1,\n            \"type\": \"format\",\n            \"success\": true,\n            \"formatted_range\": {\"start\": 100, \"end\": 111}\n        }\n        // ... more results\n    ],\n    \"total_position_shift\": 42,\n    \"new_document_length\": 5042\n}\n```\n\n### Error Handling Options\n\n#### Option A: Atomic (all or nothing)\n```python\nbatch_modify_doc(\n    document_id=\"...\",\n    operations=[...],\n    atomic=True  # Default: if any fails, all fail\n)\n```\n\n#### Option B: Best effort (continue on error)\n```python\nbatch_modify_doc(\n    document_id=\"...\",\n    operations=[...],\n    on_error=\"continue\"  # or \"stop\" or \"rollback\"\n)\n```\n\n### Operation Types to Support\n1. **insert**: Insert text at position or search location\n2. **delete**: Delete range of text\n3. **replace**: Replace text (by range or search)\n4. **format**: Apply formatting to range\n\n### Position Handling\nOperations are processed in order, with automatic position adjustment:\n```python\n# These two operations work correctly:\noperations=[\n    {\"type\": \"insert\", \"start_index\": 100, \"text\": \"AAA\"},  # +3 shift\n    {\"type\": \"insert\", \"start_index\": 200, \"text\": \"BBB\"}   # Auto-adjusted to 203\n]\n```\n\n## Implementation Steps\n\n1. **Define operation schema**:\n   - Each operation type has required/optional fields\n   - Validate all operations before execution\n\n2. **Build Google Docs batchUpdate request**:\n   - Google Docs API supports batchUpdate natively\n   - Convert our operations to Google Docs request format\n\n3. **Handle position adjustments**:\n   - Track cumulative position shifts\n   - Adjust subsequent operation positions automatically\n   - OR process in reverse order (end-to-start) to avoid shifts\n\n4. **Implement atomic behavior**:\n   - Validate all operations first (dry-run style)\n   - Execute as single batchUpdate (inherently atomic in Google API)\n\n5. **Build detailed response**:\n   - Report status of each operation\n   - Include position shifts and ranges\n   - Aggregate total changes\n\n6. **Error handling**:\n   - If validation fails, return which operations are invalid\n   - If execution fails, report partial results (if non-atomic mode)\n\n## Files to Create/Modify\n- New tool definition: `batch_modify_doc`\n- Batch request builder utility\n- Position tracking/adjustment logic\n\n## Acceptance Criteria\n- [ ] `batch_modify_doc` accepts array of operations\n- [ ] Supports insert, delete, replace, format operation types\n- [ ] Operations executed atomically by default\n- [ ] Position auto-adjustment works correctly\n- [ ] Response includes per-operation results\n- [ ] Validation errors reported before execution\n- [ ] Integration with search-based positioning (if available)\n- [ ] Performance: single API call for multiple operations\n- [ ] Unit tests for batch building and position adjustment\n\n## Dependencies\n- Benefits from search-based positioning (google_workspace_mcp-66a1.1)\n- Benefits from better error messages (google_workspace_mcp-66a1.5)\n\n## Performance Benefits\n- 10 edits: ~1 API call instead of 10\n- Reduced latency\n- Atomic operations prevent partial failures","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T13:39:30.402657-08:00","updated_at":"2025-12-04T14:18:12.478795-08:00","closed_at":"2025-12-04T14:18:12.478795-08:00","labels":["enhancement","google-docs","p2","performance"]}
{"id":"google_workspace_mcp-66a1.7","content_hash":"1c01a9fd13599bebe1aa07b578bece9ef416e3f1df88179d2304316ed7ad2124","title":"Add range-based selection methods for semantic editing","description":"## Problem\nIt's difficult to select logical ranges like \"the next paragraph\" or \"everything under this heading\" without manually calculating exact character positions.\n\n## Solution\nAdd range-based selection methods that understand document semantics.\n\n## Proposed API Extensions\n\n### 1. Range by Search Terms\nSelect text between two search terms:\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    range={\n        \"start\": {\"search\": \"Introduction\"},\n        \"end\": {\"search\": \"Conclusion\"}\n    },\n    text=\"[ENTIRE RANGE REPLACED]\"\n)\n```\n\n### 2. Range by Section/Heading\nSelect entire section under a heading:\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    section=\"The Velocity Trap\",  # Select entire section\n    operation=\"replace\",\n    text=\"New section content here.\"\n)\n\n# Or append to section:\nmodify_doc_text(\n    document_id=\"...\",\n    section=\"The Velocity Trap\",\n    operation=\"append\",\n    text=\"\\n\\nAdditional paragraph here.\"\n)\n```\n\n### 3. Range by Element Type\nSelect by document element:\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    element={\n        \"type\": \"paragraph\",\n        \"after\": \"Introduction\",  # The paragraph after this text\n        \"index\": 1  # First paragraph (if multiple)\n    },\n    operation=\"replace\",\n    text=\"New paragraph content.\"\n)\n```\n\n### 4. Relative Ranges\nSelect relative to a position:\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    range={\n        \"search\": \"important keyword\",\n        \"extend\": \"paragraph\"  # Extend to full paragraph containing the search\n    },\n    bold=True\n)\n\n# Or with character offsets:\nmodify_doc_text(\n    document_id=\"...\",\n    range={\n        \"search\": \"keyword\",\n        \"before_chars\": 50,  # Include 50 chars before\n        \"after_chars\": 100   # Include 100 chars after\n    },\n    highlight=True\n)\n```\n\n## Range Object Schema\n```json\n{\n    \"range\": {\n        // Option 1: Search-based bounds\n        \"start\": {\"search\": \"start text\", \"occurrence\": 1},\n        \"end\": {\"search\": \"end text\", \"occurrence\": 1},\n        \n        // Option 2: Search with extension\n        \"search\": \"keyword\",\n        \"extend\": \"paragraph\",  // or \"sentence\", \"line\", \"section\"\n        \n        // Option 3: Search with offset\n        \"search\": \"keyword\",\n        \"before_chars\": 50,\n        \"after_chars\": 100,\n        \n        // Option 4: Section reference\n        \"section\": \"Heading Name\",\n        \"include_heading\": false\n    }\n}\n```\n\n## Implementation Steps\n\n1. **Design range resolution logic**:\n   - Define how each range type resolves to start/end indices\n   - Handle edge cases (not found, overlapping, etc.)\n\n2. **Implement search-based range**:\n   - Find start search term\n   - Find end search term\n   - Calculate range [start_pos, end_pos]\n\n3. **Implement section-based range**:\n   - Use structural navigation to find section bounds\n   - Section ends at next same-level heading or document end\n\n4. **Implement extension logic**:\n   - \"paragraph\": extend to paragraph boundaries\n   - \"sentence\": extend to sentence boundaries (period detection)\n   - \"line\": extend to line break boundaries\n   - \"section\": extend to section boundaries\n\n5. **Implement relative offset**:\n   - Add/subtract character counts from search position\n   - Clamp to document bounds\n\n6. **Update modify_doc_text**:\n   - Accept `range` parameter as alternative to start_index/end_index\n   - Parse range object and resolve to indices\n   - Execute operation on resolved range\n\n## Response with Range Info\n```json\n{\n    \"success\": true,\n    \"resolved_range\": {\n        \"start_index\": 150,\n        \"end_index\": 450,\n        \"matched_start\": \"Introduction\",\n        \"matched_end\": \"Conclusion\"\n    },\n    \"operation\": \"replace\",\n    \"position_shift\": -200\n}\n```\n\n## Files to Modify\n- Range resolution utilities (new)\n- `modify_doc_text` schema and implementation\n- Integrate with structural navigation\n\n## Acceptance Criteria\n- [ ] `range.start`/`range.end` with search terms works\n- [ ] `section` parameter selects heading section\n- [ ] `extend` parameter expands to paragraph/sentence/line\n- [ ] Relative character offsets work\n- [ ] Clear errors when range cannot be resolved\n- [ ] Response includes resolved range info\n- [ ] Works with formatting operations\n- [ ] Unit tests for all range types\n\n## Dependencies\n- Depends on structural navigation (google_workspace_mcp-66a1.3) for section support\n- Depends on search-based positioning (google_workspace_mcp-66a1.1) for search terms","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T13:43:13.998212-08:00","updated_at":"2025-12-04T14:26:05.188147-08:00","closed_at":"2025-12-04T14:26:05.188147-08:00","labels":["enhancement","google-docs","p2"]}
{"id":"google_workspace_mcp-66a1.8","content_hash":"7ff38a49c8f65a380492abc4329f47a880f93f03120c56f55b41da0044a4a541","title":"Wire up structured error system throughout docs_tools.py","description":"## Problem\nThe codebase has a sophisticated structured error system in `errors.py` with ErrorBuilder, DocsErrorBuilder, StructuredError, and ErrorCode enum, but it's not consistently used throughout `docs_tools.py` and related files. Many validation errors still return plain strings.\n\n## Goal\nPropagate StructuredError throughout all tool responses instead of returning string errors.\n\n## Acceptance Criteria\n- All validation errors in docs_tools.py return StructuredError JSON\n- Errors include context (received value, expected value, available options)\n- Errors include actionable suggestions\n- Search not found errors show available search results / which heading contains similar text\n- Heading not found errors list available headings\n\n## Files to Modify\n- gdocs/docs_tools.py - 17 tool definitions\n- gdocs/managers/validation_manager.py - already has some error builders\n\n## Estimated Effort\n2-4 hours - infrastructure exists, just needs wiring up","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-04T14:32:39.974853-08:00","updated_at":"2025-12-04T14:40:06.812586-08:00","closed_at":"2025-12-04T14:40:06.812586-08:00","labels":["enhancement","errors","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.8","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:41.183642-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66a1.9","content_hash":"50a49e55719e02f0f9b4126b14e0492f1319d3d15401c187603ed7da4a165590","title":"Expose position_shift consistently in all modify operation responses","description":"## Problem\nThe modify_doc_text tool returns position_shift in its OperationResult, but this isn't consistently exposed in all responses. Batch tools should also return per-operation positions.\n\n## Goal\nEnable efficient chaining of operations without re-reading the document by consistently exposing position shift information.\n\n## Current State\n- modify_doc_text returns: {\"operation\": \"insert\", \"position_shift\": 13, ...}\n- batch_modify_doc doesn't clearly expose per-operation shifts\n- Users can't easily calculate: next_operation_index = original_index + position_shift\n\n## Acceptance Criteria\n- All modify operations return position_shift in response\n- batch_modify_doc returns per-operation position_shift values\n- batch_update_doc returns cumulative position_shift\n- Documentation/examples show how to chain operations using position_shift\n\n## Files to Modify\n- gdocs/docs_tools.py (modify_doc_text section)\n- gdocs/managers/batch_operation_manager.py\n\n## Estimated Effort\n3-5 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-04T14:32:49.948149-08:00","updated_at":"2025-12-04T14:43:48.898589-08:00","closed_at":"2025-12-04T14:43:48.898589-08:00","labels":["api","enhancement","google-docs"],"dependencies":[{"issue_id":"google_workspace_mcp-66a1.9","depends_on_id":"google_workspace_mcp-66a1","type":"parent-child","created_at":"2025-12-04T14:34:49.076074-08:00","created_by":"mbradshaw"}]}
{"id":"google_workspace_mcp-66cf","content_hash":"7ebc9b0f8ad992bd25096f2fa7fe4143f18cab4c75ef99a811e3d7c2c976def8","title":"Missing tool to convert existing bullet list to numbered list (or vice versa)","description":"## Summary\nThere is no tool to convert an existing bullet (unordered) list to a numbered (ordered) list, or vice versa. Users would need to delete and recreate the list to change its type.\n\n## Current State\n- Can create new lists with insert_doc_elements (UNORDERED or ORDERED)\n- Can convert text to a list using modify_doc_text with convert_to_list parameter\n- Cannot change the type of an existing list\n\n## Expected Behavior\nShould be able to:\n1. Convert existing bullet list to numbered list\n2. Convert existing numbered list to bullet list\n\n## Workaround\nCurrently users must:\n1. Copy the list item text\n2. Delete the existing list\n3. Create a new list with the desired type\n\n## Use Cases\n- Switching list style during document editing\n- Reformatting imported content\n\n## Implementation Notes\nGoogle Docs API allows modifying list properties including the glyph type.\n\n## Files Likely Affected\n- gdocs/docs_tools.py (new function or enhancement to existing)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:37:55.90846-06:00","updated_at":"2025-12-06T19:48:26.679916-06:00","closed_at":"2025-12-06T19:48:26.679916-06:00"}
{"id":"google_workspace_mcp-684a","content_hash":"b2deb3a5debc956c9d025699d5e99d55187fb1d0a0c7659cdc3d96b571653eeb","title":"Parameter naming inconsistency: format_all_occurrences uses 'search' but preview_search_results uses 'search_text'","description":"## Issue\n\nThere's an inconsistency in parameter naming between similar search-based tools:\n\n- `format_all_occurrences` uses `search` parameter\n- `preview_search_results` uses `search_text` parameter\n\nThis inconsistency makes it harder for users to remember the correct parameter names.\n\n## Reproduction\n\n```bash\n# This works:\npython test_harness.py --tool preview_search_results --document_id \"\u003cid\u003e\" --search_text \"test\"\n\n# This fails:\npython test_harness.py --tool format_all_occurrences --document_id \"\u003cid\u003e\" --search_text \"test\" --bold true\n# Error: missing a required argument: 'search'\n\n# This works:\npython test_harness.py --tool format_all_occurrences --document_id \"\u003cid\u003e\" --search \"test\" --bold true\n```\n\n## Expected Behavior\n\nAll search-based tools should use the same parameter name, preferably `search` to match `modify_doc_text` and other tools.\n\n## Related\n\nThis is related to previously closed issue google_workspace_mcp-6afd which addressed a similar inconsistency with preview_search_results. However, preview_search_results still uses `search_text` while other tools use `search`.\n\n## Suggested Fix\n\nEither:\n1. Rename `search_text` to `search` in preview_search_results (breaking change)\n2. Accept both `search` and `search_text` as aliases in preview_search_results\n3. Document the difference prominently","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T21:48:30.589651-06:00","updated_at":"2025-12-06T22:04:25.210154-06:00","closed_at":"2025-12-06T22:04:25.210154-06:00","labels":["api-consistency","gdocs","parameter-naming"]}
{"id":"google_workspace_mcp-6913","content_hash":"94579699825f5a9f1b0d50b2f036e0adf79b594e9cbb57b3de6b9f55979941e8","title":"GDocs: Missing tool to append items to existing lists","description":"Currently, `insert_doc_elements` with `element_type='list'` creates a NEW list. There's no way to append items to an EXISTING list.\n\n## Current Behavior:\n- Creating a list: `insert_doc_elements(element_type='list', items=['a', 'b'])` - works\n- Appending to existing list: Not possible without manual index calculation\n\n## Feature Request:\nAdd a tool or option to append items to an existing list:\n\n```python\n# Option A: New tool\nappend_to_list(doc_id, list_index=0, items=['new item 1', 'new item 2'])\n\n# Option B: Enhance insert_doc_elements\ninsert_doc_elements(doc_id, element_type='list_item', \n                   after_search='existing list item', \n                   text='new item')\n```\n\n## Use Cases:\n- Building up lists incrementally\n- Adding items to existing bullet point sections\n- Extending numbered lists with additional steps","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:12:46.744825-06:00","updated_at":"2025-12-06T20:44:56.254471-06:00","closed_at":"2025-12-06T20:44:56.254471-06:00"}
{"id":"google_workspace_mcp-69fd","content_hash":"b77f987f1b43842e9fe605a0c726d201ed771ab428ca341c7a7681a82de796a7","title":"Add paragraph-level search positioning (extend='paragraph') to batch_edit_doc","description":"When using search-based positioning in batch_edit_doc, users may want to insert content after the entire paragraph containing the search text, not just immediately after the matched characters.\n\n## Current Behavior\n\nposition='after' inserts at the character position immediately after the found text:\n- Search 'Heading' in 'Heading\\nContent' ‚Üí inserts right after 'Heading' (on same line)\n\n## Requested Feature\n\nAdd extend='paragraph' option to search-based positioning that would:\n1. Find the search text\n2. Expand the match to include the full containing paragraph\n3. Use position='after' to insert after the paragraph (on a new line)\n\n## Example Usage\n\noperations = [\n    {\n        'type': 'insert',\n        'search': 'The Bandwidth Gap',\n        'position': 'after',\n        'extend': 'paragraph',  # NEW: Expand to paragraph bounds\n        'text': '\\n\\nNew section content here.'\n    }\n]\n\n## Workaround\n\nUsers can currently:\n1. Include newline prefix in text: text='\\n\\nNew content'\n2. Use range_spec with extend='paragraph' to get paragraph bounds\n\n## Related\n\n- This was requested in google_workspace_mcp-5e76 (closed as by-design since current 'after' behavior is intentional character-level positioning)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T17:22:33.205676-06:00","updated_at":"2025-12-06T20:21:03.994255-06:00","closed_at":"2025-12-06T20:21:03.994255-06:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-6a52","content_hash":"f77db09dfd4a9fa51e4d6bb524d71da3e6f560b478de8a71090b337cd3154c7c","title":"modify_doc_text does not interpret newline escape sequences","description":"When passing text with escape sequences like \\n to modify_doc_text, the literal characters \\n are inserted rather than actual newlines. This makes it difficult to add multi-paragraph content.\n\n## Steps to Reproduce:\n1. Call modify_doc_text with text='Hello\\n\\nWorld'\n2. Observe document contains literal '\\n\\n' instead of newlines\n\n## Expected Behavior:\nEscape sequences like \\n should be converted to actual newline characters\n\n## Actual Behavior:\nLiteral '\\n' is inserted as text\n\n## Impact:\nUsers cannot easily insert multi-paragraph text in a single operation. This is a significant usability issue.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:26:07.594055-06:00","updated_at":"2025-12-06T15:31:56.860438-06:00","closed_at":"2025-12-06T15:31:56.860438-06:00","labels":["bug","gdocs"]}
{"id":"google_workspace_mcp-6afd","content_hash":"4f02618e3df346fb795d1ec7fa0e151becd991000f6e556706748b8303055325","title":"Parameter naming inconsistency: preview_search_results uses 'search_text' while other tools use 'search'","description":"While testing the gdocs tools, I discovered a parameter naming inconsistency:\n\n- `preview_search_results` requires `search_text` parameter\n- `modify_doc_text` uses `search` parameter\n- `find_and_replace_doc` has aliases for both (`find_text` and `search`)\n- `format_all_occurrences` uses `search` parameter\n\nThis inconsistency causes confusion when users try to use preview_search_results with the same parameter name they use elsewhere.\n\n**Reproduction:**\n```bash\n# This fails with 'missing a required argument: search_text'\npython test_harness.py --tool preview_search_results --document_id \"...\" --search \"The Problem\"\n\n# This works\npython test_harness.py --tool preview_search_results --document_id \"...\" --search_text \"The Problem\"\n```\n\n**Suggestion:**\nEither:\n1. Add `search` as an alias to `preview_search_results` (like find_and_replace_doc does)\n2. Or rename `search_text` to `search` for consistency","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:54:20.654896-06:00","updated_at":"2025-12-06T17:03:19.412077-06:00","closed_at":"2025-12-06T17:03:19.412077-06:00","labels":["api","gdocs","usability"]}
{"id":"google_workspace_mcp-6c5f","content_hash":"8119105d2dd758a6d7d7957a0a0892153d25cfc28db4e2f1614da6e437816df4","title":"Invalid document ID produces raw API 404 error","description":"When an invalid document_id is provided to modify_doc_text (and likely other functions), the function throws a raw Google API HttpError 404 instead of returning a structured error response.\n\n**Steps to Reproduce:**\n1. Call modify_doc_text with document_id='INVALID_DOC_ID_12345'\n2. Observe raw API error: HttpError 404 'Requested entity was not found.'\n\n**Expected Behavior:**\nReturn a structured error response like:\n```json\n{\n  \"error\": true,\n  \"code\": \"DOCUMENT_NOT_FOUND\",\n  \"message\": \"Document 'INVALID_DOC_ID_12345' was not found\",\n  \"reason\": \"The document ID may be incorrect or you may not have access to this document.\",\n  \"suggestion\": \"Verify the document ID is correct. You can find the ID in the document's URL: docs.google.com/document/d/{document_id}/edit\"\n}\n```\n\n**Actual Behavior:**\nRaw HttpError exception propagates to caller.\n\n**Location:** gdocs/docs_tools.py - likely in multiple functions\n\n**Impact:** Poor error handling - users get confusing technical errors instead of actionable guidance. This should be caught early during document validation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T14:46:25.705553-06:00","updated_at":"2025-12-06T14:55:42.341814-06:00","closed_at":"2025-12-06T14:55:42.341814-06:00"}
{"id":"google_workspace_mcp-6ce4","content_hash":"cfcd04b4c232b5060bcf3c48bd9d1e43da8cc7ec2fedbed6126a9f23aa9a4f4c","title":"Add insert_table_of_contents tool","description":"No way to insert a table of contents (TOC) in Google Docs. A TOC should be automatically generated from headings in the document. Note: Google Docs API has limited TOC support - may need to implement this by finding all headings and creating a formatted list with internal links to bookmarks.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:34:11.872364-06:00","updated_at":"2025-12-06T18:10:09.006637-06:00","closed_at":"2025-12-06T18:10:09.006637-06:00","labels":["feature-request","gdocs"],"comments":[{"id":9,"issue_id":"google_workspace_mcp-6ce4","author":"mbradshaw","text":"## Investigation Summary\n\nAfter researching the Google Docs API, implementing a Table of Contents (TOC) tool is **not feasible** due to fundamental API limitations.\n\n### Key Findings\n\n1. **No `insertTableOfContents` API request**: The Google Docs API does not support programmatically inserting a native TOC. The available batchUpdate request types do not include any TOC-related operations.\n   - Reference: https://developers.google.com/workspace/docs/api/reference/rest/v1/documents/request\n\n2. **`headingId` is read-only**: While the API supports creating internal links to headings via `HeadingLink`, this requires a `headingId`. However:\n   - `headingId` values are only generated when headings are created **manually in the Google Docs UI**\n   - Headings created via the API (using `insertText` + `updateParagraphStyle`) do NOT get `headingId` values\n   - This is a known limitation: https://stackoverflow.com/questions/57911530/is-there-a-way-to-add-headingid-to-paragraphs-using-google-docs-api\n\n3. **No workarounds exist**: The official Google issue tracker has open feature requests for this functionality that have been pending for years.\n\n### What Could Be Partially Implemented (But Not Useful)\n\nA \"synthetic\" TOC could theoretically be created for documents where:\n- All headings were created manually in the Google Docs UI (not via API)\n- The headings already have `headingId` values\n\nThis would involve:\n1. Reading all headings with their `headingId` values\n2. Creating a formatted list with internal links using `HeadingLink`\n\nHowever, this is impractical because:\n- Most MCP users will be creating documents or modifying content programmatically\n- API-created headings won't have `headingId` values\n- Users would need to manually refresh the TOC anyway (no auto-update via API)\n\n### Recommendation\n\nClose as \"won't fix\" - this is a Google Docs API limitation, not something we can work around. Users who need TOC functionality should:\n1. Create the TOC manually in the Google Docs UI\n2. Use Google Apps Script (which has better TOC support via the DocumentApp service)","created_at":"2025-12-07T00:10:03Z"}]}
{"id":"google_workspace_mcp-6d97","content_hash":"214b77bdc17edfca34a5e846f40e4c8ed054d129668724814212f30e59607a05","title":"convert_to_list accepts only ORDERED/UNORDERED but users expect bullet/numbered","description":"The convert_to_list parameter in modify_doc_text only accepts 'ORDERED' and 'UNORDERED' values, but users intuitively try 'bullet' and 'numbered'.\n\n**Steps to Reproduce:**\n1. Call modify_doc_text with convert_to_list='bullet' or convert_to_list='numbered'\n2. Observe error: Invalid 'convert_to_list' value 'bullet' - Use one of: ORDERED, UNORDERED\n\n**Expected Behavior:**\nAccept common aliases:\n- 'bullet', 'bullets', 'unordered', 'UNORDERED' -\u003e unordered list\n- 'numbered', 'numbers', 'ordered', 'ORDERED' -\u003e ordered list\n\n**Actual Behavior:**\nOnly accepts uppercase 'ORDERED' and 'UNORDERED' exactly.\n\n**Suggested Fix:**\nNormalize input in validation:\n```python\nlist_type_aliases = {\n    'bullet': 'UNORDERED', 'bullets': 'UNORDERED', 'unordered': 'UNORDERED',\n    'numbered': 'ORDERED', 'numbers': 'ORDERED', 'ordered': 'ORDERED'\n}\nconvert_to_list = list_type_aliases.get(convert_to_list.lower(), convert_to_list.upper())\n```\n\n**Location:** gdocs/docs_tools.py, modify_doc_text function, convert_to_list parameter validation\n\n**Impact:** Minor usability issue - error message provides correct values but initial attempt fails.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:46:48.440203-06:00","updated_at":"2025-12-06T17:30:07.104653-06:00","closed_at":"2025-12-06T17:30:07.104653-06:00"}
{"id":"google_workspace_mcp-6de3","content_hash":"71f28d7743eca528f8b3413e5c140d39a88e4a2da59489422678a086104c8b73","title":"modify_table update_cell inserts text instead of replacing cell content","description":"When using modify_table with update_cell action, the text is inserted instead of replacing the cell content. \n\n## Steps to reproduce:\n1. Create a table with cell content 'Testing' at row 3, column 1\n2. Call modify_table with operation: {\"action\": \"update_cell\", \"row\": 3, \"column\": 1, \"text\": \"Complete\"}\n3. Observe the cell content\n\n## Expected behavior:\nCell content should be 'Complete'\n\n## Actual behavior:\nCell content becomes 'eTesting' (the 'e' from 'Complete' was inserted, but the original content wasn't cleared)\n\n## Root cause suspicion:\nThe update_cell implementation appears to insert text at the beginning of the cell without first deleting the existing content. The expected behavior is to replace the entire cell content.\n\n## File: gdocs/docs_tools.py\nFunction: modify_table (around line 3969)","status":"closed","priority":2,"issue_type":"task","assignee":"mbradshaw","created_at":"2025-12-06T15:41:38.6239-06:00","updated_at":"2025-12-06T15:43:56.365492-06:00","closed_at":"2025-12-06T15:43:56.365492-06:00","comments":[{"id":4,"issue_id":"google_workspace_mcp-6de3","author":"mbradshaw","text":"Fixed by removing incorrect 'reversed()' call in the update_cell code path. The bug was that requests were being executed in reverse order (insert first, then delete) which caused text to be inserted before the deletion, resulting in partial content. The fix ensures delete executes first to clear existing content, then insert adds the new text. All 497 tests pass.","created_at":"2025-12-06T21:44:08Z"}]}
{"id":"google_workspace_mcp-6e54","content_hash":"a97fd9cc902508e6e59bd4b5828c1bf49a2a7730129774da36a2fad34fccd605","title":"Add line spacing support to modify_doc_text","description":"Add support for line spacing via updateParagraphStyle API request with lineSpacing field. Options: single (100), 1.5 (150), double (200), or custom values.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:41:10.048624-08:00","updated_at":"2025-12-05T04:47:57.046988-08:00","closed_at":"2025-12-05T04:47:57.046988-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-6edd","content_hash":"9c238c09a6018a87ece456992b42750321f71c4153cd0f6da5f493491c78f603","title":"get_text_formatting shows SUPERSCRIPT baseline_offset on normal text","description":"When retrieving text formatting using get_text_formatting, the response shows baseline_offset: 'SUPERSCRIPT' for text that should have normal baseline.\n\n## Steps to Reproduce\n1. Insert text using modify_doc_text or batch_edit_doc\n2. Call get_text_formatting on the inserted range\n3. Observe the baseline_offset field\n\n## Expected Behavior\nNormal text should show baseline_offset: 'NONE' or no baseline_offset property.\n\n## Actual Behavior\nThe formatting shows baseline_offset: 'SUPERSCRIPT' for normal text that was not marked as superscript.\n\n## Example Response\n```json\n{\n  \"formatting\": [\n    {\n      \"text\": \"BOLD TEXT\\n\",\n      \"bold\": false,\n      \"baseline_offset\": \"SUPERSCRIPT\"  // Should be NONE\n    }\n  ]\n}\n```\n\nThis appears to be affecting all text returned by get_text_formatting in the test document. This may be a bug in how baseline_offset is being read from the document or there may be document-wide formatting inherited from previous operations.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T18:56:51.758139-06:00","updated_at":"2025-12-06T19:16:06.284486-06:00","closed_at":"2025-12-06T19:16:06.284486-06:00","labels":["formatting","gdocs","get_text_formatting"]}
{"id":"google_workspace_mcp-700b","content_hash":"d44763fca79114c684533593f75312c1ba285376ad13c1c94d87155709abd63d","title":"GDocs: update_doc_headers_footers requires 2 API calls to set both header and footer","description":"Currently, to set both a document header AND footer, users must make two separate API calls:\n\n```python\n# Set header\nupdate_doc_headers_footers(doc_id, section_type='header', content='Header text')\n\n# Set footer  \nupdate_doc_headers_footers(doc_id, section_type='footer', content='Footer text')\n```\n\n## Feature Request:\nAllow setting both header and footer in a single call:\n\n```python\n# Option A: Allow multiple section_types\nupdate_doc_headers_footers(doc_id, header_content='Header', footer_content='Footer')\n\n# Option B: Accept a dict/list of sections\nupdate_doc_headers_footers(doc_id, sections=[\n    {'type': 'header', 'content': 'Header'},\n    {'type': 'footer', 'content': 'Footer'}\n])\n```\n\n## Benefits:\n- Fewer API calls\n- More intuitive for common use case\n- Atomic update (both succeed or both fail)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:09:49.286895-06:00","updated_at":"2025-12-06T20:04:20.013014-06:00","closed_at":"2025-12-06T20:04:20.013014-06:00"}
{"id":"google_workspace_mcp-70a4","content_hash":"9dd42832a09df34b6f44247d16db6f7437bb1d72ca1c2d9938cad365dfb96dd5","title":"GDocs: Missing delete_doc_section functionality","description":"There's a `get_doc_section` tool to retrieve section content by heading, but no corresponding tool to DELETE a section.\n\n## Current Workaround:\nUsers must:\n1. Use `get_doc_section` to find the section's start and end indices\n2. Manually call `modify_doc_text` with `start_index` and `end_index` and empty text\n\n## Feature Request:\nAdd a `delete_doc_section` tool that removes an entire section (heading + content):\n\n```python\ndelete_doc_section(doc_id, heading='Section to Delete', include_heading=True)\n```\n\n## Parameters:\n- `heading`: The heading text to identify the section\n- `include_heading`: Whether to delete the heading itself (default True)\n- `preview`: Show what would be deleted without actually deleting\n\n## Use Cases:\n- Removing outdated sections from documents\n- Reorganizing document structure\n- Cleaning up draft sections","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T16:11:38.842605-06:00","updated_at":"2025-12-06T16:23:16.528599-06:00","closed_at":"2025-12-06T16:23:16.528599-06:00"}
{"id":"google_workspace_mcp-7867","content_hash":"e95d5e0de0f58210ac4ace6aab936e91de40e470f22462e7ab2669268c76b079","title":"Add heading/paragraph style support to modify_doc_text","description":"Add support for changing paragraph to heading styles (HEADING_1 through HEADING_6, NORMAL_TEXT, TITLE, SUBTITLE) via updateParagraphStyle API request with namedStyleType field.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:41:05.132815-08:00","updated_at":"2025-12-05T04:47:57.025196-08:00","closed_at":"2025-12-05T04:47:57.025196-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-7997","content_hash":"5eff33473ef8315a26f022a0d8bea17daa1a40413efa10f86f6f8299e1e3c4f9","title":"get_doc_section returns empty content even when section has content","description":"## Summary\nWhen calling get_doc_section to retrieve a section by heading, the 'content' field in the response is empty even when there is actual content underneath the heading.\n\n## Steps to Reproduce\n1. Create a heading with content underneath it\n2. Call get_doc_section with that heading text\n3. Observe the response\n\n## Expected Behavior\nThe 'content' field should contain the text content of the section (everything from after the heading to the next same-level or higher-level heading).\n\n## Actual Behavior\nResponse shows:\n{\n  \"heading\": \"DELETE TEST SECTION\",\n  \"level\": 2,\n  \"start_index\": 164666,\n  \"end_index\": 164686,\n  \"content\": \"\",   // \u003c-- Empty even though content exists!\n  \"subsections\": []\n}\n\nNote: end_index - start_index = 20 (only the heading text), not including the content below.\n\n## Impact\n- Users cannot reliably retrieve section content\n- This may be related to the delete_doc_section bug (both use similar section boundary logic)\n\n## Files Likely Affected\n- gdocs/docs_tools.py (get_doc_section function)\n- gdocs/docs_structure.py (section boundary detection)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:37:36.291456-06:00","updated_at":"2025-12-06T17:20:15.644842-06:00","closed_at":"2025-12-06T17:20:15.644842-06:00"}
{"id":"google_workspace_mcp-79a0","content_hash":"4ec759147c3ce30ec1f035c40d4735a2212bb573e9c3a286fa0a9af87f805cb6","title":"Inconsistent parameter naming across tools (search vs search_text)","description":"Different gdocs tools use inconsistent parameter names for the same concept - searching for text in a document:\n\n**Examples of inconsistency:**\n- modify_doc_text: uses `search` parameter  \n- format_all_occurrences: uses `search` parameter\n- preview_search_results: uses `search_text` parameter\n- create_table_with_data: uses `after_heading` (not search-based)\n- insert_doc_image: uses `after_heading` (not search-based)\n\n**Impact:**\nUsers trying different tools have to remember different parameter names for the same concept. This leads to:\n1. Errors like 'missing required argument: search' when user provides 'search_text'\n2. Frustration and reduced developer experience\n3. Inconsistent documentation\n\n**Suggested Fix:**\nStandardize on a single parameter name. Options:\n1. `search` - shortest and most common\n2. `search_text` - more explicit\n3. Support both as aliases (with deprecation warning for the deprecated one)\n\nAlso consider adding `search` as an alternative to `after_heading` for table/image insertion for consistency.\n\n**Location:** Multiple functions in gdocs/docs_tools.py","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:46:38.332681-06:00","updated_at":"2025-12-06T17:22:46.854766-06:00","closed_at":"2025-12-06T17:22:46.854766-06:00"}
{"id":"google_workspace_mcp-7a41","content_hash":"1d10398b848bc8f495b64067f05f19b06bb006d8b49d8b30bcffc3c80b14e60e","title":"Missing paragraph formatting options in modify_doc_text","description":"Several useful paragraph formatting options are not available in the modify_doc_text tool.\n\n## Missing Parameters:\n1. **indent_first_line** - First line indentation (for paragraph formatting)\n2. **indent_start** / **indent_end** - Left/right margins for paragraphs\n3. **space_before** / **space_after** - Spacing before/after paragraphs\n4. **after_heading** - Insert text after a specific heading (documented in other tools but not modify_doc_text)\n\n## Steps to Reproduce:\n```python\n# All of these fail with 'got an unexpected keyword argument'\nmodify_doc_text(location='end', text='Test', indent_first_line=36)\nmodify_doc_text(location='end', text='Test', indent_start=72)\nmodify_doc_text(location='end', text='Test', space_before=20, space_after=20)\nmodify_doc_text(after_heading='Section', text='After heading content')\n```\n\n## Expected Behavior:\nThese parameters should work like they do in the Google Docs API.\n\n## Impact:\nUsers cannot properly format paragraph indentation or spacing, which are common requirements for document formatting.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:34:02.621008-06:00","updated_at":"2025-12-06T18:06:45.951774-06:00","closed_at":"2025-12-06T18:06:45.951774-06:00","labels":["feature-request","gdocs","modify_doc_text","paragraph-formatting"]}
{"id":"google_workspace_mcp-7d78","content_hash":"d474943e6cdf9e3f5fd017104a198222d9e1550e0f3b829450cdf092960941fe","title":"insert_doc_image fails with default width/height values","description":"When calling insert_doc_image without specifying width or height, the function defaults these to 0. However, the helper function create_insert_image_request checks 'if width is not None' which is True for 0, causing it to send width=0 to the API. The Google Docs API rejects this with: 'Invalid object size: width must be greater than 0 if specified.' The fix should change the default values from 0 to None in docs_tools.py:2466-2467, or change the condition in the helper to 'if width' to exclude falsy values.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T14:33:37.803276-06:00","updated_at":"2025-12-06T14:43:20.614021-06:00","closed_at":"2025-12-06T14:43:20.614021-06:00","labels":["api-bug","gdocs"]}
{"id":"google_workspace_mcp-8230","content_hash":"1017e3893fbe864d3f4dec99a45adf1b6e90b54700dd1a3bf927efbf2d36d0b9","title":"code_block formatting in modify_doc_text inherits surrounding text styles","description":"When using modify_doc_text with code_block=True, the inserted text inherits formatting from surrounding text (italic, subscript, foreground_color) instead of having only the code_block formatting applied.\n\n**Steps to reproduce:**\n1. Use modify_doc_text with: location='end', text='def foo(): pass', code_block=True\n2. Check formatting with get_text_formatting\n\n**Expected behavior:**\n- Code block text should have:\n  - font_family='Courier New' (code_block default)\n  - background_color='#f5f5f5' (code_block default)\n  - All other formatting reset to defaults (bold=false, italic=false, baseline_offset=NONE, foreground_color=default)\n\n**Actual behavior:**\n- Code block text has:\n  - font_family='Courier New' ‚úì\n  - background_color='#F4F4F4' ‚úì\n  - italic=true (inherited) ‚úó\n  - baseline_offset=SUBSCRIPT (inherited) ‚úó\n  - foreground_color=#FF0000 (inherited) ‚úó\n\n**Test document:** https://docs.google.com/document/d/1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc/edit\n**Affected text:** Code block at index 202884\n\n**Related bugs:** \n- google_workspace_mcp-332b (batch_edit_doc formatting inheritance)\n- google_workspace_mcp-446c (find_and_replace_doc formatting inheritance)\n\n**Root cause:** Same as related bugs - formatting is applied as deltas instead of absolute values.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T19:35:01.035051-06:00","updated_at":"2025-12-06T19:39:49.344872-06:00","closed_at":"2025-12-06T19:39:49.344872-06:00"}
{"id":"google_workspace_mcp-8299","content_hash":"3d0f3ed4aca6d5f94f5d9d318a85465e6c83adae8f7d3723fb963c362aa1ef35","title":"insert_doc_elements missing horizontal_rule support","description":"## Summary\nThe insert_doc_elements tool supports table, list, and page_break element types, but does not support horizontal_rule (horizontal line). Google Docs API supports inserting horizontal lines and users may expect this functionality.\n\n## Current Behavior\nWhen calling insert_doc_elements with element_type='horizontal_rule', returns error:\n\"Invalid 'element_type' value 'horizontal_rule'. Use one of: table, list, page_break\"\n\n## Expected Behavior\nShould support horizontal_rule as an element type to insert horizontal lines into documents.\n\n## Use Cases\n- Visual separation between document sections\n- Breaking up long documents\n- Formatting documents for printing\n\n## Implementation Notes\nGoogle Docs API supports this via createHorizontalRule in batch update requests.\n\n## Files Likely Affected\n- gdocs/docs_tools.py (insert_doc_elements function)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T16:37:25.665095-06:00","updated_at":"2025-12-06T17:27:31.630427-06:00","closed_at":"2025-12-06T17:27:31.630427-06:00"}
{"id":"google_workspace_mcp-8554","content_hash":"5dc8bab2c2c64a70693081e700e255390596e4be89450328c615fe5ec781b057","title":"Add insert_footnote and insert_endnote tools","description":"No way to insert footnotes or endnotes in Google Docs. These are essential for academic and professional documents. Implementation would use Google Docs API's insertFootnote request for footnotes. Endnotes may need to be simulated as Google Docs doesn't have native endnote support.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:34:00.838378-06:00","updated_at":"2025-12-06T18:15:43.80449-06:00","closed_at":"2025-12-06T18:15:43.80449-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-857a","content_hash":"5e0bec3ad73040e20c7e4177f87c8ac89e3fdc00580f9ccf2731355beeee9b3b","title":"get_doc_content uses Drive API while other tools use Docs API","description":"## Summary\nThe `get_doc_content` tool uses the Drive API to retrieve file metadata first, while most other gdocs tools (like `get_doc_info`, `modify_doc_text`, `insert_doc_elements`) use the Docs API directly. This creates permission inconsistency where some operations succeed while others fail on the same document.\n\n## Steps to Reproduce\n1. Access a document that the user has access to via Docs API but not Drive API\n2. Call `get_doc_info` - SUCCESS\n3. Call `modify_doc_text` - SUCCESS  \n4. Call `get_doc_content` - FAILS with 404 \"File not found\"\n\n## Example Error\n```python\n# This works:\nresult = await call(\"get_doc_info\")  \n# Returns: Document info for 1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc\n\n# This fails:\nresult = await call(\"get_doc_content\")  \n# Returns: {\n#   \"error\": true,\n#   \"code\": \"DOCUMENT_NOT_FOUND\",\n#   \"message\": \"Document '1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc' was not found\"\n# }\n```\n\n## Root Cause\nIn `get_doc_content` (gdocs/docs_tools.py line 130):\n```python\nfile_metadata = await asyncio.to_thread(\n    drive_service.files().get(\n        fileId=document_id, fields=\"id, name, mimeType, webViewLink\"\n    ).execute\n)\n```\n\nThis uses Drive API first, which may not have the same permissions as Docs API.\n\n## Impact\n- User confusion: document appears accessible for some operations but not others\n- Inconsistent UX across gdocs tools\n- The error message says \"document not found\" but document clearly exists (other operations work)\n\n## Suggested Fix\n1. Use Docs API to get document metadata when possible\n2. Only fall back to Drive API for non-Google-Docs files (.docx, etc.)\n3. Or: Provide clearer error message distinguishing between \"not found\" vs \"permission denied on Drive API\"\n\n## Location\nFile: `gdocs/docs_tools.py`, function `get_doc_content`, lines 127-138","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:23:00.09004-06:00","updated_at":"2025-12-06T15:26:16.603334-06:00","closed_at":"2025-12-06T15:26:16.603334-06:00"}
{"id":"google_workspace_mcp-85f2","content_hash":"fe1e300e2fadcf5562ac0ae68616098379a72db0c130192d8b1a323663fb5f2e","title":"gdocs: update_doc_headers_footers cannot create headers that don't exist","description":"","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T15:05:23.624175-06:00","updated_at":"2025-12-06T15:15:06.541789-06:00","closed_at":"2025-12-06T15:15:06.541789-06:00"}
{"id":"google_workspace_mcp-85fb","content_hash":"b2048c7c0aa8b99c1324bfbff5a21979372bba0477589c74d941341d598e8e41","title":"insert_doc_elements does not support horizontal_rule element type","description":"## Feature Request\n\nThe `insert_doc_elements` tool currently only supports these element types:\n- table\n- list  \n- page_break\n\n## Missing Functionality\nThere is no way to insert a horizontal rule (divider line) into a Google Doc. The Google Docs API does support horizontal rules via `insertSectionBreak` or by inserting a paragraph with a horizontal rule.\n\n## User Impact\nUsers who want to visually separate sections of a document cannot insert horizontal lines programmatically.\n\n## Suggested Implementation\nAdd support for `horizontal_rule` or `divider` as a valid `element_type` in the `insert_doc_elements` function.\n\n## API Reference\nGoogle Docs API supports horizontal rules - see: https://developers.google.com/docs/api/reference/rest/v1/documents#horizontalrule\n\n## Priority\nLow - this is a nice-to-have feature, not a blocking issue.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:24:45.13793-06:00","updated_at":"2025-12-06T17:22:43.558135-06:00","closed_at":"2025-12-06T17:22:43.558135-06:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-88e9","content_hash":"3d43ba40f1ae99e2b543ba981fa24548763044d771da4164bc73bf48882d200e","title":"Add table cell formatting support (colors, borders)","description":"The modify_table tool can modify table structure (add/delete rows/columns) and update cell content, but cannot format individual cells. Users need the ability to:\n- Set cell background colors\n- Set cell border styles and colors\n- Align cell content (left, center, right, top, middle, bottom)\n- Set cell padding\n\nThis would use Google Docs API's updateTableCellStyle request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:33:49.5959-06:00","updated_at":"2025-12-06T18:41:11.902915-06:00","closed_at":"2025-12-06T18:41:11.902915-06:00","labels":["feature-request","gdocs","table"]}
{"id":"google_workspace_mcp-8937","content_hash":"aa4909c29ea5a3530427ab6d5d2204ce411f3db7b40d022bc19aee1571a5bb7a","title":"get_doc_section returns empty content for actual section","description":"The get_doc_section tool returns empty content even when the section contains text.\n\n## Steps to Reproduce:\n1. Create a document with a heading 'Heading 1 Style' followed by some content\n2. Call get_doc_section(heading='Heading 1 Style')\n3. Observe result\n\n## Actual Behavior:\n```json\n{\n  \"heading\": \"Heading 1 Style\",\n  \"level\": 2,\n  \"start_index\": 249,\n  \"end_index\": 265,\n  \"content\": \"\",\n  \"subsections\": []\n}\n```\n\nNote: content is empty string.\n\n## Expected Behavior:\nThe content field should contain all text between this heading and the next heading of equal or higher level.\n\n## Additional Issue:\nThe heading is reported as level 2, but 'Heading 1 Style' was created with heading_style='HEADING_1' which should be level 1.\n\n## Impact:\nUsers cannot extract section content from documents, which is critical for document analysis and manipulation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:31:34.902963-06:00","updated_at":"2025-12-06T16:27:09.717266-06:00","closed_at":"2025-12-06T16:27:09.717266-06:00","labels":["bug","document-structure","gdocs","section-navigation"]}
{"id":"google_workspace_mcp-8d4f","content_hash":"3d0d3bd3b8b965d5cd8decd1e8334e9ecedf49fc830b2ecd61ccbec669bb2f1e","title":"Add resize_table_columns tool to adjust column widths","description":"No way to resize table column widths. Users often need to adjust column widths to fit content or create specific layouts. Implementation would use Google Docs API's updateTableColumnProperties request.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T14:34:32.344339-06:00","updated_at":"2025-12-06T19:54:43.454797-06:00","closed_at":"2025-12-06T19:54:43.454797-06:00","labels":["feature-request","gdocs","table"]}
{"id":"google_workspace_mcp-8d96","content_hash":"89d2931594e051ea35dcf304e73b067b0bb7b174d50424deed4e3e9eb23049ec","title":"insert_doc_elements with list type creates separate lists instead of appending to existing list","description":"When calling insert_doc_elements multiple times with element_type='list', each call creates a new separate list instead of appending items to an existing list.\n\n## Steps to Reproduce:\n```python\n# First item\ninsert_doc_elements(element_type='list', location='end', list_type='ORDERED', text='First list item')\n# Second item\ninsert_doc_elements(element_type='list', location='end', list_type='ORDERED', text='Second list item')\n```\n\n## Expected Behavior:\nBoth items should be part of the same numbered list:\n1. First list item\n2. Second list item\n\n## Actual Behavior:\nTwo separate lists are created, each starting at 1:\n1. First list item\n\n1. Second list item\n\n## Desired Enhancement:\nAdd a parameter like 'continue_list=True' or 'list_id' to allow appending to an existing list. Alternatively, allow multiple items to be passed in a single call:\n```python\ninsert_doc_elements(element_type='list', location='end', list_type='ORDERED', \n                   items=['First item', 'Second item', 'Third item'])\n```\n\n## Impact:\nCannot create proper multi-item lists programmatically without them being split into separate lists.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:36:08.42449-06:00","updated_at":"2025-12-06T16:03:12.012619-06:00","closed_at":"2025-12-06T16:03:12.012619-06:00","labels":["bug","gdocs","insert_doc_elements","lists"]}
{"id":"google_workspace_mcp-8e86","content_hash":"f8c8eb79ad8a0db2926281189a26e22fafd90d3de86ef09654fcd4f979a3947c","title":"Add get_doc_statistics tool for word count and document metrics","description":"No way to get document statistics like word count, character count, page count, paragraph count, etc. This is useful for documents with length requirements or for tracking writing progress. Note: Google Docs API doesn't directly provide these - implementation would need to parse document content and calculate manually.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T14:34:27.966845-06:00","updated_at":"2025-12-06T19:20:35.361352-06:00","closed_at":"2025-12-06T19:20:35.361352-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-91e7","content_hash":"a77cc14c2be7488e91b0fdfaa727e7e0baa6d8651f8553cb09c51399bca51aee","title":"batch_modify_doc allows invalid operation types to pass validation","description":"Invalid operation types like \"completely_fake_op\" pass validation and only fail at API level. Should be caught during validation.\n\nRepro:\nbatch_modify_doc(operations=[{\"type\":\"fake_op\",\"text\":\"bad\"}])\n\nExpected: Validation error before API call\nActual: API error \"Must specify at least one request\"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T05:03:43.992018-08:00","updated_at":"2025-12-05T06:46:36.08011-08:00","closed_at":"2025-12-05T06:46:36.08011-08:00","labels":["bug","gdocs","validation"]}
{"id":"google_workspace_mcp-928a","content_hash":"cc8b6a0c8510d47b58b8a020158cd92eaee4f0102d2a4ce58f67ca1f44e3892f","title":"Cannot preview range selection without specifying text/formatting","description":"When using modify_doc_text with the preview=true flag and a range parameter, the tool requires a text or formatting parameter even though the user just wants to preview what range would be selected.\n\n## Steps to Reproduce\n```\nmodify_doc_text(\n  document_id='...',\n  range={'section': 'The Problem', 'include_heading': false},\n  preview=true\n)\n```\n\n## Expected Behavior\nThe tool should return information about what range would be selected without requiring text/formatting parameters, since this is a preview operation.\n\n## Actual Behavior\nReturns error: 'text or formatting or convert_to_list or code_block' is required for document modification\n\n## Use Case\nUsers may want to:\n1. Preview what a section contains before deciding what to do\n2. Verify a range selection is correct before specifying the operation\n3. Debug range-based queries to understand what they're selecting\n\n## Suggested Solution\nWhen preview=true and no text/formatting is specified, return the range information including:\n- start_index, end_index\n- content preview (truncated)\n- context (text before/after)\nThis would be similar to how search_based preview works","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T18:58:42.165751-06:00","updated_at":"2025-12-06T19:33:09.848639-06:00","closed_at":"2025-12-06T19:33:09.848639-06:00","labels":["feature-request","gdocs","modify_doc_text","preview"]}
{"id":"google_workspace_mcp-94a1","content_hash":"3f787d0af9b5a407641709d44758cd9e943af88f07e697ef792e9e8422828ac5","title":"Formatting accumulates/bleeds across insertions in modify_doc_text","description":"When inserting text with formatting using modify_doc_text at location='end', subsequent insertions inherit ALL formatting from previous insertions instead of starting fresh.\n\n**Steps to Reproduce:**\n1. Insert text at end with bold=true\n2. Insert text at end with italic=true\n3. Insert text at end with foreground_color='red'\n4. Insert text at end with background_color='yellow'\n\n**Expected Behavior:**\nEach insertion should ONLY have the formatting explicitly specified:\n- TEST 2 should be bold only\n- TEST 3 should be italic only  \n- TEST 4 should be red text only\n- TEST 5 should be yellow background only\n\n**Actual Behavior:**\nAll inserted text has ALL the formatting attributes combined:\n- bold=true, italic=true, foreground=#FF0000, background=#FFFF00, subscript\n- Even text that should ONLY be bold has all formatting attributes\n\n**Additional Notes:**\n- The subscript (baseline_offset=SUBSCRIPT) appears even though it was never requested\n- This suggests the formatting is not being reset between operations\n- Affects both location='end' and search-based insertions","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T19:50:01.737199-06:00","updated_at":"2025-12-06T19:57:31.646243-06:00","closed_at":"2025-12-06T19:57:31.646243-06:00"}
{"id":"google_workspace_mcp-956f","content_hash":"913f3e8fdaa05c13f1d3952005bb3858e8d9dc5eff70d93470b62de2b28a51cc","title":"Add batch operations with search patterns instead of indices","description":"Current batch_modify_doc requires exact indices, which are:\n- Hard to determine without pre-flight calls\n- Fragile (shift after each operation)\n\nAdd search-based batch operations:\n\nbatch_modify_doc(\n    operations=[\n        {\n            \"type\": \"format\",\n            \"search\": \"TODO\",\n            \"all_occurrences\": True,\n            \"bold\": True,\n            \"foreground_color\": \"red\"\n        },\n        {\n            \"type\": \"replace\",\n            \"search\": \"DRAFT\",\n            \"all_occurrences\": True,\n            \"text\": \"FINAL\"\n        },\n        {\n            \"type\": \"insert\",\n            \"search\": \"Introduction\",\n            \"position\": \"after\",\n            \"text\": \"\\n[Added after Introduction]\"\n        }\n    ]\n)\n\nBenefits:\n- No index calculation needed\n- Multiple search-based operations in one call\n- Automatic position adjustment between operations","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T06:48:38.572426-08:00","updated_at":"2025-12-06T14:19:48.746234-06:00","closed_at":"2025-12-06T14:19:48.746234-06:00","labels":["batch","enhancement","gdocs"]}
{"id":"google_workspace_mcp-9b57","content_hash":"307c25766f997db354fd01d9cca8d403834923855a199c9a9c8d39569d9a018f","title":"batch_edit_doc structural operations (insert_table, insert_page_break) fail with search-based positioning","description":"## Problem\nWhen using `batch_edit_doc` with structural operations like `insert_table` or `insert_page_break` and search-based positioning, the operations fail with a KeyError: 'index' even though the search text is found and the `resolved_index` is correctly populated.\n\n## Steps to Reproduce\n```bash\nuv run python test_harness.py --tool batch_edit_doc \\\n  --document_id \"DOC_ID\" \\\n  --user_google_email \"user@example.com\" \\\n  --operations '[{\"type\": \"insert_table\", \"search\": \"Some text\", \"position\": \"after\", \"rows\": 2, \"columns\": 2}]'\n```\n\n## Expected Behavior\nThe table should be inserted after the found text.\n\n## Actual Behavior\nReturns:\n```json\n{\n  \"success\": false,\n  \"message\": \"Failed to build requests: 'index'\"\n}\n```\n\nThe `resolved_index` is correctly populated in the result, but the code fails to use it.\n\n## Workaround\nUse `location` parameter (`location: \"end\"`) instead of search-based positioning - this works.\n\n## Affected Operations\n- `insert_table`\n- `insert_page_break`\n\n## Root Cause\nLikely the request builder for these structural operations expects an `index` key in the operation dict rather than using the `resolved_index` that was computed during search resolution.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T20:56:00.662164-06:00","updated_at":"2025-12-06T21:09:42.258123-06:00","closed_at":"2025-12-06T21:09:42.258123-06:00","labels":["batch_edit_doc","gdocs","search-positioning"]}
{"id":"google_workspace_mcp-9d6e","content_hash":"f01bd928c260ac7c9cca566e280bfb0f08258fec94561f9f4f262980b23d6d66","title":"heading_style in modify_doc_text applies to ALL paragraphs instead of just the first","description":"## Summary\nWhen using modify_doc_text with heading_style parameter to insert multi-line text, the heading style is applied to ALL paragraphs in the inserted text instead of just the first paragraph.\n\n## Steps to Reproduce\n1. Call modify_doc_text with multi-line text and heading_style:\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    location=\"end\",\n    text=\"\\n=== HEADING STYLE BUG TEST ===\\nLine 1: This should be heading\\nLine 2: This should be normal\\nLine 3: This should also be normal\\n\",\n    heading_style=\"HEADING_2\"\n)\n```\n\n## Expected Behavior\nOnly the first paragraph (or perhaps just the line containing the heading text) should be formatted as HEADING_2. Subsequent paragraphs should remain as NORMAL_TEXT.\n\n## Actual Behavior\nALL four paragraphs in the inserted text become HEADING_2:\n- \"=== HEADING STYLE BUG TEST ===\" - level 2 heading\n- \"Line 1: This should be heading\" - level 2 heading\n- \"Line 2: This should be normal\" - level 2 heading (BUG!)\n- \"Line 3: This should also be normal\" - level 2 heading (BUG!)\n\n## Impact\nUsers who want to insert a heading followed by content must make two separate calls:\n1. First call to insert the heading with heading_style\n2. Second call to insert the content without heading_style\n\nThis is a common use case that should be handled better.\n\n## Suggested Fix\nEither:\n1. Apply heading_style only to the first paragraph of inserted text\n2. Document this behavior clearly and suggest using separate calls\n3. Add a parameter like `heading_first_only=True` to control this behavior","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T17:36:13.825915-06:00","updated_at":"2025-12-06T17:40:51.56994-06:00","closed_at":"2025-12-06T17:40:51.56994-06:00","labels":["bug","google-docs","modify_doc_text"]}
{"id":"google_workspace_mcp-9ee9","content_hash":"730a760597aa740e9f25d4f9c0f2985f5d113b83767e06d954f54e7f548d238f","title":"find_doc_elements reports all text as heading1 or heading2","description":"The find_doc_elements tool with element_type='heading' is incorrectly classifying many elements as headings when they are regular text.\n\n## Steps to Reproduce:\n1. Create a document with normal paragraphs and actual headings\n2. Call find_doc_elements(element_type='heading')\n3. Observe results\n\n## Actual Behavior:\nThe tool reports 32 elements as 'headings' including:\n- Regular paragraphs like 'Bold Text TEST', 'Italic Text TEST'\n- List items like 'First item', 'Bullet item'\n- Page break markers\n- Empty lines\n\nAll elements that should be normal paragraphs are classified as 'heading1' or 'heading2'.\n\n## Expected Behavior:\nOnly actual headings (text with HEADING_1, HEADING_2, etc. paragraph style) should be reported.\n\n## Sample Output:\n```json\n{\n  \"type\": \"heading1\",\n  \"start_index\": 108,\n  \"end_index\": 123,\n  \"text\": \"Bold Text TEST\",\n  \"level\": 1\n}\n```\nThis text was just bold text, not a heading.\n\n## Impact:\nUsers cannot reliably find actual headings in their documents. Section navigation and document structure analysis will be broken.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:31:26.686867-06:00","updated_at":"2025-12-06T16:11:01.527705-06:00","closed_at":"2025-12-06T16:11:01.527705-06:00","labels":["bug","document-structure","gdocs"]}
{"id":"google_workspace_mcp-9f5f","content_hash":"ba5047871d4523850fe84b8f763a885b205c9ae7ab38c13522028586df19ae43","title":"batch_edit_doc search resolution happens before execution, breaks chained operations","description":"**Problem**: In `batch_edit_doc`, when using search-based positioning, all search strings are resolved BEFORE any operations are executed. This means you cannot chain operations where later operations search for text inserted by earlier operations.\n\n**Reproduction**:\n```python\n# Add a marker first\nawait call('modify_doc_text', location='end', text='[MARKER]')\n\n# Try batch operations that chain\nawait call('batch_edit_doc', operations=[\n    {'type': 'insert', 'search': '[MARKER]', 'position': 'after', 'text': '[OP1]'},\n    {'type': 'insert', 'search': '[OP1]', 'position': 'after', 'text': '[OP2]'},  # FAILS\n])\n```\n\n**Result**: Second operation fails with 'Text [OP1] not found in document' because [OP1] hasn't been inserted yet at the time of search resolution.\n\n**Expected**: Either:\n1. Resolve searches incrementally as each operation executes, so earlier inserts are visible to later searches\n2. Or clearly document this limitation and suggest alternative patterns\n\n**Impact**: Users trying to build complex batch operations with chained insertions will be confused. This is a common pattern (e.g., inserting multiple items under a heading in sequence).\n\n**Workaround**: Use explicit indices with `auto_adjust_positions=True`, or make multiple calls to modify_doc_text.\n\n**Files involved**: gdocs/managers/batch_operation_manager.py","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T14:59:02.959968-06:00","updated_at":"2025-12-06T15:04:28.686272-06:00","closed_at":"2025-12-06T15:04:28.686272-06:00"}
{"id":"google_workspace_mcp-a332","content_hash":"fc3757b75a873a7f3a1a75183458d8ec44feaa0004624810a1a0cd8886972917","title":"batch_edit_doc format operation ignores heading_style parameter","description":"## Problem\nWhen using `batch_edit_doc` with a `format` operation that includes `heading_style`, the heading style is not applied to the text, even though the operation reports success. The same operation works correctly when using `modify_doc_text` directly.\n\n## Steps to Reproduce\n```bash\n# This does NOT work - heading_style is ignored\nuv run python test_harness.py --tool batch_edit_doc \\\n  --document_id \"DOC_ID\" \\\n  --user_google_email \"user@example.com\" \\\n  --operations '[{\"type\": \"format\", \"search\": \"Some Text\", \"position\": \"replace\", \"bold\": true, \"heading_style\": \"HEADING_2\"}]'\n\n# This DOES work - heading_style is applied\nuv run python test_harness.py --tool modify_doc_text \\\n  --document_id \"DOC_ID\" \\\n  --user_google_email \"user@example.com\" \\\n  --search \"Some Text\" \\\n  --position \"replace\" \\\n  --heading_style \"HEADING_2\"\n```\n\n## Expected Behavior\nThe text should be formatted as HEADING_2 and should appear in the document's heading structure.\n\n## Actual Behavior\nThe `batch_edit_doc` operation reports success and applies other formatting (like bold), but the `heading_style` is not applied. The text does not appear in the document's heading structure.\n\nAfter running `get_text_formatting` on the affected range, I can see `bold: true` but the font remains as whatever was there before (in my test, Courier New from a previous code block), and the text is NOT listed in `get_doc_info --detail headings`.\n\n## Workaround\nUse `modify_doc_text` directly instead of `batch_edit_doc` when needing to apply heading styles.\n\n## Root Cause\nThe `heading_style` parameter is likely not being passed through to the request builder in the format operation handler within `batch_edit_doc`.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T20:56:12.57289-06:00","updated_at":"2025-12-06T21:06:20.683575-06:00","closed_at":"2025-12-06T21:06:20.683575-06:00","labels":["batch_edit_doc","formatting","gdocs","heading_style"]}
{"id":"google_workspace_mcp-a367","content_hash":"a1e71422afba3a3f247b4836ea9f350dc72dd08279e3f8b5c23aba492027d560","title":"Add Named Range tools (create, list, delete) for document navigation","description":"Since bookmark creation is not supported by the Google Docs API, implement Named Range tools as an alternative for marking and referencing document locations.\n\n## Background\nThe Google Docs API does NOT support bookmark creation (see google_workspace_mcp-2e6a). However, it DOES support Named Ranges which provide similar bookmark-like functionality.\n\n## Proposed Tools\n1. **create_named_range** - Create a named range at a specified location or around selected text\n   - Supports: location, index, search-based positioning\n   - Returns: Named range ID for reference\n\n2. **list_named_ranges** - List all named ranges in a document\n   - Returns: List of named ranges with their IDs, names, and positions\n\n3. **delete_named_range** - Delete a named range by ID or name\n\n## API Support\n- CreateNamedRangeRequest - Create named range with name and range (startIndex, endIndex)\n- DeleteNamedRangeRequest - Delete named range by ID or name\n- Document structure includes namedRanges field for listing\n\n## Use Cases\n- Mark sections of a document for programmatic reference\n- Create anchor points for later editing operations\n- Track document regions across multiple edit sessions\n\n## Notes\n- Named ranges mark a range (start to end), not a single point like bookmarks\n- Named ranges are NOT the same as internal bookmark links (#bookmark-id)\n- Names do not need to be unique (multiple ranges can share a name)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T18:20:42.807878-06:00","updated_at":"2025-12-06T19:02:04.651255-06:00","closed_at":"2025-12-06T19:02:04.651255-06:00","labels":["feature-request","gdocs"]}
{"id":"google_workspace_mcp-a783","content_hash":"9b126dbc05585ceeb6a47565103177bbcdfbcf383a73e6c2a4a12764b3588ae8","title":"Inconsistent location API across gdocs tools","description":"**Problem**: `modify_doc_text` supports `location='end'` or `location='start'` for convenient appending/prepending, but `create_table_with_data` does not have this parameter. Instead users must omit `index` to append at end.\n\n**Expected Behavior**: All gdocs tools that support positional insertion should have consistent API parameters. The `location` parameter should be available in:\n- create_table_with_data\n- insert_doc_elements  \n- insert_doc_image\n\n**Current Workaround**: For tables, omit the `index` parameter. The docs mention this but it's not consistent with other tools.\n\n**Impact**: Confusing API - users who learn `location='end'` from modify_doc_text will expect it to work on other tools.\n\n**Files involved**: gdocs/docs_tools.py - create_table_with_data function around line 3541","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T14:53:13.209303-06:00","updated_at":"2025-12-06T15:00:08.095081-06:00","closed_at":"2025-12-06T15:00:08.095081-06:00"}
{"id":"google_workspace_mcp-ab91","content_hash":"aa1d455432c77f18aea1b00bc1023b25094e96245660b5429d8156a89eba9e44","title":"find_and_replace_doc allows empty find_text to pass validation","description":"Empty find_text passes validation and fails at the Google Docs API level.\n\nRepro:\nfind_and_replace_doc(find_text=\"\", replace_text=\"test\")\n\nExpected: Validation error \"find_text cannot be empty\"\nActual: API error \"substring match text should not be empty\"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T05:07:02.650127-08:00","updated_at":"2025-12-05T05:16:23.858875-08:00","closed_at":"2025-12-05T05:16:23.858876-08:00","labels":["bug","gdocs","validation"]}
{"id":"google_workspace_mcp-ac55","content_hash":"2112570f8e9628d140e72b8b38d6cf814cde80f7991f470281251e5977b96ab2","title":"Google Docs API paragraph style inheritance causes content to inherit heading styles","description":"When inserting content after a heading paragraph using modify_doc_text, the new content inherits the previous paragraph's heading style due to Google Docs API behavior. This causes delete_doc_section and get_doc_section to fail to detect section content correctly.\n\nRoot Cause: Google Docs API insertText request does not set paragraph style - new paragraphs inherit from the previous paragraph.\n\nWorkaround: Users should explicitly set heading_style=NORMAL_TEXT when inserting content after headings.\n\nProposed Fix: Modify modify_doc_text to automatically apply NORMAL_TEXT style when inserting text without a heading_style parameter, and the previous paragraph is a heading.\n\nRelated: This is a follow-up to the partial fix in google_workspace_mcp-0d0a which added heuristics to skip false headings (empty text, longer than 60 chars).","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:46:19.542321-06:00","updated_at":"2025-12-06T16:51:08.987632-06:00","closed_at":"2025-12-06T16:51:08.987632-06:00"}
{"id":"google_workspace_mcp-ad4c","content_hash":"ccbfce42adc29ebe197cef68d597024f6fc7dd3d54517e445010284ad9bdd273","title":"get_text_formatting should support search-based positioning","description":"## Summary\n`get_text_formatting` currently only accepts `start_index` and `end_index` parameters. It should also support search-based positioning like other gdocs tools (e.g., `modify_doc_text`, `batch_edit_doc`).\n\n## Current Behavior\n```bash\n# Must use indices\nuv run python test_harness.py --tool get_text_formatting \\\n  --document_id \"DOC_ID\" \\\n  --user_google_email \"user@example.com\" \\\n  --start_index 24896 \\\n  --end_index 24930\n```\n\n## Proposed Behavior\n```bash\n# Should also support search\nuv run python test_harness.py --tool get_text_formatting \\\n  --document_id \"DOC_ID\" \\\n  --user_google_email \"user@example.com\" \\\n  --search \"Some specific text\"\n```\n\n## Use Case\nUsers often want to check the formatting of specific text without first having to use `preview_search_results` to find the indices. This would make the API more consistent and user-friendly.\n\n## Workaround\nUse `preview_search_results` to find the text indices, then pass those to `get_text_formatting`.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T20:56:29.110759-06:00","updated_at":"2025-12-06T21:13:41.423236-06:00","closed_at":"2025-12-06T21:13:41.423236-06:00","labels":["api-consistency","gdocs","get_text_formatting"]}
{"id":"google_workspace_mcp-aef6","content_hash":"9094735b6bb08f6ed04b8a128e25b2fda8f86af60f9cace6bfc0e14e84d19d4a","title":"insert_doc_elements list operation only accepts single text item","description":"## Summary\nThe `insert_doc_elements` tool with `element_type=\"list\"` only accepts a single `text` parameter (string), not a list of items.\n\n## Expected Behavior\nUsers should be able to insert multiple list items at once, e.g.:\n```python\nawait call(\"insert_doc_elements\",\n           element_type=\"list\",\n           list_type=\"UNORDERED\",\n           items=[\"Item 1\", \"Item 2\", \"Item 3\"])  # Should create 3 list items\n```\n\n## Actual Behavior\nThe function signature is:\n```python\nasync def insert_doc_elements(\n    ...\n    text: str = None,  # Single string, not a list\n)\n```\n\nSo you can only insert one list item at a time:\n```python\nawait call(\"insert_doc_elements\",\n           element_type=\"list\",\n           list_type=\"UNORDERED\",\n           text=\"Single Item\")  # Only creates 1 list item\n```\n\n## Impact\n- Poor usability - users need to make multiple API calls to create a list with multiple items\n- Inconsistent with how lists are naturally created (multiple items at once)\n\n## Suggested Fix\n1. Add an `items` parameter that accepts a list of strings\n2. Keep `text` for backwards compatibility (single item)\n3. When `items` is provided, create multiple list items in a single batch operation\n\n## Location\nFile: `gdocs/docs_tools.py`, function `insert_doc_elements`, lines 2500-2507","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:22:39.066454-06:00","updated_at":"2025-12-06T15:41:24.794534-06:00","closed_at":"2025-12-06T15:41:24.794534-06:00"}
{"id":"google_workspace_mcp-b302","content_hash":"86a4bf734cf4eee0b318015121cdea875c5b68046d848d120dab8b986f4c3bb1","title":"Add subscript text formatting to modify_doc_text","description":"Add subscript parameter (bool) to modify_doc_text using baselineOffset: SUBSCRIPT in updateTextStyle API request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:41:20.810096-08:00","updated_at":"2025-12-05T04:47:57.100219-08:00","closed_at":"2025-12-05T04:47:57.100219-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-b3ba","content_hash":"904028b5329c0a27c291ad39ed8ee8b1d91ca62724e6d95ac41f181978fcbcc5","title":"No support for nested lists or adding items to existing lists in Google Docs","description":"## Feature Request\n\nThe current Google Docs tools have limited list manipulation capabilities:\n\n### What's Currently Supported\n1. `insert_doc_elements` with `element_type='list'` - creates a new list\n2. `convert_to_list` parameter in `modify_doc_text` - converts existing paragraphs to list items\n\n### What's Missing\n1. **Nested lists** (sub-items with indentation) - cannot create hierarchical bullet points\n2. **Adding items to an existing list** - have to insert at exact index\n3. **Changing list indentation level** - no way to indent/outdent list items\n4. **Mixed list types** - can't have numbered parent with bullet children\n\n## User Impact\nUsers often need to create structured lists with multiple levels of hierarchy (e.g., outlining, TOC-style lists). Currently this is not possible via the MCP tools.\n\n## Suggested Implementation\n1. Add `nesting_level` parameter to list operations\n2. Add `add_to_list` tool that appends to an existing list at the correct position\n3. Support for changing indentation level of existing list items\n\n## API Reference\nGoogle Docs API supports nesting through the `bulletPreset` property and `nestingLevel` field.\n\n## Priority\nMedium - This is useful for document authoring but not critical.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T16:27:28.655941-06:00","updated_at":"2025-12-06T16:36:55.653344-06:00","closed_at":"2025-12-06T16:36:55.653344-06:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-b4c2","content_hash":"5247652f0971434d0647e70cb80205c53e509d60e2ed0e77dd0380a5c997b703","title":"Add auto-link detection tool (convert URLs to hyperlinks)","description":"Common task: Convert plain text URLs into clickable hyperlinks.\n\nProposed tool:\nauto_linkify(\n    document_id=\"...\",\n    # Option 1: Auto-detect all URLs\n    auto_detect=True,\n    \n    # Option 2: Convert specific text to link\n    search=\"click here\",\n    url=\"https://example.com\"\n)\n\nOr extend find_and_replace_doc:\nfind_and_replace_doc(\n    find_text=\"https://example.com/page\",\n    replace_text=\"Click Here\",\n    link=\"https://example.com/page\"  # Apply link to replacement\n)\n\nBenefits:\n- Single call to linkify entire document\n- Common editing task made trivial\n- Handles both auto-detect and manual linking","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-05T06:48:27.683853-08:00","updated_at":"2025-12-06T14:30:15.068888-06:00","closed_at":"2025-12-06T14:30:15.068888-06:00","labels":["dx","enhancement","gdocs"]}
{"id":"google_workspace_mcp-b4d5","content_hash":"43c63e3e46d04f3d04aede8536c10bcdda6ba1bed0ee40df7201dae429721f63","title":"Add format_all_occurrences tool for bulk text formatting","description":"Currently, formatting multiple occurrences of text requires N separate API calls. Add a tool that formats all occurrences in one call.\n\nExample:\nformat_all_occurrences(\n    document_id=\"...\",\n    search=\"TODO\",\n    bold=True,\n    foreground_color=\"red\"\n)\n\nBenefits:\n- Reduces API calls from N to 1\n- No index tracking needed\n- Common use case: highlight all instances of a term","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T06:47:26.406314-08:00","updated_at":"2025-12-05T08:08:02.719648-08:00","closed_at":"2025-12-05T08:08:02.719648-08:00","labels":["dx","enhancement","gdocs"]}
{"id":"google_workspace_mcp-b75e","content_hash":"f4c4835ffba5c52c77e036351137690077e7cd31c58fe3cad18f160838c30eee","title":"Add superscript text formatting to modify_doc_text","description":"Add superscript parameter (bool) to modify_doc_text using baselineOffset: SUPERSCRIPT in updateTextStyle API request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:41:15.90851-08:00","updated_at":"2025-12-05T04:47:57.076273-08:00","closed_at":"2025-12-05T04:47:57.076273-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-ba17","content_hash":"30c6da2378d025a2a8d4c85fea7850827c64f7dba2c2889a8f148726c63ffb31","title":"extract_document_summary reports 130 headings in document with very few actual headings","description":"The extract_document_summary tool is incorrectly counting headings. It reports 130 headings in a document that has perhaps 10-15 actual headings.\n\n## Steps to Reproduce:\n1. Create a document with a few headings and regular paragraphs\n2. Call extract_document_summary()\n3. Observe the 'total_headings' count\n\n## Actual Behavior:\n```json\n{\n  \"total_headings\": 130,\n  \"total_paragraphs\": 0,\n  \"total_lists\": 0,\n  ...\n}\n```\n\nThe outline also shows that regular paragraph text like 'Bold Text TEST', 'Italic Text TEST', 'Bullet item', etc. are being classified as headings.\n\n## Expected Behavior:\n- Only actual headings (text with HEADING_1 through HEADING_6 paragraph style) should be counted\n- total_paragraphs should be \u003e 0 for regular text\n- total_lists should be \u003e 0 when lists exist in the document\n\n## Related Issues:\nThis appears to be the same underlying issue as find_doc_elements reporting all text as headings.\n\n## Impact:\nDocument analysis and summarization is unreliable. Users cannot get accurate document statistics.","notes":"## Root Cause Analysis\n\nAfter thorough investigation, this is **not a code bug** but rather an issue with the test document data.\n\n### Findings:\n\n1. **The code is working correctly.** The _get_paragraph_style_type() function in gdocs/docs_structure.py properly reads paragraphStyle.namedStyleType from the Google Docs API response.\n\n2. **The test document was corrupted.** The document 123CCb780nFIesNcHMyt5SJ-7ajP3L3iEus0qfJ8eaHg has all paragraphs styled with HEADING_1 or HEADING_2 - even content like 'Bold Text TEST', 'Italic Text TEST', empty lines, etc. that should be NORMAL_TEXT.\n\n3. **Fresh documents work correctly.** When tested on a newly created document with proper paragraph styles, the output shows:\n   - total_headings: 0 (correct)\n   - total_paragraphs: 5 (correct)\n   - total_lists: 0 (correct)\n\n### Evidence:\nDirect API query of the test document shows values like:\n- namedStyleType='HEADING_1' for 'Bold Text TEST'\n- namedStyleType='HEADING_1' for empty lines\n\nThese values come directly from Google Docs API - our code is correctly reading what's there.\n\n### Resolution:\nThe test document likely had heading styles applied during previous testing sessions. No code changes needed. The document should either be recreated or have its styles reset manually in Google Docs.","status":"closed","priority":2,"issue_type":"task","assignee":"mbradshaw","created_at":"2025-12-06T15:35:38.160823-06:00","updated_at":"2025-12-06T16:07:59.753087-06:00","closed_at":"2025-12-06T16:07:59.753088-06:00","labels":["bug","document-structure","extract_document_summary","gdocs"]}
{"id":"google_workspace_mcp-c073","content_hash":"2a81c98c02c0b285553c2e281f692c111632e31e5fc59bfa60d42e60519ea090","title":"batch_edit_doc insert_table documentation says 'cols' but requires 'columns'","description":"## Bug Description\n\nThe batch_edit_doc tool documentation and error message use inconsistent parameter naming for table column count.\n\n## Steps to Reproduce\n\n1. Try to insert a table with 'cols' parameter (as might be guessed from common conventions):\n```python\nbatch_edit_doc(\n    document_id='...',\n    operations=[{'type': 'insert_table', 'location': 'end', 'rows': 2, 'cols': 2}]\n)\n```\n\n2. Result: Error message: \"Failed to build requests: 'columns'\"\n\n3. Use 'columns' instead:\n```python\nbatch_edit_doc(\n    document_id='...',\n    operations=[{'type': 'insert_table', 'location': 'end', 'rows': 2, 'columns': 2}]\n)\n```\n\n4. Result: Works correctly\n\n## Expected Behavior\n\n1. The parameter should be clearly documented as 'columns' (or accept both 'cols' and 'columns')\n2. The error message \"Failed to build requests: 'columns'\" is confusing - it should say something like \"Missing required parameter 'columns' for insert_table operation\"\n\n## Additional Context\n\nThe batch_edit_doc tool description does not explicitly list the parameters for insert_table operation. Users have to guess or look at source code.\n\n## Suggested Fix\n\n1. Update documentation to explicitly show insert_table parameters:\n   `{\"type\": \"insert_table\", \"index\": 100, \"rows\": 3, \"columns\": 4}`\n2. Improve error message to be more helpful when required parameters are missing","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T21:21:36.430991-06:00","updated_at":"2025-12-06T21:26:45.780909-06:00","closed_at":"2025-12-06T21:26:45.780909-06:00","labels":["batch_edit_doc","documentation","gdocs"]}
{"id":"google_workspace_mcp-c314","content_hash":"1da45b8ff0def9c7362346ac8642fed0dbef7095b5b0b2f1707d116cbc5f0dac","title":"Add paragraph alignment support to modify_doc_text","description":"Add support for paragraph alignment (LEFT, CENTER, RIGHT, JUSTIFIED) via updateParagraphStyle API request.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-04T22:40:59.168394-08:00","updated_at":"2025-12-05T04:47:56.998705-08:00","closed_at":"2025-12-05T04:47:56.998705-08:00","labels":["enhancement","gdocs"]}
{"id":"google_workspace_mcp-c96a","content_hash":"e1b94c49d162a7d54372af1824af06b60f8bb94eb361ff31cd3800007ab94c1f","title":"batch_edit_doc shows misleading success=true for operations that were never executed","description":"## Issue\n\nWhen batch_edit_doc encounters an operation that fails to resolve (e.g., a search term not found), the response is misleading:\n\n1. It shows `operations_completed: 0` (correct)\n2. But for other operations that were \"resolved\" (indices calculated) but never executed, it shows `success: true`\n3. The `document_link` is `null` which hints at the problem, but the per-operation `success: true` is confusing\n\n## Reproduction Steps\n\n```bash\npython test_harness.py --tool batch_edit_doc \\\n  --document_id \"\u003cdoc_id\u003e\" \\\n  --operations '[{\"type\": \"insert\", \"search\": \"NONEXISTENT\", \"position\": \"after\", \"text\": \"Fail\"}, {\"type\": \"insert\", \"location\": \"end\", \"text\": \"This should work\"}]'\n```\n\n## Actual Result\n\n```json\n{\n  \"success\": false,\n  \"operations_completed\": 0,\n  \"total_operations\": 2,\n  \"results\": [\n    {\n      \"index\": 0,\n      \"type\": \"insert\",\n      \"success\": false,\n      \"description\": \"Search failed for 'NONEXISTENT'\",\n      ...\n    },\n    {\n      \"index\": 1,\n      \"type\": \"insert\",\n      \"success\": true,  // \u003c-- MISLEADING - this was never executed!\n      \"description\": \"insert 'This should work' at 25181\",\n      \"position_shift\": 16,\n      \"affected_range\": {...},\n      \"resolved_index\": 25181\n    }\n  ],\n  \"document_link\": null  // \u003c-- This hints at failure, but success=true is confusing\n}\n```\n\n## Expected Result\n\nEither:\n1. Change `success` to something like `resolved: true, executed: false` for operations that were resolved but not executed\n2. Add an `executed` field to distinguish between resolution and execution\n3. Change `success: true` to `success: null` or omit it for unexecuted operations\n\n## Impact\n\nUsers may think their operations partially succeeded when they actually all failed.","status":"closed","priority":2,"issue_type":"bug","assignee":"mbradshaw","created_at":"2025-12-06T21:48:19.736253-06:00","updated_at":"2025-12-06T21:58:05.2548-06:00","closed_at":"2025-12-06T21:58:05.254801-06:00","labels":["batch_edit_doc","gdocs","ux"]}
{"id":"google_workspace_mcp-c974","content_hash":"89c0b8fe5f25a76a8051a609057b5285d943b7bba02d739f3fa5f4f19cc52f8e","title":"modify_doc_text: Empty string insertion causes raw API error","description":"When calling modify_doc_text with text='' (empty string) and location='end', the function does not validate the input and passes it directly to the Google Docs API, which returns an unhandled error:\n\n```\nHttpError 400: Invalid requests[0].insertText: Insert text requests must specify text to insert.\n```\n\n**Steps to Reproduce:**\n1. Call modify_doc_text with location='end' and text=''\n2. Observe raw API error being thrown\n\n**Expected Behavior:**\nThe function should validate that text is non-empty before making the API call and return a structured error like:\n```json\n{\n  \"error\": true,\n  \"code\": \"INVALID_PARAM_VALUE\",\n  \"message\": \"Cannot insert empty text\",\n  \"suggestion\": \"Provide non-empty text to insert, or use position='replace' with empty text to delete existing content\"\n}\n```\n\n**Actual Behavior:**\nRaw API error is raised without being caught and converted to structured response.\n\n**Location:** gdocs/docs_tools.py, modify_doc_text function\n\n**Impact:** Poor user experience - users get confusing API errors instead of helpful guidance.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T14:45:53.783162-06:00","updated_at":"2025-12-06T14:51:16.337598-06:00","closed_at":"2025-12-06T14:51:16.337598-06:00"}
{"id":"google_workspace_mcp-cb80","content_hash":"b66380e16f41c2ac24baf48a366bd4dd7212f95de3ad3ebf56aff794fdb207f9","title":"find_doc_elements silently fails for plural element_type values","description":"## Bug Description\n\nWhen using `find_doc_elements` with plural forms of element types (e.g., 'tables' instead of 'table', or 'lists' instead of 'list'), the function returns 0 elements without any error or suggestion.\n\n## Steps to Reproduce\n\n1. Use find_doc_elements with element_type='tables':\n```\nfind_doc_elements(document_id='...', element_type='tables')\n```\n\n2. Result: Returns `{\"count\": 0, \"element_type\": \"tables\", \"elements\": []}`\n\n3. Use find_doc_elements with element_type='table':\n```\nfind_doc_elements(document_id='...', element_type='table')\n```\n\n4. Result: Correctly returns all tables in the document\n\n## Expected Behavior\n\nEither:\n1. Accept plural forms (tables, lists) as aliases for the singular forms\n2. Return a helpful error message like \"Invalid element_type 'tables'. Did you mean 'table'?\"\n\n## Impact\n\nUsers naturally might try 'tables' or 'lists' expecting it to work, and would be confused when it returns 0 elements without any indication that the parameter value is incorrect.\n\n## Supported Values (per documentation)\n- table (not tables)\n- list (not lists)\n- heading, heading1-heading6\n- paragraph, bullet_list, numbered_list\n- title, table_of_contents","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T21:21:25.117269-06:00","updated_at":"2025-12-06T21:29:19.43473-06:00","closed_at":"2025-12-06T21:29:19.43473-06:00","labels":["find_doc_elements","gdocs","usability"]}
{"id":"google_workspace_mcp-cf19","content_hash":"e9e3ca5be442689ade554f5e89b6d6d143387574ada095c18f13e2ac45572d83","title":"Add merge_table_cells and split_table_cells tools","description":"Currently there is no way to merge or split cells in a table. This is common functionality for creating table headers that span multiple columns or organizing complex data layouts. Implementation would use Google Docs API's mergeTableCells and unmergeTableCells requests.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:33:55.038585-06:00","updated_at":"2025-12-06T18:35:49.133423-06:00","closed_at":"2025-12-06T18:35:49.133423-06:00","labels":["feature-request","gdocs","table"]}
{"id":"google_workspace_mcp-cf54","content_hash":"ef78a8ddf5af87b959d217ed7a503e4073c525cf9780f74799b487291d670ea1","title":"batch_edit_doc: Missing validation for insert operations without text or position","description":"When calling batch_edit_doc with an insert operation that lacks required fields (text, index, or location), the operation doesn't fail with a clear validation error. Instead, it passes through to the Google API which returns a confusing error.\n\n**Reproduction:**\n```bash\npython test_harness.py --tool batch_edit_doc \\\n  --document_id \"...\" \\\n  --operations '[{\"type\": \"insert\"}]'\n```\n\n**Current behavior:**\nReturns:\n```json\n{\n  \"success\": false,\n  \"operations_completed\": 0,\n  \"total_operations\": 1,\n  \"results\": [\n    {\n      \"index\": 0,\n      \"type\": \"insert\",\n      \"success\": true,  // \u003c-- misleading, says success\n      \"description\": \"insert operation\",\n      \"position_shift\": 0,\n      \"affected_range\": {\"start\": 0, \"end\": 0}\n    }\n  ],\n  \"message\": \"Batch execution failed: \u003cHttpError 400 when requesting ... returned 'Must specify at least one request.'...\"\n}\n```\n\n**Expected behavior:**\nShould fail with validation error before API call:\n```json\n{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"INVALID_OPERATION\",\n    \"message\": \"Insert operation requires 'text' and either 'index', 'location', or 'search' for positioning\",\n    \"operation_index\": 0\n  }\n}\n```\n\n**Issues:**\n1. The individual operation result shows `success: true` when it clearly failed\n2. Error message is raw API error, not user-friendly\n3. Validation should happen before API call","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T16:54:31.62949-06:00","updated_at":"2025-12-06T17:01:00.649672-06:00","closed_at":"2025-12-06T17:01:00.649672-06:00","labels":["api","gdocs","validation"]}
{"id":"google_workspace_mcp-d00d","content_hash":"548538921709fc21a8a3293eaaec9a40bd5ae9b258761faebad162caf231cfa2","title":"GDocs: Missing horizontal rule/divider support in insert_doc_elements","description":"The `insert_doc_elements` tool only supports:\n- table\n- list\n- page_break\n\n## Feature Request:\nAdd support for horizontal rule/divider insertion. Google Docs supports horizontal lines as content dividers.\n\n## Expected API:\n```python\ninsert_doc_elements(doc_id, element_type='horizontal_rule', location='end')\n```\n\n## Use Cases:\n- Separating sections of a document\n- Visual break between content blocks\n- Creating divider lines in reports","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T16:10:57.028884-06:00","updated_at":"2025-12-06T17:22:44.427417-06:00","closed_at":"2025-12-06T17:22:44.427417-06:00"}
{"id":"google_workspace_mcp-d06f","content_hash":"5d239090136c00092541e044dd10072274bc4e4e18f941ee7e3f84def80c68c3","title":"find_doc_elements returns 0 lists even when document has lists","description":"The find_doc_elements tool with element_type='list' returns 0 elements even when the document clearly contains ordered and unordered lists.\n\n## Steps to Reproduce:\n1. Create a document with lists using insert_doc_elements(element_type='list', list_type='ORDERED', text='Item')\n2. Call find_doc_elements(element_type='list')\n3. Observe result\n\n## Actual Behavior:\n```json\n{\n  \"count\": 0,\n  \"element_type\": \"list\",\n  \"elements\": []\n}\n```\n\n## Expected Behavior:\nThe tool should find and return all list elements in the document.\n\n## Impact:\nUsers cannot programmatically discover or manipulate lists in their documents.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:31:42.267303-06:00","updated_at":"2025-12-06T15:37:31.200811-06:00","closed_at":"2025-12-06T15:37:31.200811-06:00","labels":["bug","document-structure","gdocs","lists"]}
{"id":"google_workspace_mcp-d2c5","content_hash":"853d4067f1b43a30c200d367d63c5c801333825df91a56b6d07f1f21a6a0dfbc","title":"Feature: Add create_header/create_footer functionality","description":"Currently there's no way to create headers and footers programmatically - users must manually create them in Google Docs first before the update_doc_headers_footers function can work.\n\n**Requested Feature:**\nAdd ability to create new headers and footers in documents that don't have them.\n\n**Use Cases:**\n1. Automated document creation workflows that need standard headers/footers\n2. Template-based document generation\n3. Adding company branding to documents programmatically\n\n**Suggested Implementation:**\nEither:\n1. Modify update_doc_headers_footers to create if not exists (upsert behavior)\n2. Add new functions: create_doc_header() and create_doc_footer()\n3. Rename to set_doc_headers_footers() with upsert semantics\n\n**Google Docs API Support:**\nThe Google Docs API supports creating headers/footers via:\n- createHeader request\n- createFooter request\n\nThese should be used when the document doesn't have existing headers/footers.\n\n**Location:** gdocs/docs_tools.py\n\n**Related Issue:** google_workspace_mcp-63f7 (update_doc_headers_footers cannot create new headers/footers)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T14:47:10.347618-06:00","updated_at":"2025-12-06T15:14:55.229541-06:00","closed_at":"2025-12-06T15:14:55.229541-06:00"}
{"id":"google_workspace_mcp-d5ff","content_hash":"403e8ccab5e4bd2b8b9e92031146eaec3bcbf28288d844622c2822547bffdba9","title":"Plain text insertions inherit surrounding formatting by default","description":"When inserting plain text (no formatting specified) adjacent to formatted text, the new text inherits the surrounding formatting instead of being plain.\n\n**Steps to Reproduce:**\n1. Insert text with italic=true: 'Italic only text'\n2. Insert plain text after it (no formatting specified): 'Plain text after italic'\n3. Check the formatting of the new text\n\n**Expected Behavior:**\nPlain text should be plain - no bold, no italic, no colors\n\n**Actual Behavior:**\nThe 'Plain text after italic' text has italic=true because it inherited from the surrounding text.\n\n**Why This Is A Bug:**\nWhen a user inserts text without specifying any formatting, they likely expect it to be plain/default formatted. The current behavior makes it impossible to insert plain text adjacent to formatted text without explicitly specifying all formatting as False.\n\n**Suggested Fix:**\nWhen no formatting options are specified, the tool should explicitly clear inherited formatting by setting all formatting properties to their defaults (bold=false, italic=false, etc.) rather than relying on the API's inheritance behavior.\n\n**Example Result:**\n{\n  'start_index': 24896,\n  'end_index': 24936,\n  'text': 'Italic only textPlain text after italic\\n',\n  'formatting': [{'italic': true, ...}]  // ALL text has italic=true\n}","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T20:01:34.883167-06:00","updated_at":"2025-12-06T20:09:11.048141-06:00","closed_at":"2025-12-06T20:09:11.048141-06:00"}
{"id":"google_workspace_mcp-d76d","content_hash":"fd0482cdf0defd2448a79428b5ad6d285f20433f0e22242c16faff8285bf7ac1","title":"Complete tab_id propagation through Google Docs editing functions","description":"## Summary\nThe foundation for multi-tab Google Docs support has been laid (google_workspace_mcp-26b8), but the tab_id parameter needs to be fully propagated through the function logic.\n\n## Completed Work\n- Added list_doc_tabs tool to discover tab IDs\n- Added tab_id parameter to core helper functions in docs_helpers.py:\n  - create_insert_text_request\n  - create_insert_text_segment_request\n  - create_delete_range_request\n  - create_format_text_request\n  - create_clear_formatting_request\n  - create_find_replace_request (uses tab_ids list)\n  - create_insert_table_request\n  - create_insert_page_break_request\n  - create_insert_horizontal_rule_requests\n  - create_insert_image_request\n  - create_bullet_list_request\n  - create_paragraph_style_request\n  - create_insert_section_break_request\n  - create_insert_footnote_request\n- Added tab_id parameter to tool function signatures:\n  - modify_doc_text\n  - find_and_replace_doc\n  - batch_edit_doc\n\n## Remaining Work\nThe tab_id parameter is accepted by these tools but not yet propagated through the function bodies to the helper function calls. Need to:\n\n1. Modify modify_doc_text to pass tab_id to all helper function calls\n2. Modify batch_edit_doc to pass tab_id to BatchOperationManager\n3. Modify find_and_replace_doc to use tab_ids in create_find_replace_request\n4. Update BatchOperationManager to accept and use tab_id\n5. Add tests for multi-tab operations\n\n## Files to modify\n- gdocs/docs_tools.py (multiple locations)\n- gdocs/managers/batch_operation_manager.py\n\n## API Reference\nPer Google Docs API docs: https://developers.google.com/workspace/docs/api/how-tos/tabs\n- Use tabId in Location objects for most operations\n- Use tabsCriteria with tabIds array for replaceAllText, deleteNamedRange, replaceNamedRangeContent","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T20:29:55.619879-06:00","updated_at":"2025-12-06T20:36:48.255183-06:00","closed_at":"2025-12-06T20:36:48.255183-06:00","labels":["enhancement","google-docs","tabs"]}
{"id":"google_workspace_mcp-de23","content_hash":"7f4f560f5513f47e1e50c8b3979b6f1119881edc39028d9abb140dbc7aca409e","title":"delete_doc_section fails when section is at end of document","description":"The delete_doc_section tool fails with a 400 API error when trying to delete a section that is at the very end of the document.\n\n## Error Message\nInvalid requests[0].deleteContentRange: The range cannot include the newline character at the end of the segment.\n\n## Reproduction Steps\n1. Create a new section with a heading at the end of the document\n2. Call delete_doc_section with that heading\n3. The API returns a 400 error\n\n## Root Cause\nThe code is including the final newline character of the document segment in the delete range. Google Docs API doesn't allow deleting the final newline that terminates a document body segment.\n\n## Expected Behavior\ndelete_doc_section should work for sections at any position in the document, including at the end. The end_index calculation needs to exclude the final newline character when the section extends to the end of the document body.\n\n## Affected Files\n- gdocs/docs_tools.py (delete_doc_section function, around line 4478)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T17:52:38.701758-06:00","updated_at":"2025-12-06T17:58:42.682279-06:00","closed_at":"2025-12-06T17:58:42.682279-06:00"}
{"id":"google_workspace_mcp-e83f","content_hash":"5bdd02550e0766eb67b431950b2243d2714aa7f76da17c01b683a40e4a5e1090","title":"Add structured error for index out of bounds","description":"The modify_doc_text tool returns raw Google API errors when an index is out of bounds, instead of the structured error format used for other validation errors.\n\n## Current Behavior\nWhen start_index exceeds document length, the error is a raw HttpError 400.\n\n## Expected Behavior\nShould return structured error like other validation errors with code, message, reason, suggestion, and context.\n\n## Fix\nAdd pre-validation to check index bounds before calling Google API, or catch the HttpError 400 and convert to structured format.\n\nRelated to: google_workspace_mcp-66a1.5","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-04T14:24:29.840653-08:00","updated_at":"2025-12-04T14:29:54.150526-08:00","closed_at":"2025-12-04T14:29:54.150526-08:00","labels":["dx","google-docs"],"comments":[{"id":1,"issue_id":"google_workspace_mcp-e83f","author":"mbradshaw","text":"Fixed by modifying handle_http_errors decorator in core/utils.py to detect index out-of-bounds errors from Google Docs API (HttpError 400) and convert them to structured error format with INDEX_OUT_OF_BOUNDS code, actionable suggestions, and context. Added _parse_docs_index_error helper function. Added 6 unit tests in gdocs/test_errors.py. All 49 error tests pass.","created_at":"2025-12-04T22:30:12Z"}]}
{"id":"google_workspace_mcp-e888","content_hash":"7b3077e245d36e7f43dcf1e66f112e9305517af21d158e6ff3b20a532e9b23e2","title":"delete_doc_named_range fails to delete named ranges by name or ID","description":"When attempting to delete a named range using delete_doc_named_range, the operation fails with 'No named range with name/ID' error even though the named range exists and is returned by list_doc_named_ranges.\n\n## Steps to Reproduce:\n1. Create a named range: create_doc_named_range(name='test_named_range', search='Some Text')\n2. Verify it exists: list_doc_named_ranges() shows the range with ID 'kix.88bwjq62h3g2'\n3. Try to delete by name: delete_doc_named_range(name='test_named_range') \n4. Error: 'No named range with name: test_named_range'\n5. Try to delete by ID: delete_doc_named_range(named_range_id='kix.88bwjq62h3g2')\n6. Error: 'No named range with ID: kix.88bwjq62h3g2'\n\n## Expected Behavior:\nNamed range should be deleted successfully.\n\n## Actual Behavior:\nAPI returns 400 error claiming the named range doesn't exist, even though list_doc_named_ranges shows it.\n\n## Possible Cause:\nThis may be related to Google Docs tabs. The named range might be created in a specific tab, but the delete operation might be looking in the default tab or not specifying the tab properly in the batchUpdate request.\n\n## Impact:\nCannot delete named ranges, making the named range cleanup impossible via the API.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T19:17:30.053135-06:00","updated_at":"2025-12-06T19:28:17.335016-06:00","closed_at":"2025-12-06T19:28:17.335016-06:00"}
{"id":"google_workspace_mcp-ec3a","content_hash":"467776033fd19928788a12d33de10ba6552058abc8c0357f7c4baeac548341af","title":"line_spacing parameter uses unintuitive percentage values","description":"The line_spacing parameter in modify_doc_text expects values like 100, 150, 200 (representing percentages) rather than intuitive decimal multipliers like 1.0, 1.5, 2.0.\n\n**Steps to Reproduce:**\n1. Call modify_doc_text with line_spacing=2.0 (expecting double spacing)\n2. Observe error: Invalid 'line_spacing' value '2.0' - Use one of: 50-1000 (100=single, 150=1.5x, 200=double)\n\n**Expected Behavior:**\nEither:\n1. Accept both decimal (1.0, 1.5, 2.0) and percentage (100, 150, 200) formats\n2. OR use more intuitive named values like 'single', 'one_and_half', 'double'\n\n**Actual Behavior:**\nOnly accepts percentage integers which requires users to know the internal Google Docs API format.\n\n**Suggested Fix:**\nAdd input normalization:\n- If value \u003c 10, multiply by 100 (treat as decimal multiplier)\n- If value \u003e= 10 and \u003c= 1000, use as-is (percentage)\n- Optionally accept string values: 'single', 'double', etc.\n\n**Location:** gdocs/docs_tools.py, modify_doc_text function and validation\n\n**Impact:** Minor usability issue - users have to read error messages to learn the correct format.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:46:15.828044-06:00","updated_at":"2025-12-06T18:55:41.075802-06:00","closed_at":"2025-12-06T18:55:41.075802-06:00"}
{"id":"google_workspace_mcp-eebf","content_hash":"f8b7f188680d2e226e354e7037dd0578fd227f6ecd7588a196abdbee90d628d3","title":"batch_edit_doc format operation shows 'none' for foreground_color formatting","description":"When using batch_edit_doc with a format operation that includes foreground_color, the operation description says '(none)' even though the color should be applied.\n\nSteps to reproduce:\n1. Call batch_edit_doc with:\n   - operations: [{'type': 'format', 'search': 'some text', 'position': 'replace', 'foreground_color': '#FF0000'}]\n   - Result shows: 'description': 'format 177912-177928 (none)'\n\nExpected: The description should show '(foreground_color=#FF0000)' or similar to indicate what formatting was applied.\n\nAlso compare with bold/italic which do show in the description:\n- 'description': 'format 36255-36279 (italic=True)'\n\nThis makes it unclear if the foreground_color was actually applied or not.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T17:15:20.591901-06:00","updated_at":"2025-12-06T17:24:45.313749-06:00","closed_at":"2025-12-06T17:24:45.313749-06:00"}
{"id":"google_workspace_mcp-eeda","content_hash":"99d5c5317fee9f989266607a7b29de7d8e951cc4cbeb13a2d4a65834a50dbffb","title":"modify_doc_text allows negative start_index to pass validation","description":"Negative index values pass validation and only fail at the Google Docs API level. Should be caught during validation.\n\nRepro:\nmodify_doc_text(start_index=-5, text=\"test\")\n\nExpected: Validation error before API call\nActual: API error \"Index must be greater than or equal to 0\"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T05:05:11.121119-08:00","updated_at":"2025-12-05T05:18:00.27312-08:00","closed_at":"2025-12-05T05:18:00.27312-08:00","labels":["bug","gdocs","validation"]}
{"id":"google_workspace_mcp-eefa","content_hash":"f0a662e4f97c04c852f86ff262a3161f0805843d72cf7f5543e65d19e9b30089","title":"Empty search string should have specific error, not \"not found\"","description":"When an empty string is passed as the search parameter, the error message says \"Could not find in the document\" which is confusing. Should validate and return a clearer error.\n\nRepro:\nmodify_doc_text(search=\"\", position=\"after\", text=\"test\")\n\nExpected: Error like \"search text cannot be empty\"\nActual: SEARCH_TEXT_NOT_FOUND with message \"Could not find \"\" in the document\"\n\nMinor UX issue - the empty search should be caught during validation with a specific error.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-05T05:07:44.052797-08:00","updated_at":"2025-12-05T07:01:20.702079-08:00","closed_at":"2025-12-05T07:01:20.70208-08:00","labels":["bug","dx","gdocs"]}
{"id":"google_workspace_mcp-f4ee","content_hash":"835ab9d3119278b693eaecee4d3227d77e2dea0b4817201be12026c9034c853a","title":"debug_table_structure table_index=0 finds first table in doc, not most recent","description":"When creating a new table with create_table_with_data and then immediately calling debug_table_structure with table_index=0, it returns the first table in the document rather than the newly created one.\n\n**Steps to Reproduce:**\n1. Create a new table at end of document using create_table_with_data\n2. Call debug_table_structure with table_index=0\n3. Observe it returns the first table in the document (from earlier content), not the newly created one\n\n**Expected Behavior:**\nEither:\n1. Return the newly created table (if the expectation is 'most recent')\n2. Clear documentation that table_index=0 means 'first table in document order'\n3. Add support for table_index=-1 to get the last table\n\n**Actual Behavior:**\ntable_index=0 returns the first table found when scanning document from top to bottom.\n\n**Suggested Fix:**\n1. Document that table_index is 0-based from document start\n2. Add support for negative indices (-1 = last table, -2 = second to last, etc.)\n3. Consider returning table ID/index in create_table_with_data response for easier subsequent operations\n\n**Location:** gdocs/docs_tools.py, debug_table_structure function\n\n**Impact:** Users may modify wrong table after creating a new one.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-06T14:47:21.584441-06:00","updated_at":"2025-12-06T18:49:48.114486-06:00","closed_at":"2025-12-06T18:49:48.114486-06:00"}
{"id":"google_workspace_mcp-f500","content_hash":"635ee24dd063aaa73b3cf24aa66bc62122b6113320f4e55e272947c613f203bf","title":"font_size=0 passes validation but should be rejected","description":"font_size=0 passes validation even though the valid range is 1-400.\n\nRepro:\nmodify_doc_text(location=\"end\", text=\"test\", font_size=0)\n\nExpected: Validation error \"font_size must be between 1 and 400\"\nActual: Operation succeeds (font_size=0 is sent to API)\n\nNote: font_size=401 IS correctly rejected.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-05T05:09:39.661985-08:00","updated_at":"2025-12-05T06:50:25.823908-08:00","closed_at":"2025-12-05T06:50:25.823908-08:00","labels":["bug","gdocs","validation"]}
{"id":"google_workspace_mcp-f695","content_hash":"30d550285a78e5fb51e42731665d1be52294115625d0e5574bcca3832038cdd7","title":"create_document_comment lacks ability to anchor comment to specific text range","description":"The create_document_comment tool creates floating comments that are not anchored to specific text in the document. This is different from how Google Docs typically handles comments, where comments are attached to highlighted text.\n\n**Current Behavior:**\n- Comments are created as floating comments not attached to any text\n- There's no way to specify which text range the comment should be anchored to\n\n**Desired Behavior:**\n- Add optional parameters like start_index and end_index or search parameter\n- Allow users to specify the text range to anchor the comment\n- Keep backwards compatibility with floating comments when no range is specified\n\n**Use Cases:**\n- Code review style commenting on specific sections\n- Highlighting specific issues or questions about text\n- Collaborative editing with contextual feedback\n\n**Example API:**\n```python\ncreate_document_comment(\n    document_id='...',\n    comment_content='This needs clarification',\n    start_index=100,\n    end_index=150\n)\n\n# Or search-based\ncreate_document_comment(\n    document_id='...',\n    comment_content='Why was this choice made?',\n    search='some specific text to comment on'\n)\n```","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T18:18:51.258266-06:00","updated_at":"2025-12-06T20:14:41.451722-06:00","closed_at":"2025-12-06T20:14:41.451722-06:00","labels":["comments","feature-request","gdocs"],"comments":[{"id":11,"issue_id":"google_workspace_mcp-f695","author":"mbradshaw","text":"Investigation completed: This feature is NOT implementable due to a Google API limitation.\n\n**Research Findings:**\n\nThe Google Drive API's anchor feature for comments is designed for non-Google Editor files (PDFs, images, etc.) only. Anchored comments cannot be programmatically created for Google Docs, Sheets, or Slides.\n\n**Evidence:**\n1. Stack Overflow (https://stackoverflow.com/questions/23498275): Confirmed that 'The Anchoring Comments feature from the Google Drive API is intended for non-Google Docs editors files, not for Google Editors files'\n\n2. Google Issue Tracker #36763384 (https://issuetracker.google.com/issues/36763384): Feature request for this capability has been 'blocked' since 2014, with the most recent activity showing it still unresolved as of November 2025\n\n3. Official Google Drive API documentation confirms anchors only work with non-native Google file types\n\n**Conclusion:**\nThis is a limitation of the Google Drive API, not our MCP implementation. Google has not provided a way to programmatically create anchored comments in Google Docs. The existing floating comment functionality is the maximum capability available through the API.\n\nClosing as 'wont_fix' - external dependency limitation.","created_at":"2025-12-07T02:14:35Z"}]}
{"id":"google_workspace_mcp-f74a","content_hash":"1c2dc3f757131ea6c970fa18d1b2a325ae40934cbbe79a3ccc542db466b8fd78","title":"insert_doc_elements allows invalid list_type values","description":"Invalid list_type values like \"INVALID_LIST_TYPE\" pass validation. Only ORDERED and UNORDERED should be allowed.\n\nRepro:\ninsert_doc_elements(element_type=\"list\", index=100, list_type=\"INVALID\", text=\"Item\")\n\nExpected: Validation error \"list_type must be ORDERED or UNORDERED\"\nActual: Reports success \"Inserted invalid_list_type list\"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T05:10:08.558332-08:00","updated_at":"2025-12-05T05:16:10.780049-08:00","closed_at":"2025-12-05T05:16:10.78005-08:00","labels":["bug","gdocs","validation"]}
{"id":"google_workspace_mcp-f7c3","content_hash":"cdd3e78b9e6e910077b2264f8ffd71f36f1aa379df89051f586c8c1a463c945d","title":"Missing functionality: No way to create/insert code blocks in documents","description":"While there is an extract_code_blocks tool to extract code from documents, there is no corresponding tool to CREATE code blocks.\n\n## Expected functionality:\nA tool or option in modify_doc_text to create code-styled text blocks, similar to how code blocks work in Markdown or other rich text editors.\n\n## Suggested implementation options:\n1. Add a 'code_block' parameter to modify_doc_text that applies:\n   - Monospace font (e.g., Courier New or Consolas)\n   - Optional background color (e.g., light gray #f0f0f0)\n\n2. Create a dedicated 'insert_code_block' tool that:\n   - Takes code text and optionally a language hint\n   - Applies appropriate monospace formatting\n   - Optionally adds background highlighting\n\n## Use case:\nUsers want to insert properly formatted code snippets into their documents programmatically.\n\n## Workaround:\nCurrently users can use modify_doc_text with font_family='Courier New' and background_color='#f0f0f0', but this is not documented and requires knowing the correct parameters.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T15:44:33.152016-06:00","updated_at":"2025-12-06T16:01:30.633866-06:00","closed_at":"2025-12-06T16:01:30.633866-06:00"}
{"id":"google_workspace_mcp-ff1d","content_hash":"c75643a59cea5b58b160f35fb916f5c520f1252d0c8380599d08129eb3cf0949","title":"delete_doc_named_range fails on multi-tab documents","description":"## Summary\nThe `delete_doc_named_range` function fails to delete named ranges when the document has multiple tabs. The error message from the Google Docs API is:\n\n```\nInvalid requests[0].deleteNamedRange: No named range with name: TestRange1\n```\n\nor\n\n```\nInvalid requests[0].deleteNamedRange: No named range with ID: kix.gr9jiokstk92\n```\n\nBoth deletion by name and by ID fail, even though `list_doc_named_ranges` correctly finds and returns the named range.\n\n## Root Cause\nThe `create_delete_named_range_request` helper function in `docs_helpers.py` (line 2670-2706) supports a `tabs_criteria` parameter to specify which tabs to delete from. However, the `delete_doc_named_range` function in `docs_tools.py` (around line 9458) does NOT pass this parameter:\n\n```python\nrequest = create_delete_named_range_request(\n    named_range_id=named_range_id, name=name\n)\n```\n\nFor multi-tab documents, the Google Docs API requires specifying which tabs contain the named range.\n\n## Steps to Reproduce\n1. Create a named range in a multi-tab document using `create_doc_named_range`\n2. Verify it exists using `list_doc_named_ranges` (shows `tab_id: 't.0'`)\n3. Try to delete it using `delete_doc_named_range` with either name or ID\n4. Observe the API error\n\n## Proposed Fix\nThe `delete_doc_named_range` function should:\n1. Extract the tab_id(s) for the named range when fetching document data\n2. Pass `tabs_criteria={'tabIds': [tab_id]}` to `create_delete_named_range_request`\n\n## Test Document\nDocument ID: 1A-N-g_mgnDbj7TwcOO4sHUUbtgdAJ_T2VHh9-pChqCc (multi-tab document with 2 tabs)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-06T20:32:50.792209-06:00","updated_at":"2025-12-06T20:39:04.57929-06:00","closed_at":"2025-12-06T20:39:04.57929-06:00","labels":["gdocs","multi-tab","named-ranges"]}
{"id":"google_workspace_mcp-test-bug-1","content_hash":"7aa5faeb3594c4236da2e6d45cc8b44fada379e532da8b60f6028fa2365506b1","title":"modify_doc_text with empty text (delete) fails despite preview showing success","description":"## Problem\nWhen using `modify_doc_text` with `search`, `position='replace'`, and `text=''` (empty string to delete), the preview mode shows success but actual execution fails.\n\n## Steps to Reproduce\n```bash\n# Preview works:\nmodify_doc_text(doc_id, search=\"[TEST]\", position=\"replace\", text=\"\", preview=True)\n# Returns: {\"preview\": true, \"would_modify\": true, \"operation\": \"replace\", ...}\n\n# Actual execution fails:\nmodify_doc_text(doc_id, search=\"[TEST]\", position=\"replace\", text=\"\")\n# Error: Invalid requests[1].insertText: Insert text requests must specify text to insert.\n```\n\n## Root Cause\nThe code is generating an `insertText` request with empty text instead of a `deleteContentRange` request.\n\n## Impact\nUsers cannot delete text using `modify_doc_text` directly - must use `batch_modify_doc` with `delete_text` operation type instead.\n\n## Suggested Fix\nWhen `text=\"\"` is provided with `position=\"replace\"`, generate a `deleteContentRange` request instead of `insertText` + `deleteContentRange`.\n\n## Workaround\nUse `batch_modify_doc` with `{\"type\": \"delete_text\", \"start_index\": X, \"end_index\": Y}`","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-05T00:38:35.949708Z","updated_at":"2025-12-04T16:41:48.257415-08:00","closed_at":"2025-12-04T16:41:48.257415-08:00","labels":["api","critical","google-docs"]}
{"id":"google_workspace_mcp-test-bug-2","content_hash":"531ecce4d3fa97e4d0a318a8ed3f248260e1e02fe206cade3e2b4e1a9b45bea6","title":"find_and_replace_doc lacks preview mode (inconsistent with modify_doc_text)","description":"## Problem\n`find_and_replace_doc` does not support `preview=True` parameter while `modify_doc_text` does.\n\n## Steps to Reproduce\n```bash\nfind_and_replace_doc(doc_id, find_text=\"old\", replace_text=\"new\", preview=True)\n# Error: got an unexpected keyword argument 'preview'\n```\n\n## Expected Behavior\nShould support preview mode like `modify_doc_text` to show what would be replaced before executing.\n\n## Impact\nUsers cannot safely preview global find/replace operations before committing them.\n\n## Suggested Fix\nAdd `preview` parameter to `find_and_replace_doc` that returns count and locations of matches without making changes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-05T00:38:35.949942Z","updated_at":"2025-12-04T16:50:59.78288-08:00","closed_at":"2025-12-04T16:50:59.78288-08:00","labels":["api","consistency","google-docs"]}
{"id":"google_workspace_mcp-test-bug-3","content_hash":"493d863b67327378ffef309cee7f4df217231bc3f767d53eab1f55dec08228eb","title":"find_and_replace_doc returns plain string instead of structured JSON","description":"## Problem\n`find_and_replace_doc` returns a plain text string while other tools like `modify_doc_text` return structured JSON with `position_shift`, `affected_range`, etc.\n\n## Current Response\n```\n\"Replaced 3 occurrence(s) of 'old' with 'new' in document ABC. Link: ...\"\n```\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"operation\": \"find_replace\",\n  \"occurrences_replaced\": 3,\n  \"find_text\": \"old\",\n  \"replace_text\": \"new\",\n  \"position_shift\": -6,  // If replacements changed document length\n  \"affected_ranges\": [...],  // Locations of replacements\n  \"document_link\": \"...\"\n}\n```\n\n## Impact\n- Inconsistent API response format\n- No way to track position shifts for follow-up operations\n- Harder to parse programmatically","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T00:38:35.949945Z","updated_at":"2025-12-04T22:59:48.202474-08:00","closed_at":"2025-12-04T22:59:48.202474-08:00","labels":["api","consistency","google-docs"]}
{"id":"google_workspace_mcp-test-bug-4","content_hash":"8beebc9c8676476cf3c820b042276684a96924815eb5ab44f1cd37e16b9a1332","title":"Operation history not being recorded automatically","description":"## Problem\nThe `get_doc_operation_history` shows 0 operations even after multiple edits through `modify_doc_text` and `batch_modify_doc`.\n\n## Steps to Reproduce\n```bash\n# Make several edits\nmodify_doc_text(doc_id, start_index=24, text=\"Test\")\nbatch_modify_doc(doc_id, operations=[...])\n\n# Check history\nget_doc_operation_history(doc_id)\n# Returns: {\"operations\": [], \"total_operations\": 0, \"undoable_count\": 0}\n```\n\n## Expected Behavior\nOperations should be automatically recorded to enable undo functionality.\n\n## Impact\n- Undo functionality is unusable\n- No way to track what operations have been performed\n\n## Questions\n- Is recording supposed to be automatic?\n- Is there a flag to enable it?\n- Do we need to call `record_doc_operation` manually?","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-05T00:38:35.949948Z","updated_at":"2025-12-04T22:47:56.355772-08:00","closed_at":"2025-12-04T22:47:56.355772-08:00","labels":["google-docs","history","undo"]}
{"id":"google_workspace_mcp-test-consistency-1","content_hash":"c60d9b34f8bb8a214a6e46f109252445afcc04f26e7222ba0a4ad1782093003e","title":"insert_doc_image requires explicit index (no location='end' option)","description":"## Problem\n`insert_doc_image` requires explicit `index` parameter while `create_table_with_data` supports optional index (defaults to end).\n\n## Current API\n```python\n# Table - index optional (appends to end):\ncreate_table_with_data(doc_id, data)  # Works!\n\n# Image - index required:\ninsert_doc_image(doc_id, image_source=\"...\", index=???)  # Must specify\n```\n\n## Proposed Fix\nMake `index` optional for `insert_doc_image`, default to end of document (like tables).\n\nAlso consider adding:\n- `location=\"end\"` / `location=\"start\"` convenience parameter\n- `after_heading=\"Section Name\"` for heading-based positioning\n\n## Impact\nUsers must call `get_doc_info` first to get document length before inserting images.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T00:38:35.949964Z","updated_at":"2025-12-04T22:51:30.970932-08:00","closed_at":"2025-12-04T22:51:30.970932-08:00","labels":["consistency","dx","google-docs"]}
{"id":"google_workspace_mcp-test-consistency-2","content_hash":"b935ac5d6f29e64bcadbb8304167fddbf5492f38a2c3454b32a7b86a4a3e69ec","title":"get_doc_operation_history doesn't follow user_google_email pattern","description":"## Problem\n`get_doc_operation_history` does not accept `user_google_email` parameter, breaking the pattern of all other doc tools.\n\n## Steps to Reproduce\n```bash\nget_doc_operation_history(doc_id, user_google_email=\"...\")\n# Error: got an unexpected keyword argument 'user_google_email'\n```\n\n## Expected\nShould accept `user_google_email` like all other tools for consistency.\n\n## Impact\nConfusing when some tools require user_google_email and others don't.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-05T00:38:35.949966Z","updated_at":"2025-12-04T23:35:27.488887-08:00","closed_at":"2025-12-04T23:35:27.488887-08:00","labels":["api","consistency","google-docs"]}
{"id":"google_workspace_mcp-test-feat-1","content_hash":"52ba4200c23b5ca69ac8dd43c9f892a0aab2bf0dc02e51091397a7c1d0866ddc","title":"Add hyperlink support to modify_doc_text","description":"## Problem\nCannot add hyperlinks to text using `modify_doc_text`. The Google Docs API supports this via `updateTextStyle` with `link` field.\n\n## Proposed API\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"click here\",\n    position=\"replace\",\n    link=\"https://example.com\"  # NEW: Add hyperlink\n)\n\n# Or add link while inserting:\nmodify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    text=\"Visit our site\",\n    link=\"https://example.com\"\n)\n```\n\n## Google Docs API Support\nThe `updateTextStyle` request supports:\n```json\n{\n  \"textStyle\": {\n    \"link\": {\n      \"url\": \"https://example.com\"\n    }\n  }\n}\n```\n\n## Use Cases\n- Add links to text\n- Create table of contents with internal links\n- Insert linked references\n\n## Priority\nHigh - very common editing need","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-05T00:38:35.94995Z","updated_at":"2025-12-04T16:46:52.441565-08:00","closed_at":"2025-12-04T16:46:52.441565-08:00","labels":["enhancement","formatting","google-docs"]}
{"id":"google_workspace_mcp-test-feat-2","content_hash":"3b94cf04b5a460165759ac938ce3c8e55ca32752929aab8c4481303c3924fd93","title":"Add text color support (foreground and background)","description":"## Problem\nCannot change text color using `modify_doc_text`. Current formatting options are limited to: bold, italic, underline, font_size, font_family.\n\n## Proposed API\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"important\",\n    position=\"replace\",\n    foreground_color=\"#FF0000\",  # Red text\n    background_color=\"#FFFF00\"   # Yellow highlight\n)\n```\n\n## Google Docs API Support\nThe `updateTextStyle` request supports:\n```json\n{\n  \"textStyle\": {\n    \"foregroundColor\": {\"color\": {\"rgbColor\": {\"red\": 1.0, \"green\": 0.0, \"blue\": 0.0}}},\n    \"backgroundColor\": {\"color\": {\"rgbColor\": {\"red\": 1.0, \"green\": 1.0, \"blue\": 0.0}}}\n  }\n}\n```\n\n## Use Cases\n- Highlight important text\n- Color-code content (errors in red, success in green)\n- Create visual emphasis\n\n## Format Options\nCould accept: hex colors (#FF0000), rgb values, or named colors","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T00:38:35.949952Z","updated_at":"2025-12-04T22:41:54.867968-08:00","closed_at":"2025-12-04T22:41:54.867968-08:00","labels":["enhancement","formatting","google-docs"]}
{"id":"google_workspace_mcp-test-feat-3","content_hash":"3c32ef0032bd3522b2ab70ae7b92f1b4464fd8b2b750959a599581c273c2fa47","title":"Add strikethrough formatting option","description":"## Problem\nCannot apply strikethrough formatting using `modify_doc_text`.\n\n## Proposed API\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"deprecated\",\n    position=\"replace\",\n    strikethrough=True\n)\n```\n\n## Google Docs API Support\nThe `updateTextStyle` request supports `strikethrough: true`.\n\n## Use Cases\n- Mark deleted/deprecated content\n- Show revisions\n- Track changes style editing","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-05T00:38:35.949954Z","updated_at":"2025-12-04T22:42:05.553127-08:00","closed_at":"2025-12-04T22:42:05.553127-08:00","labels":["enhancement","formatting","google-docs"]}
{"id":"google_workspace_mcp-test-feat-4","content_hash":"5b9edeb3bb48be0484fb8839c25b5e738bf59f518862fe3f302a192fbb3173e6","title":"Add paragraph/heading style support","description":"## Problem\nCannot change paragraph style to heading (H1, H2, etc.) or vice versa. Current API only supports text-level formatting (bold, italic) not paragraph-level styles.\n\n## Proposed API\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"My New Section\",\n    position=\"replace\",\n    paragraph_style=\"HEADING_2\"  # Convert to heading\n)\n\n# Or on insert:\nmodify_doc_text(\n    document_id=\"...\",\n    start_index=100,\n    text=\"New Heading\\n\",\n    paragraph_style=\"HEADING_1\"\n)\n```\n\n## Google Docs API Support\nThe `updateParagraphStyle` request supports:\n- NORMAL_TEXT\n- HEADING_1 through HEADING_6\n- TITLE\n- SUBTITLE\n\n## Use Cases\n- Create document structure programmatically\n- Convert plain text to headings\n- Reorganize document hierarchy","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T00:38:35.949957Z","updated_at":"2025-12-04T22:41:54.890665-08:00","closed_at":"2025-12-04T22:41:54.890665-08:00","labels":["formatting","google-docs","paragraph"]}
{"id":"google_workspace_mcp-test-feat-5","content_hash":"cc67a734564c2a4df23d4e0679c1c33343187dd752265763700002fc190bc3fe","title":"Add paragraph alignment support (center, right, justify)","description":"## Problem\nCannot change paragraph alignment. Text is always left-aligned by default.\n\n## Proposed API\n```python\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"Centered Title\",\n    position=\"replace\",\n    alignment=\"CENTER\"  # or \"LEFT\", \"RIGHT\", \"JUSTIFIED\"\n)\n```\n\n## Google Docs API Support\nThe `updateParagraphStyle` request supports:\n- START (left for LTR)\n- CENTER\n- END (right for LTR)\n- JUSTIFIED\n\n## Use Cases\n- Center titles and headings\n- Right-align dates and signatures\n- Justify body text","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-05T00:38:35.94996Z","updated_at":"2025-12-04T22:41:54.912285-08:00","closed_at":"2025-12-04T22:41:54.912285-08:00","labels":["formatting","google-docs","paragraph"]}
{"id":"google_workspace_mcp-test-feat-6","content_hash":"3a92e2064c6bea4967d13ea500048208fe4756270fca995e3ef806abd0d27689","title":"Add convert-to-list functionality for existing text","description":"## Problem\n`insert_doc_elements` can create new lists, but cannot convert existing paragraphs to bullet/numbered lists.\n\n## Current Limitation\n```python\n# Can only INSERT a new list:\ninsert_doc_elements(doc_id, element_type=\"list\", index=100, list_type=\"UNORDERED\", text=\"Item 1\")\n\n# CANNOT convert existing text to list\n```\n\n## Proposed API\n```python\n# Convert existing paragraph(s) to list:\nmodify_doc_text(\n    document_id=\"...\",\n    search=\"- Item one\\n- Item two\",  # Or by range\n    position=\"replace\",\n    convert_to_list=\"UNORDERED\"  # or \"ORDERED\"\n)\n```\n\n## Google Docs API Support\nThe `createParagraphBullets` request can apply bullets to existing paragraphs.\n\n## Use Cases\n- Convert dash-prefixed text to proper bullets\n- Reformat imported content\n- Toggle between list and paragraph format","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-05T00:38:35.949962Z","updated_at":"2025-12-04T22:56:59.504928-08:00","closed_at":"2025-12-04T22:56:59.504928-08:00","labels":["formatting","google-docs","lists"]}
